/*! cornerstone-tools - 2.3.9 - 2018-09-25 | (c) 2017 Chris Hafey | https://github.com/cornerstonejs/cornerstoneTools */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("cornerstoneTools",[],t):"object"==typeof exports?exports.cornerstoneTools=t():e.cornerstoneTools=t()}(window,function(){return function(e){var t={};function a(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}return a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=32)}([function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=window.cornerstone,r=window.cornerstoneMath,o=window.Hammer;t.default={set cornerstone(e){n=e},get cornerstone(){return n},set cornerstoneMath(e){r=e},get cornerstoneMath(){return r},set Hammer(e){o=e},get Hammer(){return o}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={IMAGE_RENDERED:"cornerstoneimagerendered",NEW_IMAGE:"cornerstonenewimage",IMAGE_CACHE_PROMISE_REMOVED:"cornerstoneimagecachepromiseremoved",ELEMENT_DISABLED:"cornerstoneelementdisabled",MOUSE_DOWN:"cornerstonetoolsmousedown",MOUSE_UP:"cornerstonetoolsmouseup",MOUSE_DOWN_ACTIVATE:"cornerstonetoolsmousedownactivate",MOUSE_DRAG:"cornerstonetoolsmousedrag",MOUSE_MOVE:"cornerstonetoolsmousemove",MOUSE_CLICK:"cornerstonetoolsmouseclick",MOUSE_DOUBLE_CLICK:"cornerstonetoolsmousedoubleclick",MOUSE_WHEEL:"cornerstonetoolsmousewheel",TOUCH_START:"cornerstonetoolstouchstart",TOUCH_START_ACTIVE:"cornerstonetoolstouchstartactive",TOUCH_END:"cornerstonetoolstouchend",TOUCH_DRAG:"cornerstonetoolstouchdrag",TOUCH_DRAG_END:"cornerstonetoolstouchdragend",TOUCH_PINCH:"cornerstonetoolstouchpinch",TOUCH_ROTATE:"cornerstonetoolstouchrotate",TOUCH_PRESS:"cornerstonetoolstouchpress",TAP:"cornerstonetoolstap",DOUBLE_TAP:"cornerstonetoolsdoubletap",MULTI_TOUCH_START:"cornerstonetoolsmultitouchstart",MULTI_TOUCH_START_ACTIVE:"cornerstonetoolsmultitouchstartactive",MULTI_TOUCH_DRAG:"cornerstonetoolsmultitouchdrag",KEY_DOWN:"cornerstonetoolskeydown",KEY_UP:"cornerstonetoolskeyup",KEY_PRESS:"cornerstonetoolskeypress",MEASUREMENT_ADDED:"cornerstonetoolsmeasurementadded",MEASUREMENT_MODIFIED:"cornerstonetoolsmeasurementmodified",MEASUREMENT_REMOVED:"cornerstonemeasurementremoved",TOOL_DEACTIVATED:"cornerstonetoolstooldeactivated",CLIP_STOPPED:"cornerstonetoolsclipstopped",STACK_SCROLL:"cornerstonestackscroll",LINE_SAMPLE_UPDATED:"cornerstonelinesampleupdated"}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getElementToolStateManager=t.setElementToolStateManager=t.clearToolState=t.removeToolState=t.getToolState=t.addToolState=void 0;var n=l(a(1)),r=l(a(0)),o=a(19),i=l(a(5));function l(e){return e&&e.__esModule?e:{default:e}}function u(e){var t=r.default.cornerstone.getEnabledElement(e);return void 0===t.toolStateManager&&(t.toolStateManager=o.globalImageIdSpecificToolStateManager),t.toolStateManager}t.addToolState=function(e,t,a){u(e).add(e,t,a);var r=n.default.MEASUREMENT_ADDED,o={toolType:t,element:e,measurementData:a};(0,i.default)(e,r,o)},t.getToolState=function(e,t){return u(e).get(e,t)},t.removeToolState=function(e,t,a){for(var r=u(e).get(e,t),o=-1,l=0;l<r.data.length;l++)r.data[l]===a&&(o=l);if(-1!==o){r.data.splice(o,1);var d=n.default.MEASUREMENT_REMOVED,c={toolType:t,element:e,measurementData:a};(0,i.default)(e,d,c)}},t.clearToolState=function(e,t){var a=u(e).get(e,t);void 0!==a&&(a.data=[])},t.setElementToolStateManager=function(e,t){r.default.cornerstone.getEnabledElement(e).toolStateManager=t},t.getElementToolStateManager=u},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewContext=function(e){var t=e.getContext("2d");return t.setTransform(1,0,0,1,0,0),t},t.draw=function(e,t){e.save(),t(e),e.restore()},t.path=o,t.setShadow=function(e,t){t.shadow&&(e.shadowColor=t.shadowColor||"#000000",e.shadowOffsetX=t.shadowOffsetX||1,e.shadowOffsetY=t.shadowOffsetY||1)},t.drawLine=function(e,t,a,r,i){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel";o(e,i,function(e){if("pixel"===l){var o=n.default.cornerstone;a=o.pixelToCanvas(t,a),r=o.pixelToCanvas(t,r)}e.moveTo(a.x,a.y),e.lineTo(r.x,r.y)})},t.drawLines=function(e,t,a,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"pixel";o(e,r,function(e){a.forEach(function(a){var r=a.start,o=a.end;if("pixel"===i){var l=n.default.cornerstone;r=l.pixelToCanvas(t,r),o=l.pixelToCanvas(t,o)}e.moveTo(r.x,r.y),e.lineTo(o.x,o.y)})})},t.drawJoinedLines=function(e,t,a,r,i){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel";o(e,i,function(e){if("pixel"===l){var o=n.default.cornerstone;a=o.pixelToCanvas(t,a),r=r.map(function(e){return o.pixelToCanvas(t,e)})}e.moveTo(a.x,a.y),r.forEach(function(t){var a=t.x,n=t.y;e.lineTo(a,n)})})},t.drawCircle=function(e,t,a,r,i){"pixel"===(arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel")&&(a=n.default.cornerstone.pixelToCanvas(t,a));o(e,i,function(e){e.arc(a.x,a.y,r,0,2*Math.PI)})},t.drawEllipse=function(e,t,a,r,i){"pixel"===(arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel")&&(a=n.default.cornerstone.pixelToCanvas(t,a),r=n.default.cornerstone.pixelToCanvas(t,r));var l=Math.min(a.x,r.x),u=Math.min(a.y,r.y),d=Math.abs(a.x-r.x),c=Math.abs(a.y-r.y),s=d/2*.5522848,f=c/2*.5522848,v=l+d,m=u+c,g=l+d/2,p=u+c/2;o(e,i,function(e){e.moveTo(l,p),e.bezierCurveTo(l,p-f,g-s,u,g,u),e.bezierCurveTo(g+s,u,v,p-f,v,p),e.bezierCurveTo(v,p+f,g+s,m,g,m),e.bezierCurveTo(g-s,m,l,p+f,l,p),e.closePath()})},t.drawRect=function(e,t,a,r,i){if("pixel"===(arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel")){var l=n.default.cornerstone;a=l.pixelToCanvas(t,a),r=l.pixelToCanvas(t,r)}var u=Math.min(a.x,r.x),d=Math.min(a.y,r.y),c=Math.abs(a.x-r.x),s=Math.abs(a.y-r.y);o(e,i,function(e){e.rect(u,d,c,s)})},t.fillOutsideRect=function(e,t,a,r,i){if("pixel"===(arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel")){var l=n.default.cornerstone;a=l.pixelToCanvas(t,a),r=l.pixelToCanvas(t,r)}var u=Math.min(a.x,r.x),d=Math.min(a.y,r.y),c=Math.abs(a.x-r.x),s=Math.abs(a.y-r.y);o(e,i,function(e){e.rect(0,0,e.canvas.clientWidth,e.canvas.clientHeight),e.rect(u+c,d,-c,s)})},t.fillBox=function(e,t,a){e.fillStyle=a,e.fillRect(t.left,t.top,t.width,t.height)},t.fillTextLines=function(e,t,a,n,o){var i=r.textStyle.getFontSize();e.font=r.textStyle.getFont(),e.textBaseline="top",e.fillStyle=n,a.forEach(function(a,n){e.fillText(a,t.left+o,t.top+o+n*(i+o))})};var n=function(e){return e&&e.__esModule?e:{default:e}}(a(0)),r=a(32);function o(e,t,a){var n=t.color,o=t.lineWidth,i=t.fillStyle,l=t.lineDash;e.beginPath(),e.strokeStyle=n||e.strokeStyle,e.lineWidth=o||void 0===o&&r.toolStyle.getToolWidth()||e.lineWidth,l&&e.setLineDash(l),a(e),i&&(e.fillStyle=i,e.fill()),e.stroke(),l&&e.setLineDash([])}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={};t.getToolOptions=function(e,t){if(!n[e])return{};var a=n[e].find(function(e){return e.element===t});return a?a.options:{}},t.setToolOptions=function(e,t,a){if(n[e]){var r=n[e].findIndex(function(e){return e.element===t});if(-1===r)n[e].push({element:t,options:a});else{var o=n[e][r].options||{};n[e][r].options=Object.assign(o,a)}}else n[e]=[{element:t,options:a}]},t.clearToolOptions=function(e,t){var a=n[e];a&&(n[e]=a.filter(function(e){return e.element!==t}))},t.clearToolOptionsByToolType=function(e){delete n[e]},t.clearToolOptionsByElement=function(e){for(var t in n)n[t]=n[t].filter(function(t){return t.element!==e})}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=void 0;"function"==typeof window.CustomEvent?n=new CustomEvent(t,{detail:a,cancelable:!0}):(n=document.createEvent("CustomEvent")).initCustomEvent(t,!0,!0,a);return e.dispatchEvent(n)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return 0!=(t&1<<e-1)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="white",r="greenyellow",o="transparent";var i={setFillColor:function(e){o=e},getFillColor:function(){return o},setToolColor:function(e){n=e},getToolColor:function(){return n},setActiveColor:function(e){r=e},getActiveColor:function(){return r},getColorIfActive:function(e){return e.color?e.color:e.active?r:n}};t.default=i},function(e,t,a){"use strict";function n(e,t,a){return Math.min(Math.max(t,e),a)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n,t.clipToBox=function(e,t){e.x=n(e.x,0,t.width),e.y=n(e.y,0,t.height)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.textBoxWidth=o,t.default=function(e,t,a,i,l,u){"[object Array]"!==Object.prototype.toString.call(t)&&(t=[t]);var d=n.default.getFontSize(),c=n.default.getBackgroundColor(),s=0;t.forEach(function(t){var a=o(e,t,5);s=Math.max(s,a)});var f={width:s,height:5+t.length*(d+5)};return(0,r.draw)(e,function(e){e.strokeStyle=l,u&&u.centering&&!0===u.centering.x&&(a-=f.width/2),u&&u.centering&&!0===u.centering.y&&(i-=f.height/2),f.left=a,f.top=i;var n=u&&!0===u.debug?"#FF0000":c;(0,r.fillBox)(e,f,n),(0,r.fillTextLines)(e,f,t,l,5)}),f};var n=function(e){return e&&e.__esModule?e:{default:e}}(a(20)),r=a(3);function o(e,t,a){var r=n.default.getFont(),o=e.font;r&&r!==o&&(e.font=r);var i=e.measureText(t).width;return r&&r!==o&&(e.font=o),i+2*a}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t={},a=e.toolType;function p(t){var o=t.detail,i=o.element,l=(0,g.getToolOptions)(a,i);(0,f.default)(o.which,l.mouseButtonMask)&&(e.addNewMeasurement?e.addNewMeasurement(o):function(t){var o=r.default.cornerstone,i=t.element,l=e.createNewMeasurement(t);if(!l)return;(0,v.addToolState)(t.element,a,l),i.removeEventListener(n.default.MOUSE_MOVE,T),i.removeEventListener(n.default.MOUSE_DOWN,y),i.removeEventListener(n.default.MOUSE_DOWN_ACTIVATE,M),S&&i.removeEventListener(n.default.MOUSE_DOUBLE_CLICK,S);o.updateImage(i);var c=void 0;c=1===Object.keys(l.handles).length?u.default:d.default;var f=void 0;f=!(!e.options||void 0===e.options.preventHandleOutsideImage)&&e.options.preventHandleOutsideImage;c(t,a,l,l.handles.end,function(){l.active=!1,l.invalidated=!0,(0,s.default)(t,l.handles)&&(0,v.removeToolState)(i,a,l),i.addEventListener(n.default.MOUSE_MOVE,T),i.addEventListener(n.default.MOUSE_DOWN,y),i.addEventListener(n.default.MOUSE_DOWN_ACTIVATE,M),S&&i.addEventListener(n.default.MOUSE_DOUBLE_CLICK,S),o.updateImage(i)},f)}(o),t.preventDefault(),t.stopPropagation())}function h(t){var n=t.detail;o.default.setCoords(n);var i=(0,v.getToolState)(n.element,a);if(i){for(var u=!1,d=0;d<i.data.length;d++){var c=n.currentPoints.canvas,s=i.data[d];!0===(0,l.default)(n.element,s.handles,c)&&(u=!0),(e.pointNearTool(n.element,s,c)&&!s.active||!e.pointNearTool(n.element,s,c)&&s.active)&&(s.active=!s.active,u=!0)}!0===u&&r.default.cornerstone.updateImage(n.element)}}function E(t){var o=t.detail,l=void 0,d=o.element,m=(0,g.getToolOptions)(a,d);if((0,f.default)(o.which,m.mouseButtonMask)){var p=o.startPoints.canvas,h=(0,v.getToolState)(t.currentTarget,a);if(h){var E=void 0,y=void 0;for(y=!(!e.options||void 0===e.options.preventHandleOutsideImage)&&e.options.preventHandleOutsideImage,E=0;E<h.data.length;E++){l=h.data[E];var M=(0,i.default)(d,l.handles,p,6);if(M)return d.removeEventListener(n.default.MOUSE_MOVE,T),l.active=!0,(0,u.default)(o,a,l,M,b,y),t.stopImmediatePropagation(),t.stopPropagation(),void t.preventDefault()}if(e.pointNearTool){var S=e.options||{deleteIfHandleOutsideImage:!0,preventHandleOutsideImage:!1};for(E=0;E<h.data.length;E++)if((l=h.data[E]).active=!1,e.pointNearTool(d,l,p))return l.active=!0,d.removeEventListener(n.default.MOUSE_MOVE,T),(0,c.default)(t,l,h,a,S,b),t.stopImmediatePropagation(),t.stopPropagation(),void t.preventDefault()}}}function b(){l.invalidated=!0,(0,s.default)(o,l.handles)&&(0,v.removeToolState)(d,a,l),r.default.cornerstone.updateImage(d),d.addEventListener(n.default.MOUSE_MOVE,T)}}var T=e.mouseMoveCallback||h,y=e.mouseDownCallback||E,M=e.mouseDownActivateCallback||p,S=e.mouseDoubleClickCallback;var b={enable:function(t){t.removeEventListener(n.default.IMAGE_RENDERED,e.onImageRendered),t.removeEventListener(n.default.MOUSE_MOVE,T),t.removeEventListener(n.default.MOUSE_DOWN,y),t.removeEventListener(n.default.MOUSE_DOWN_ACTIVATE,M),S&&t.removeEventListener(n.default.MOUSE_DOUBLE_CLICK,S),t.addEventListener(n.default.IMAGE_RENDERED,e.onImageRendered),r.default.cornerstone.updateImage(t)},disable:function(t){t.removeEventListener(n.default.IMAGE_RENDERED,e.onImageRendered),t.removeEventListener(n.default.MOUSE_MOVE,T),t.removeEventListener(n.default.MOUSE_DOWN,y),t.removeEventListener(n.default.MOUSE_DOWN_ACTIVATE,M),S&&t.removeEventListener(n.default.MOUSE_DOUBLE_CLICK,S),r.default.cornerstone.updateImage(t)},activate:function(t,o){(0,g.setToolOptions)(a,t,{mouseButtonMask:o}),t.removeEventListener(n.default.IMAGE_RENDERED,e.onImageRendered),t.removeEventListener(n.default.MOUSE_MOVE,T),t.removeEventListener(n.default.MOUSE_DOWN,y),t.removeEventListener(n.default.MOUSE_DOWN_ACTIVATE,M),t.addEventListener(n.default.IMAGE_RENDERED,e.onImageRendered),t.addEventListener(n.default.MOUSE_MOVE,T),t.addEventListener(n.default.MOUSE_DOWN,y),t.addEventListener(n.default.MOUSE_DOWN_ACTIVATE,M),S&&(t.removeEventListener(n.default.MOUSE_DOUBLE_CLICK,S),t.addEventListener(n.default.MOUSE_DOUBLE_CLICK,S)),r.default.cornerstone.updateImage(t)},deactivate:function(t,o){(0,g.setToolOptions)(a,t,{mouseButtonMask:o});var i=n.default.TOOL_DEACTIVATED,l={mouseButtonMask:o,toolType:a,type:i};(0,m.default)(t,i,l),t.removeEventListener(n.default.IMAGE_RENDERED,e.onImageRendered),t.removeEventListener(n.default.MOUSE_MOVE,T),t.removeEventListener(n.default.MOUSE_DOWN,y),t.removeEventListener(n.default.MOUSE_DOWN_ACTIVATE,M),t.addEventListener(n.default.IMAGE_RENDERED,e.onImageRendered),t.addEventListener(n.default.MOUSE_MOVE,T),t.addEventListener(n.default.MOUSE_DOWN,y),S&&(t.removeEventListener(n.default.MOUSE_DOUBLE_CLICK,S),t.addEventListener(n.default.MOUSE_DOUBLE_CLICK,S)),e.deactivate&&e.deactivate(t,o),r.default.cornerstone.updateImage(t)},getConfiguration:function(){return t},setConfiguration:function(e){t=e},mouseDownCallback:E,mouseMoveCallback:h,mouseDownActivateCallback:p};return e.pointNearTool&&(b.pointNearTool=e.pointNearTool),S&&(b.mouseDoubleClickCallback=S),e.addNewMeasurement&&(b.addNewMeasurement=e.addNewMeasurement),b};var n=p(a(1)),r=p(a(0)),o=p(a(40)),i=p(a(24)),l=p(a(41)),u=p(a(27)),d=p(a(28)),c=p(a(42)),s=p(a(14)),f=p(a(6)),v=a(2),m=p(a(5)),g=a(4);function p(e){return e&&e.__esModule?e:{default:e}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,i,l){Object.keys(a).forEach(function(u){var d=a[u];if(!0!==d.drawnIndependently&&(!l||!0!==l.drawHandlesIfActive||d.active)){var c=function(e){var t=void 0;t=e&&e.handleRadius?e.handleRadius:o;return t}(l),s={color:i,lineWidth:d.active?n.default.getActiveWidth():n.default.getToolWidth(),fillStyle:l&&l.fill};(0,r.drawCircle)(e,t.element,d,c,s)}})};var n=function(e){return e&&e.__esModule?e:{default:e}}(a(15)),r=a(3);var o=6},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=f(a(1)),r=f(a(0)),o=f(a(14)),i=f(a(24)),l=f(a(56)),u=f(a(30)),d=f(a(55)),c=a(2),s=f(a(5));function f(e){return e&&e.__esModule?e:{default:e}}function v(e){Object.keys(e).forEach(function(t){e[t].active=!1})}function m(e){if(e)for(var t=0;t<e.data.length;t++){var a=e.data[t];a.active=!1,a.handles&&v(a.handles)}}t.default=function(e){function t(i){var l=i.detail;e.addNewMeasurement?e.addNewMeasurement(l):function(i){var l=r.default.cornerstone,d=i.element,s=e.createNewMeasurement(i);if(s){if((0,c.addToolState)(d,e.toolType,s),1===Object.keys(s.handles).length&&i.type===n.default.TAP)return s.active=!1,s.handles.end.active=!1,s.handles.end.highlight=!1,s.invalidated=!0,(0,o.default)(i,s.handles)&&(0,c.removeToolState)(d,e.toolType,s),void l.updateImage(d);d.removeEventListener(n.default.TOUCH_START_ACTIVE,e.touchDownActivateCallback||t),d.removeEventListener(n.default.TAP,e.tapCallback||a),d.removeEventListener(n.default.TOUCH_START,e.touchStartCallback||f),l.updateImage(d),(0,u.default)(i,e.toolType,s,s.handles.end,function(){s.active=!1,s.invalidated=!0,(0,o.default)(i,s.handles)&&(0,c.removeToolState)(d,e.toolType,s),d.addEventListener(n.default.TOUCH_START_ACTIVE,e.touchDownActivateCallback||t),d.addEventListener(n.default.TAP,e.tapCallback||a),d.addEventListener(n.default.TOUCH_START,e.touchStartCallback||f),l.updateImage(d)})}}(l),i.stopImmediatePropagation(),i.preventDefault()}function a(u){var s=u.detail,v=r.default.cornerstone,g=s.element,p=s.currentPoints.canvas,h=(0,c.getToolState)(u.currentTarget,e.toolType),E=void 0,T=void 0;function y(){m(h),(0,o.default)(s,E.handles)&&(0,c.removeToolState)(g,e.toolType,E),v.updateImage(g),g.addEventListener(n.default.TOUCH_START,e.touchStartCallback||f),g.addEventListener(n.default.TAP,e.tapCallback||a)}if(m(h),h)for(T=0;T<h.data.length;T++){E=h.data[T];var M=(0,i.default)(g,E.handles,p,25);if(M)return g.removeEventListener(n.default.TOUCH_START,e.touchStartCallback||f),g.removeEventListener(n.default.TAP,e.tapCallback||a),E.active=!0,M.active=!0,v.updateImage(g),(0,l.default)(u,e.toolType,E,M,y),u.stopImmediatePropagation(),void u.preventDefault()}if(h&&e.pointNearTool)for(T=0;T<h.data.length;T++)if(E=h.data[T],e.pointNearTool(g,E,p))return g.removeEventListener(n.default.TOUCH_START,e.touchStartCallback||f),g.removeEventListener(n.default.TAP,e.tapCallback||a),E.active=!0,v.updateImage(g),(0,d.default)(u,E,h,e.toolType,!0,y),u.stopImmediatePropagation(),void u.preventDefault();return e.touchDownActivateCallback?e.touchDownActivateCallback(u):t(u),!1}function f(t){var u=t.detail,v=r.default.cornerstone,m=u.element,g=u.startPoints.canvas,p=void 0,h=(0,c.getToolState)(t.currentTarget,e.toolType),E=void 0;function T(t,r){p.active=!1,p.invalidated=!0,(0,o.default)(u,p.handles)&&(0,c.removeToolState)(u.element,e.toolType,p),v.updateImage(u.element),m.addEventListener(n.default.TOUCH_START,e.touchStartCallback||f),m.addEventListener(n.default.TAP,e.tapCallback||a),e.pressCallback&&m.addEventListener(n.default.TOUCH_PRESS,e.pressCallback),t&&t.type===n.default.TOUCH_PRESS&&(0,s.default)(m,t.type,r)}if(h){for(E=0;E<h.data.length;E++){p=h.data[E];var y=(0,i.default)(u.element,p.handles,g,28);if(y)return m.removeEventListener(n.default.TOUCH_START,e.touchStartCallback||f),m.removeEventListener(n.default.TAP,e.tapCallback||a),e.pressCallback&&m.removeEventListener(n.default.TOUCH_PRESS,e.pressCallback),p.active=!0,(0,l.default)(t,e.toolType,p,y,T),t.stopImmediatePropagation(),t.preventDefault(),void t.stopPropagation()}if(e.pointNearTool)for(E=0;E<h.data.length;E++)if(p=h.data[E],e.pointNearTool(u.element,p,g))return m.removeEventListener(n.default.TOUCH_START,e.touchStartCallback||f),m.removeEventListener(n.default.TAP,e.tapCallback||a),e.pressCallback&&m.removeEventListener(n.default.TOUCH_PRESS,e.pressCallback),(0,d.default)(t,p,h,e.toolType,!0,T),t.stopImmediatePropagation(),t.preventDefault(),void t.stopPropagation()}}var v={enable:function(o){o.removeEventListener(n.default.IMAGE_RENDERED,e.onImageRendered),o.removeEventListener(n.default.TOUCH_START,e.touchStartCallback||f),o.removeEventListener(n.default.TOUCH_START_ACTIVE,e.touchDownActivateCallback||t),o.removeEventListener(n.default.TAP,e.tapCallback||a),o.addEventListener(n.default.IMAGE_RENDERED,e.onImageRendered),e.doubleTapCallback&&o.removeEventListener(n.default.DOUBLE_TAP,e.doubleTapCallback),e.pressCallback&&o.removeEventListener(n.default.TOUCH_PRESS,e.pressCallback),r.default.cornerstone.updateImage(o)},disable:function(o){o.removeEventListener(n.default.IMAGE_RENDERED,e.onImageRendered),o.removeEventListener(n.default.TOUCH_START,e.touchStartCallback||f),o.removeEventListener(n.default.TOUCH_START_ACTIVE,e.touchDownActivateCallback||t),o.removeEventListener(n.default.TAP,e.tapCallback||a),e.doubleTapCallback&&o.removeEventListener(n.default.DOUBLE_TAP,e.doubleTapCallback),e.pressCallback&&o.removeEventListener(n.default.TOUCH_PRESS,e.pressCallback),r.default.cornerstone.updateImage(o)},activate:function(o){o.removeEventListener(n.default.IMAGE_RENDERED,e.onImageRendered),o.removeEventListener(n.default.TOUCH_START,e.touchStartCallback||f),o.removeEventListener(n.default.TOUCH_START_ACTIVE,e.touchDownActivateCallback||t),o.removeEventListener(n.default.TAP,e.tapCallback||a),o.addEventListener(n.default.IMAGE_RENDERED,e.onImageRendered),o.addEventListener(n.default.TOUCH_START,e.touchStartCallback||f),o.addEventListener(n.default.TOUCH_START_ACTIVE,e.touchDownActivateCallback||t),o.addEventListener(n.default.TAP,e.tapCallback||a),e.doubleTapCallback&&(o.removeEventListener(n.default.DOUBLE_TAP,e.doubleTapCallback),o.addEventListener(n.default.DOUBLE_TAP,e.doubleTapCallback)),e.pressCallback&&(o.removeEventListener(n.default.TOUCH_PRESS,e.pressCallback),o.addEventListener(n.default.TOUCH_PRESS,e.pressCallback)),r.default.cornerstone.updateImage(o)},deactivate:function(o){var i=n.default.TOOL_DEACTIVATED,l={toolType:e.toolType,type:i};(0,s.default)(o,i,l),o.removeEventListener(n.default.IMAGE_RENDERED,e.onImageRendered),o.removeEventListener(n.default.TOUCH_START,e.touchStartCallback||f),o.removeEventListener(n.default.TOUCH_START_ACTIVE,e.touchDownActivateCallback||t),o.removeEventListener(n.default.TAP,e.tapCallback||a),o.addEventListener(n.default.IMAGE_RENDERED,e.onImageRendered),o.addEventListener(n.default.TOUCH_START,e.touchStartCallback||f),e.doubleTapCallback&&o.removeEventListener(n.default.DOUBLE_TAP,e.doubleTapCallback),e.pressCallback&&o.removeEventListener(n.default.TOUCH_PRESS,e.pressCallback),r.default.cornerstone.updateImage(o)},touchStartCallback:e.touchStartCallback||f,touchDownActivateCallback:e.touchDownActivateCallback||t,tapCallback:e.tapCallback||a};return e.pointNearTool&&(v.pointNearTool=e.pointNearTool),e.doubleTapCallback&&(v.doubleTapCallback=e.doubleTapCallback),e.pressCallback&&(v.pressCallback=e.pressCallback),e.addNewMeasurement&&(v.addNewMeasurement=e.addNewMeasurement),v}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=void 0,r=void 0,o=void 0;var i={setStartLoadHandler:function(e){n=e},getStartLoadHandler:function(){return n},setEndLoadHandler:function(e){r=e},getEndLoadHandler:function(){return r},setErrorLoadingHandler:function(e){o=e},getErrorLoadingHandler:function(){return o}};t.default=i},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a=e.image,r={left:0,top:0,width:a.width,height:a.height},o=!1;return Object.keys(t).forEach(function(e){var a=t[e];!0!==a.allowedOutsideImage&&!1===n.default.cornerstoneMath.point.insideRect(a,r)&&(o=!0)}),o};var n=function(e){return e&&e.__esModule?e:{default:e}}(a(0))},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=1,r=2;var o={setToolWidth:function(e){n=e},getToolWidth:function(){return n},setActiveWidth:function(e){r=e},getActiveWidth:function(){return r}};t.default=o},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(!t)throw new Error("simpleMouseButtonTool: toolType is required");var a={};return{activate:function(a,o){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};i.mouseButtonMask=o,(0,r.setToolOptions)(t,a,i),a.removeEventListener(n.default.MOUSE_DOWN_ACTIVATE,e),a.addEventListener(n.default.MOUSE_DOWN_ACTIVATE,e)},disable:function(t){t.removeEventListener(n.default.MOUSE_DOWN_ACTIVATE,e)},enable:function(t){t.removeEventListener(n.default.MOUSE_DOWN_ACTIVATE,e)},deactivate:function(t){t.removeEventListener(n.default.MOUSE_DOWN_ACTIVATE,e)},getConfiguration:function(){return a},setConfiguration:function(e){a=e}}};var n=function(e){return e&&e.__esModule?e:{default:e}}(a(1)),r=a(4)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=n.default.cornerstoneMath;if(e instanceof t.Vector3)return e;return new t.Vector3(e[0],e[1],e[2])};var n=function(e){return e&&e.__esModule?e:{default:e}}(a(0))},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a){var o=[n.default.TOUCH_DRAG];return a&&!0===a.fireOnTouchStart&&o.push(n.default.TOUCH_START),{activate:function(i){a&&a.eventData&&(0,r.setToolOptions)(t,i,a.eventData),o.forEach(function(t){i.removeEventListener(t,e),i.addEventListener(t,e)}),a&&a.activateCallback&&a.activateCallback(i),a&&a.touchStartCallback&&i.addEventListener(n.default.TOUCH_START,a.touchStartCallback),a&&a.touchEndCallback&&i.addEventListener(n.default.TOUCH_END,a.touchEndCallback)},disable:function(t){o.forEach(function(a){t.removeEventListener(a,e)}),a&&a.disableCallback&&a.disableCallback(t),a&&a.touchStartCallback&&t.removeEventListener(n.default.TOUCH_START,a.touchStartCallback),a&&a.touchEndCallback&&t.removeEventListener(n.default.TOUCH_END,a.touchEndCallback)},enable:function(t){o.forEach(function(a){t.removeEventListener(a,e)}),a&&a.enableCallback&&a.enableCallback(t),a&&a.touchStartCallback&&t.removeEventListener(n.default.TOUCH_START,a.touchStartCallback),a&&a.touchEndCallback&&t.removeEventListener(n.default.TOUCH_END,a.touchEndCallback)},deactivate:function(t){o.forEach(function(a){t.removeEventListener(a,e)}),a&&a.deactivateCallback&&a.deactivateCallback(t),a&&a.touchStartCallback&&t.removeEventListener(n.default.TOUCH_START,a.touchStartCallback),a&&a.touchEndCallback&&t.removeEventListener(n.default.TOUCH_END,a.touchEndCallback)}}};var n=function(e){return e&&e.__esModule?e:{default:e}}(a(1)),r=a(4)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.globalImageIdSpecificToolStateManager=t.newImageIdSpecificToolStateManager=void 0;var n=function(e){return e&&e.__esModule?e:{default:e}}(a(0));var r=(0,a(46).RegisterToolProxyState)();function o(){return{get:function(e,t){var a=n.default.cornerstone.getEnabledElement(e);if(a.image&&!1!==r.hasOwnProperty(a.image.imageId)){var o=r[a.image.imageId];if(!1!==o.hasOwnProperty(t))return o[t]}},add:function(e,t,a){var o=n.default.cornerstone.getEnabledElement(e);o.image&&!1!==r.hasOwnProperty(o.image.imageId)||(r[o.image.imageId]={});var i=r[o.image.imageId];!1===i.hasOwnProperty(t)&&(i[t]={data:[]}),i[t],i[t].data.push(a)},clear:function(e){var t=n.default.cornerstone.getEnabledElement(e);t.image&&!1!==r.hasOwnProperty(t.image.imageId)&&delete r[t.image.imageId]},saveImageIdToolState:function(e){return r[e]},restoreImageIdToolState:function(e,t){r[e]=t},saveToolState:function(){return r},restoreToolState:function(e){r=e},toolState:r}}var i=o();t.newImageIdSpecificToolStateManager=o,t.globalImageIdSpecificToolStateManager=i},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=15,r=n+"px Arial",o="transparent";var i={setFont:function(e){r=e},getFont:function(){return r},setFontSize:function(e){n=e},getFontSize:function(){return n},setBackgroundColor:function(e){o=e},getBackgroundColor:function(){return o}};t.default=i},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,i,l,u,d,c,s,f){var v=n.default.cornerstone,m=v.pixelToCanvas(t,a);s&&(m.x+=s);var g={centering:{x:!1,y:f}};if(a.boundingBox=(0,r.default)(e,i,m.x,m.y,d,g),a.hasMoved){var p=u(l).map(function(e){return v.pixelToCanvas(t,e)});(0,o.default)(p,m,a.boundingBox,e,d,c)}};var n=i(a(0)),r=i(a(9)),o=i(a(104));function i(e){return e&&e.__esModule?e:{default:e}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(e.boundingBox)return n.default.cornerstoneMath.point.insideRect(t,e.boundingBox)};var n=function(e){return e&&e.__esModule?e:{default:e}}(a(0))},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a=n.default.cornerstone,o=a.metaData.get("patientStudyModule",e.imageId),i=a.metaData.get("generalSeriesModule",e.imageId);if(o&&i&&"PT"===i.modality){var l=t*e.slope+e.intercept,u=o.patientWeight;if(u){var d=a.metaData.get("petIsotopeModule",e.imageId);if(d){var c=d.radiopharmaceuticalInfo,s=c.radiopharmaceuticalStartTime,f=c.radionuclideTotalDose,v=c.radionuclideHalfLife,m=i.seriesTime;if(s&&f&&v&&m){var g=r(m.fractionalSeconds||0)+m.seconds+60*m.minutes+60*m.hours*60-(r(s.fractionalSeconds)+s.seconds+60*s.minutes+60*s.hours*60);return l*u/(f*Math.exp(-g*Math.log(2)/v))*1e3}}}}};var n=function(e){return e&&e.__esModule?e:{default:e}}(a(0));function r(e){return parseFloat("."+e)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,o){var i=void 0;if(t)return Object.keys(t).forEach(function(l){var u=t[l];if(u.hasOwnProperty("pointNearHandle")){if(u.pointNearHandle(e,u,a))return void(i=u)}else if(!0===u.hasBoundingBox){if((0,r.default)(u,a))return void(i=u)}else{var d=n.default.cornerstone.pixelToCanvas(e,u);if(n.default.cornerstoneMath.point.distance(d,a)<=o)return void(i=u)}}),i};var n=o(a(0)),r=o(a(22));function o(e){return e&&e.__esModule?e:{default:e}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t={};return{disable:function(t){t.removeEventListener(n.default.IMAGE_RENDERED,e)},enable:function(t){t.removeEventListener(n.default.IMAGE_RENDERED,e),t.addEventListener(n.default.IMAGE_RENDERED,e),r.default.cornerstone.updateImage(t)},getConfiguration:function(){return t},setConfiguration:function(e){t=e}}};var n=o(a(1)),r=o(a(0));function o(e){return e&&e.__esModule?e:{default:e}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=void 0,r={default:6,IE:{9:6,10:8,default:8},Firefox:{default:6},Opera:{10:8,11:6,12:6,default:6},Chrome:{default:6},Safari:{default:6}};function o(){var e=navigator.userAgent,t=e.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[],a=void 0;return/trident/i.test(t[1])?"IE "+((a=/\brv[ :]+(\d+)/g.exec(e)||[])[1]||""):"Chrome"===t[1]&&null!==(a=e.match(/\b(OPR|Edge)\/(\d+)/))?a.slice(1).join(" ").replace("OPR","Opera"):(t=t[2]?[t[1],t[2]]:[navigator.appName,navigator.appVersion,"-?"],null!==(a=e.match(/version\/(\d+)/i))&&t.splice(1,1,a[1]),t.join(" "))}function i(){var e=o().split(" "),t=e[0],a=e[1],n=r[t];return n?n[a]?n[a]:n.default:r.default}t.getDefaultSimultaneousRequests=i,t.getMaxSimultaneousRequests=function(){return n||i()},t.setMaxSimultaneousRequests=function(e){n=e},t.getBrowserInfo=o,t.isMobileDevice=function(){return new RegExp("Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini").test(navigator.userAgent)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,l,u,d){var c=r.default.cornerstone,s=e.element,f={x:l.x-e.currentPoints.image.x,y:l.y-e.currentPoints.image.y};function v(e){var r=e.detail;!1===l.hasMoved&&(l.hasMoved=!0),l.active=!0,l.x=r.currentPoints.image.x+f.x,l.y=r.currentPoints.image.y+f.y,d&&(0,i.clipToBox)(l,r.image),c.updateImage(s);var u=n.default.MEASUREMENT_MODIFIED,v={toolType:t,element:s,measurementData:a};(0,o.default)(s,u,v)}function m(){l.active=!1,s.removeEventListener(n.default.MOUSE_DRAG,v),s.removeEventListener(n.default.MOUSE_UP,m),s.removeEventListener(n.default.MOUSE_CLICK,m),c.updateImage(s),"function"==typeof u&&u()}s.addEventListener(n.default.MOUSE_DRAG,v),s.addEventListener(n.default.MOUSE_UP,m),s.addEventListener(n.default.MOUSE_CLICK,m)};var n=l(a(1)),r=l(a(0)),o=l(a(5)),i=a(8);function l(e){return e&&e.__esModule?e:{default:e}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,l,u,d){var c=r.default.cornerstone,s=e.element;function f(e){var r=e.detail;l.active=!0,l.x=r.currentPoints.image.x,l.y=r.currentPoints.image.y,d&&(0,i.clipToBox)(l,r.image),c.updateImage(s);var u=n.default.MEASUREMENT_MODIFIED,f={toolType:t,element:s,measurementData:a};(0,o.default)(s,u,f)}function v(e){s.removeEventListener(n.default.MOUSE_MOVE,v),s.removeEventListener(n.default.MOUSE_DRAG,v),s.addEventListener(n.default.MOUSE_MOVE,f),s.addEventListener(n.default.MOUSE_DRAG,f),s.addEventListener(n.default.MOUSE_CLICK,p),e.type===n.default.MOUSE_DRAG&&s.addEventListener(n.default.MOUSE_UP,p)}function m(e){e.detail.measurementData===a&&p()}function g(e){e.detail.toolType===t&&(s.removeEventListener(n.default.MOUSE_MOVE,f),s.removeEventListener(n.default.MOUSE_DRAG,f),s.removeEventListener(n.default.MOUSE_CLICK,p),s.removeEventListener(n.default.MOUSE_UP,p),s.removeEventListener(n.default.MEASUREMENT_REMOVED,m),s.removeEventListener(n.default.TOOL_DEACTIVATED,g),l.active=!1,c.updateImage(s))}function p(){s.removeEventListener(n.default.MOUSE_MOVE,f),s.removeEventListener(n.default.MOUSE_DRAG,f),s.removeEventListener(n.default.MOUSE_CLICK,p),s.removeEventListener(n.default.MOUSE_UP,p),s.removeEventListener(n.default.MEASUREMENT_REMOVED,m),s.removeEventListener(n.default.TOOL_DEACTIVATED,g),l.active=!1,c.updateImage(s),"function"==typeof u&&u()}s.addEventListener(n.default.MOUSE_DRAG,v),s.addEventListener(n.default.MOUSE_MOVE,v),s.addEventListener(n.default.MEASUREMENT_REMOVED,m),s.addEventListener(n.default.TOOL_DEACTIVATED,g)};var n=l(a(1)),r=l(a(0)),o=l(a(5)),i=a(8);function l(e){return e&&e.__esModule?e:{default:e}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{activate:function(t){t.removeEventListener(n.default.MOUSE_WHEEL,e),t.addEventListener(n.default.MOUSE_WHEEL,e)},disable:function(t){t.removeEventListener(n.default.MOUSE_WHEEL,e)},enable:function(t){t.removeEventListener(n.default.MOUSE_WHEEL,e)},deactivate:function(t){t.removeEventListener(n.default.MOUSE_WHEEL,e)}}};var n=function(e){return e&&e.__esModule?e:{default:e}}(a(1))},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,l,u,d){var c=r.default.cornerstone,s=e.element,f=c.pageToPixel(s,e.currentPoints.page.x,e.currentPoints.page.y+50),v={x:l.x-f.x,y:l.y-f.y};function m(e){var r=e.detail;l.x=r.currentPoints.image.x+v.x,l.y=r.currentPoints.image.y+v.y,d&&(0,i.clipToBox)(l,r.image),c.updateImage(s);var u=n.default.MEASUREMENT_MODIFIED,f={toolType:t,element:s,measurementData:a};(0,o.default)(s,u,f)}function g(e){var t=e.detail;if(s.removeEventListener(n.default.TOUCH_DRAG,m),s.removeEventListener(n.default.TOUCH_PINCH,g),s.removeEventListener(n.default.TOUCH_END,g),s.removeEventListener(n.default.TAP,g),s.removeEventListener(n.default.TOUCH_START,p),s.removeEventListener(n.default.TOOL_DEACTIVATED,h),e.type===n.default.TOUCH_PINCH||e.type===n.default.TOUCH_PRESS)return l.active=!1,c.updateImage(s),void u();l.active=!1,a.active=!1,l.x=t.currentPoints.image.x+v.x,l.y=t.currentPoints.image.y+v.y,d&&(0,i.clipToBox)(l,t.image),c.updateImage(s),"function"==typeof u&&u()}function p(e){return e.stopImmediatePropagation(),!1}function h(){s.removeEventListener(n.default.TOUCH_DRAG,m),s.removeEventListener(n.default.TOUCH_PINCH,g),s.removeEventListener(n.default.TOUCH_END,g),s.removeEventListener(n.default.TAP,g),s.removeEventListener(n.default.TOUCH_START,p),s.removeEventListener(n.default.TOOL_DEACTIVATED,h),l.active=!1,a.active=!1,l.x=e.currentPoints.image.x+v.x,l.y=e.currentPoints.image.y+v.y,d&&(0,i.clipToBox)(l,e.image),c.updateImage(s)}l.active=!0,a.active=!0,s.addEventListener(n.default.TOUCH_DRAG,m),s.addEventListener(n.default.TOUCH_PINCH,g),s.addEventListener(n.default.TOUCH_END,g),s.addEventListener(n.default.TAP,g),s.addEventListener(n.default.TOUCH_START,p),s.addEventListener(n.default.TOOL_DEACTIVATED,h)};var n=l(a(1)),r=l(a(0)),o=l(a(5)),i=a(8);function l(e){return e&&e.__esModule?e:{default:e}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,r){var o=n.default.cornerstone,i={start:o.pixelToCanvas(e,t),end:o.pixelToCanvas(e,a)};return n.default.cornerstoneMath.lineSegment.distanceToPoint(i,r)};var n=function(e){return e&&e.__esModule?e:{default:e}}(a(0))},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RestoreStackProxyState=t.GetSatckProxyState=t.SetStackProxyWacher=t.RestoreToolProxyState=t.GetToolProxyState=t.SetToolProxyWacher=t.getToolOptions=t.setToolOptions=t.version=t.adaptiveBrush=t.brush=t.zoomTouchDrag=t.zoomTouchPinch=t.zoomWheel=t.zoom=t.wwwcRegionTouch=t.wwwcRegion=t.wwwcTouchDrag=t.wwwc=t.touchTool=t.touchPinchTool=t.touchDragTool=t.textMarkerTouch=t.textMarker=t.simpleMouseButtonTool=t.simpleAngleTouch=t.simpleAngle=t.seedAnnotateTouch=t.seedAnnotate=t.scaleOverlayTool=t.saveAs=t.rotateTouch=t.rotateTouchDrag=t.rotate=t.rectangleRoiTouch=t.rectangleRoi=t.probeTouch=t.probe=t.panMultiTouch=t.panTouchDrag=t.pan=t.orientationMarkers=t.multiTouchDragTool=t.mouseWheelTool=t.mouseButtonTool=t.mouseButtonRectangleTool=t.magnifyTouchDrag=t.magnify=t.lengthTouch=t.length=t.keyboardTool=t.imageStats=t.highlightTouch=t.highlight=t.eraserTouch=t.eraser=t.ellipticalRoiTouch=t.ellipticalRoi=t.dragProbeTouch=t.dragProbe=t.doubleTapZoom=void 0,t.doubleTapTool=t.displayTool=t.crosshairsTouch=t.crosshairs=t.arrowAnnotateTouch=t.arrowAnnotate=t.angleTouch=t.angle=t.touchInput=t.preventGhostClick=t.mouseWheelInput=t.mouseInput=t.keyboardInput=t.touchMoveHandle=t.touchMoveAllHandles=t.moveNewHandleTouch=t.moveNewHandle=t.moveHandle=t.moveAllHandles=t.handleActivator=t.getHandleNearImagePoint=t.drawHandles=t.anyHandlesOutsideImage=t.stopClip=t.playClip=t.stackRenderers=t.scrollIndicator=t.stackPrefetch=t.stackScrollMultiTouch=t.stackScrollTouchDrag=t.stackScrollWheel=t.stackScroll=t.stackScrollKeyboard=t.appState=t.globalFrameOfReferenceSpecificToolStateManager=t.newFrameOfReferenceSpecificToolStateManager=t.globalImageIdSpecificToolStateManager=t.newImageIdSpecificToolStateManager=t.loadHandlerManager=t.newProxyStackSpecificToolStateManager=t.addProxyStackStateManager=t.addStackStateManager=t.newStackSpecificToolStateManager=t.stackSpecificStateManager=t.textStyle=t.newTimeSeriesSpecificToolStateManager=t.addTimeSeriesStateManager=t.toolColors=t.toolCoordinates=t.getElementToolStateManager=t.setElementToolStateManager=t.clearToolState=t.removeToolState=t.getToolState=t.addToolState=t.toolStyle=t.panZoomSynchronizer=t.stackImageIndexSynchronizer=t.stackImagePositionOffsetSynchronizer=t.stackImagePositionSynchronizer=t.stackScrollSynchronizer=t.Synchronizer=t.updateImageSynchronizer=t.wwwcSynchronizer=t.timeSeriesScrollTouchDrag=t.timeSeriesScrollWheel=t.timeSeriesScroll=t.timeSeriesPlayer=t.incrementTimePoint=t.probeTool4D=t.calculateEllipseStatistics=t.calculateSUV=t.copyPoints=t.drawArrow=t.drawCircle=t.drawEllipse=t.drawTextBox=t.getLuminance=t.isMobileDevice=t.getBrowserInfo=t.getMaxSimultaneousRequests=t.getDefaultSimultaneousRequests=t.getRGBPixels=t.isMouseButtonEnabled=t.makeUnselectable=t.pointInEllipse=t.pointInsideBoundingBox=t.planePlaneIntersection=t.imagePointToPatientPoint=t.projectPatientPointToImagePlane=t.roundToDecimal=t.scroll=t.scrollToIndex=t.setContextToDisplayFontSize=t.requestPoolManager=t.orientation=t.referenceLines=t.EVENTS=t.external=t.drawing=void 0;var n=a(0);Object.defineProperty(t,"external",{enumerable:!0,get:function(){return ut(n).default}});var r=a(1);Object.defineProperty(t,"EVENTS",{enumerable:!0,get:function(){return ut(r).default}});var o=a(65);Object.defineProperty(t,"referenceLines",{enumerable:!0,get:function(){return ut(o).default}});var i=a(48);Object.defineProperty(t,"orientation",{enumerable:!0,get:function(){return ut(i).default}});var l=a(34);Object.defineProperty(t,"requestPoolManager",{enumerable:!0,get:function(){return ut(l).default}});var u=a(69);Object.defineProperty(t,"setContextToDisplayFontSize",{enumerable:!0,get:function(){return ut(u).default}});var d=a(49);Object.defineProperty(t,"scrollToIndex",{enumerable:!0,get:function(){return ut(d).default}});var c=a(35);Object.defineProperty(t,"scroll",{enumerable:!0,get:function(){return ut(c).default}});var s=a(36);Object.defineProperty(t,"roundToDecimal",{enumerable:!0,get:function(){return ut(s).default}});var f=a(33);Object.defineProperty(t,"projectPatientPointToImagePlane",{enumerable:!0,get:function(){return f.projectPatientPointToImagePlane}}),Object.defineProperty(t,"imagePointToPatientPoint",{enumerable:!0,get:function(){return f.imagePointToPatientPoint}}),Object.defineProperty(t,"planePlaneIntersection",{enumerable:!0,get:function(){return f.planePlaneIntersection}});var v=a(22);Object.defineProperty(t,"pointInsideBoundingBox",{enumerable:!0,get:function(){return ut(v).default}});var m=a(37);Object.defineProperty(t,"pointInEllipse",{enumerable:!0,get:function(){return ut(m).default}});var g=a(70);Object.defineProperty(t,"makeUnselectable",{enumerable:!0,get:function(){return ut(g).default}});var p=a(6);Object.defineProperty(t,"isMouseButtonEnabled",{enumerable:!0,get:function(){return ut(p).default}});var h=a(38);Object.defineProperty(t,"getRGBPixels",{enumerable:!0,get:function(){return ut(h).default}});var E=a(26);Object.defineProperty(t,"getDefaultSimultaneousRequests",{enumerable:!0,get:function(){return E.getDefaultSimultaneousRequests}}),Object.defineProperty(t,"getMaxSimultaneousRequests",{enumerable:!0,get:function(){return E.getMaxSimultaneousRequests}}),Object.defineProperty(t,"getBrowserInfo",{enumerable:!0,get:function(){return E.getBrowserInfo}}),Object.defineProperty(t,"isMobileDevice",{enumerable:!0,get:function(){return E.isMobileDevice}});var T=a(50);Object.defineProperty(t,"getLuminance",{enumerable:!0,get:function(){return ut(T).default}});var y=a(9);Object.defineProperty(t,"drawTextBox",{enumerable:!0,get:function(){return ut(y).default}});var M=a(71);Object.defineProperty(t,"drawEllipse",{enumerable:!0,get:function(){return ut(M).default}});var S=a(72);Object.defineProperty(t,"drawCircle",{enumerable:!0,get:function(){return ut(S).default}});var b=a(51);Object.defineProperty(t,"drawArrow",{enumerable:!0,get:function(){return ut(b).default}});var O=a(39);Object.defineProperty(t,"copyPoints",{enumerable:!0,get:function(){return ut(O).default}});var _=a(23);Object.defineProperty(t,"calculateSUV",{enumerable:!0,get:function(){return ut(_).default}});var P=a(52);Object.defineProperty(t,"calculateEllipseStatistics",{enumerable:!0,get:function(){return ut(P).default}});var x=a(73);Object.defineProperty(t,"probeTool4D",{enumerable:!0,get:function(){return ut(x).default}});var C=a(43);Object.defineProperty(t,"incrementTimePoint",{enumerable:!0,get:function(){return ut(C).default}});var I=a(76);Object.defineProperty(t,"timeSeriesPlayer",{enumerable:!0,get:function(){return ut(I).default}});var w=a(77);Object.defineProperty(t,"timeSeriesScroll",{enumerable:!0,get:function(){return w.timeSeriesScroll}}),Object.defineProperty(t,"timeSeriesScrollWheel",{enumerable:!0,get:function(){return w.timeSeriesScrollWheel}}),Object.defineProperty(t,"timeSeriesScrollTouchDrag",{enumerable:!0,get:function(){return w.timeSeriesScrollTouchDrag}});var L=a(78);Object.defineProperty(t,"wwwcSynchronizer",{enumerable:!0,get:function(){return ut(L).default}});var D=a(79);Object.defineProperty(t,"updateImageSynchronizer",{enumerable:!0,get:function(){return ut(D).default}});var A=a(80);Object.defineProperty(t,"Synchronizer",{enumerable:!0,get:function(){return ut(A).default}});var U=a(81);Object.defineProperty(t,"stackScrollSynchronizer",{enumerable:!0,get:function(){return ut(U).default}});var R=a(82);Object.defineProperty(t,"stackImagePositionSynchronizer",{enumerable:!0,get:function(){return ut(R).default}});var k=a(83);Object.defineProperty(t,"stackImagePositionOffsetSynchronizer",{enumerable:!0,get:function(){return ut(k).default}});var j=a(84);Object.defineProperty(t,"stackImageIndexSynchronizer",{enumerable:!0,get:function(){return ut(j).default}});var N=a(85);Object.defineProperty(t,"panZoomSynchronizer",{enumerable:!0,get:function(){return ut(N).default}});var H=a(15);Object.defineProperty(t,"toolStyle",{enumerable:!0,get:function(){return ut(H).default}});var V=a(2);Object.defineProperty(t,"addToolState",{enumerable:!0,get:function(){return V.addToolState}}),Object.defineProperty(t,"getToolState",{enumerable:!0,get:function(){return V.getToolState}}),Object.defineProperty(t,"removeToolState",{enumerable:!0,get:function(){return V.removeToolState}}),Object.defineProperty(t,"clearToolState",{enumerable:!0,get:function(){return V.clearToolState}}),Object.defineProperty(t,"setElementToolStateManager",{enumerable:!0,get:function(){return V.setElementToolStateManager}}),Object.defineProperty(t,"getElementToolStateManager",{enumerable:!0,get:function(){return V.getElementToolStateManager}});var B=a(40);Object.defineProperty(t,"toolCoordinates",{enumerable:!0,get:function(){return ut(B).default}});var W=a(7);Object.defineProperty(t,"toolColors",{enumerable:!0,get:function(){return ut(W).default}});var G=a(86);Object.defineProperty(t,"addTimeSeriesStateManager",{enumerable:!0,get:function(){return G.addTimeSeriesStateManager}}),Object.defineProperty(t,"newTimeSeriesSpecificToolStateManager",{enumerable:!0,get:function(){return G.newTimeSeriesSpecificToolStateManager}});var z=a(20);Object.defineProperty(t,"textStyle",{enumerable:!0,get:function(){return ut(z).default}});var F=a(87);Object.defineProperty(t,"stackSpecificStateManager",{enumerable:!0,get:function(){return F.stackSpecificStateManager}}),Object.defineProperty(t,"newStackSpecificToolStateManager",{enumerable:!0,get:function(){return F.newStackSpecificToolStateManager}}),Object.defineProperty(t,"addStackStateManager",{enumerable:!0,get:function(){return F.addStackStateManager}});var Y=a(88);Object.defineProperty(t,"addProxyStackStateManager",{enumerable:!0,get:function(){return Y.addProxyStackStateManager}}),Object.defineProperty(t,"newProxyStackSpecificToolStateManager",{enumerable:!0,get:function(){return Y.newProxyStackSpecificToolStateManager}});var K=a(13);Object.defineProperty(t,"loadHandlerManager",{enumerable:!0,get:function(){return ut(K).default}});var q=a(19);Object.defineProperty(t,"newImageIdSpecificToolStateManager",{enumerable:!0,get:function(){return q.newImageIdSpecificToolStateManager}}),Object.defineProperty(t,"globalImageIdSpecificToolStateManager",{enumerable:!0,get:function(){return q.globalImageIdSpecificToolStateManager}});var X=a(89);Object.defineProperty(t,"newFrameOfReferenceSpecificToolStateManager",{enumerable:!0,get:function(){return X.newFrameOfReferenceSpecificToolStateManager}}),Object.defineProperty(t,"globalFrameOfReferenceSpecificToolStateManager",{enumerable:!0,get:function(){return X.globalFrameOfReferenceSpecificToolStateManager}});var Z=a(90);Object.defineProperty(t,"appState",{enumerable:!0,get:function(){return ut(Z).default}});var J=a(91);Object.defineProperty(t,"stackScrollKeyboard",{enumerable:!0,get:function(){return ut(J).default}});var Q=a(92);Object.defineProperty(t,"stackScroll",{enumerable:!0,get:function(){return Q.stackScroll}}),Object.defineProperty(t,"stackScrollWheel",{enumerable:!0,get:function(){return Q.stackScrollWheel}}),Object.defineProperty(t,"stackScrollTouchDrag",{enumerable:!0,get:function(){return Q.stackScrollTouchDrag}}),Object.defineProperty(t,"stackScrollMultiTouch",{enumerable:!0,get:function(){return Q.stackScrollMultiTouch}});var $=a(93);Object.defineProperty(t,"stackPrefetch",{enumerable:!0,get:function(){return ut($).default}});var ee=a(94);Object.defineProperty(t,"scrollIndicator",{enumerable:!0,get:function(){return ut(ee).default}});var te=a(95);Object.defineProperty(t,"stackRenderers",{enumerable:!0,get:function(){return ut(te).default}});var ae=a(97);Object.defineProperty(t,"playClip",{enumerable:!0,get:function(){return ae.playClip}}),Object.defineProperty(t,"stopClip",{enumerable:!0,get:function(){return ae.stopClip}});var ne=a(14);Object.defineProperty(t,"anyHandlesOutsideImage",{enumerable:!0,get:function(){return ut(ne).default}});var re=a(11);Object.defineProperty(t,"drawHandles",{enumerable:!0,get:function(){return ut(re).default}});var oe=a(24);Object.defineProperty(t,"getHandleNearImagePoint",{enumerable:!0,get:function(){return ut(oe).default}});var ie=a(41);Object.defineProperty(t,"handleActivator",{enumerable:!0,get:function(){return ut(ie).default}});var le=a(42);Object.defineProperty(t,"moveAllHandles",{enumerable:!0,get:function(){return ut(le).default}});var ue=a(27);Object.defineProperty(t,"moveHandle",{enumerable:!0,get:function(){return ut(ue).default}});var de=a(28);Object.defineProperty(t,"moveNewHandle",{enumerable:!0,get:function(){return ut(de).default}});var ce=a(30);Object.defineProperty(t,"moveNewHandleTouch",{enumerable:!0,get:function(){return ut(ce).default}});var se=a(55);Object.defineProperty(t,"touchMoveAllHandles",{enumerable:!0,get:function(){return ut(se).default}});var fe=a(56);Object.defineProperty(t,"touchMoveHandle",{enumerable:!0,get:function(){return ut(fe).default}});var ve=a(98);Object.defineProperty(t,"keyboardInput",{enumerable:!0,get:function(){return ut(ve).default}});var me=a(99);Object.defineProperty(t,"mouseInput",{enumerable:!0,get:function(){return ut(me).default}});var ge=a(100);Object.defineProperty(t,"mouseWheelInput",{enumerable:!0,get:function(){return ut(ge).default}});var pe=a(57);Object.defineProperty(t,"preventGhostClick",{enumerable:!0,get:function(){return ut(pe).default}});var he=a(101);Object.defineProperty(t,"touchInput",{enumerable:!0,get:function(){return ut(he).default}});var Ee=a(102);Object.defineProperty(t,"angle",{enumerable:!0,get:function(){return Ee.angle}}),Object.defineProperty(t,"angleTouch",{enumerable:!0,get:function(){return Ee.angleTouch}});var Te=a(103);Object.defineProperty(t,"arrowAnnotate",{enumerable:!0,get:function(){return Te.arrowAnnotate}}),Object.defineProperty(t,"arrowAnnotateTouch",{enumerable:!0,get:function(){return Te.arrowAnnotateTouch}});var ye=a(105);Object.defineProperty(t,"crosshairs",{enumerable:!0,get:function(){return ye.crosshairs}}),Object.defineProperty(t,"crosshairsTouch",{enumerable:!0,get:function(){return ye.crosshairsTouch}});var Me=a(25);Object.defineProperty(t,"displayTool",{enumerable:!0,get:function(){return ut(Me).default}});var Se=a(58);Object.defineProperty(t,"doubleTapTool",{enumerable:!0,get:function(){return ut(Se).default}});var be=a(106);Object.defineProperty(t,"doubleTapZoom",{enumerable:!0,get:function(){return ut(be).default}});var Oe=a(107);Object.defineProperty(t,"dragProbe",{enumerable:!0,get:function(){return Oe.dragProbe}}),Object.defineProperty(t,"dragProbeTouch",{enumerable:!0,get:function(){return Oe.dragProbeTouch}});var _e=a(108);Object.defineProperty(t,"ellipticalRoi",{enumerable:!0,get:function(){return _e.ellipticalRoi}}),Object.defineProperty(t,"ellipticalRoiTouch",{enumerable:!0,get:function(){return _e.ellipticalRoiTouch}});var Pe=a(109);Object.defineProperty(t,"eraser",{enumerable:!0,get:function(){return Pe.eraser}}),Object.defineProperty(t,"eraserTouch",{enumerable:!0,get:function(){return Pe.eraserTouch}});var xe=a(110);Object.defineProperty(t,"highlight",{enumerable:!0,get:function(){return xe.highlight}}),Object.defineProperty(t,"highlightTouch",{enumerable:!0,get:function(){return xe.highlightTouch}});var Ce=a(111);Object.defineProperty(t,"imageStats",{enumerable:!0,get:function(){return ut(Ce).default}});var Ie=a(54);Object.defineProperty(t,"keyboardTool",{enumerable:!0,get:function(){return ut(Ie).default}});var we=a(112);Object.defineProperty(t,"length",{enumerable:!0,get:function(){return we.length}}),Object.defineProperty(t,"lengthTouch",{enumerable:!0,get:function(){return we.lengthTouch}});var Le=a(113);Object.defineProperty(t,"magnify",{enumerable:!0,get:function(){return Le.magnify}}),Object.defineProperty(t,"magnifyTouchDrag",{enumerable:!0,get:function(){return Le.magnifyTouchDrag}});var De=a(60);Object.defineProperty(t,"mouseButtonRectangleTool",{enumerable:!0,get:function(){return ut(De).default}});var Ae=a(10);Object.defineProperty(t,"mouseButtonTool",{enumerable:!0,get:function(){return ut(Ae).default}});var Ue=a(29);Object.defineProperty(t,"mouseWheelTool",{enumerable:!0,get:function(){return ut(Ue).default}});var Re=a(44);Object.defineProperty(t,"multiTouchDragTool",{enumerable:!0,get:function(){return ut(Re).default}});var ke=a(114);Object.defineProperty(t,"orientationMarkers",{enumerable:!0,get:function(){return ut(ke).default}});var je=a(115);Object.defineProperty(t,"pan",{enumerable:!0,get:function(){return je.pan}}),Object.defineProperty(t,"panTouchDrag",{enumerable:!0,get:function(){return je.panTouchDrag}});var Ne=a(116);Object.defineProperty(t,"panMultiTouch",{enumerable:!0,get:function(){return ut(Ne).default}});var He=a(117);Object.defineProperty(t,"probe",{enumerable:!0,get:function(){return He.probe}}),Object.defineProperty(t,"probeTouch",{enumerable:!0,get:function(){return He.probeTouch}});var Ve=a(118);Object.defineProperty(t,"rectangleRoi",{enumerable:!0,get:function(){return Ve.rectangleRoi}}),Object.defineProperty(t,"rectangleRoiTouch",{enumerable:!0,get:function(){return Ve.rectangleRoiTouch}});var Be=a(119);Object.defineProperty(t,"rotate",{enumerable:!0,get:function(){return Be.rotate}}),Object.defineProperty(t,"rotateTouchDrag",{enumerable:!0,get:function(){return Be.rotateTouchDrag}});var We=a(120);Object.defineProperty(t,"rotateTouch",{enumerable:!0,get:function(){return ut(We).default}});var Ge=a(121);Object.defineProperty(t,"saveAs",{enumerable:!0,get:function(){return ut(Ge).default}});var ze=a(122);Object.defineProperty(t,"scaleOverlayTool",{enumerable:!0,get:function(){return ut(ze).default}});var Fe=a(123);Object.defineProperty(t,"seedAnnotate",{enumerable:!0,get:function(){return Fe.seedAnnotate}}),Object.defineProperty(t,"seedAnnotateTouch",{enumerable:!0,get:function(){return Fe.seedAnnotateTouch}});var Ye=a(124);Object.defineProperty(t,"simpleAngle",{enumerable:!0,get:function(){return Ye.simpleAngle}}),Object.defineProperty(t,"simpleAngleTouch",{enumerable:!0,get:function(){return Ye.simpleAngleTouch}});var Ke=a(16);Object.defineProperty(t,"simpleMouseButtonTool",{enumerable:!0,get:function(){return ut(Ke).default}});var qe=a(125);Object.defineProperty(t,"textMarker",{enumerable:!0,get:function(){return qe.textMarker}}),Object.defineProperty(t,"textMarkerTouch",{enumerable:!0,get:function(){return qe.textMarkerTouch}});var Xe=a(18);Object.defineProperty(t,"touchDragTool",{enumerable:!0,get:function(){return ut(Xe).default}});var Ze=a(61);Object.defineProperty(t,"touchPinchTool",{enumerable:!0,get:function(){return ut(Ze).default}});var Je=a(12);Object.defineProperty(t,"touchTool",{enumerable:!0,get:function(){return ut(Je).default}});var Qe=a(126);Object.defineProperty(t,"wwwc",{enumerable:!0,get:function(){return Qe.wwwc}}),Object.defineProperty(t,"wwwcTouchDrag",{enumerable:!0,get:function(){return Qe.wwwcTouchDrag}});var $e=a(127);Object.defineProperty(t,"wwwcRegion",{enumerable:!0,get:function(){return $e.wwwcRegion}}),Object.defineProperty(t,"wwwcRegionTouch",{enumerable:!0,get:function(){return $e.wwwcRegionTouch}});var et=a(128);Object.defineProperty(t,"zoom",{enumerable:!0,get:function(){return et.zoom}}),Object.defineProperty(t,"zoomWheel",{enumerable:!0,get:function(){return et.zoomWheel}}),Object.defineProperty(t,"zoomTouchPinch",{enumerable:!0,get:function(){return et.zoomTouchPinch}}),Object.defineProperty(t,"zoomTouchDrag",{enumerable:!0,get:function(){return et.zoomTouchDrag}});var tt=a(129);Object.defineProperty(t,"brush",{enumerable:!0,get:function(){return tt.brush}});var at=a(130);Object.defineProperty(t,"adaptiveBrush",{enumerable:!0,get:function(){return at.adaptiveBrush}});var nt=a(131);Object.defineProperty(t,"version",{enumerable:!0,get:function(){return ut(nt).default}});var rt=a(4);Object.defineProperty(t,"setToolOptions",{enumerable:!0,get:function(){return rt.setToolOptions}}),Object.defineProperty(t,"getToolOptions",{enumerable:!0,get:function(){return rt.getToolOptions}});var ot=a(46);Object.defineProperty(t,"SetToolProxyWacher",{enumerable:!0,get:function(){return ot.SetToolProxyWacher}}),Object.defineProperty(t,"GetToolProxyState",{enumerable:!0,get:function(){return ot.GetToolProxyState}}),Object.defineProperty(t,"RestoreToolProxyState",{enumerable:!0,get:function(){return ot.RestoreToolProxyState}});var it=a(53);Object.defineProperty(t,"SetStackProxyWacher",{enumerable:!0,get:function(){return it.SetStackProxyWacher}}),Object.defineProperty(t,"GetSatckProxyState",{enumerable:!0,get:function(){return it.GetSatckProxyState}}),Object.defineProperty(t,"RestoreStackProxyState",{enumerable:!0,get:function(){return it.RestoreStackProxyState}});var lt=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a(3));function ut(e){return e&&e.__esModule?e:{default:e}}t.drawing=lt},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.projectPatientPointToImagePlane=function(e,t){var a=(0,r.default)(t.rowCosines),n=(0,r.default)(t.columnCosines),o=(0,r.default)(t.imagePositionPatient),i=e.clone().sub(o),l=a.dot(i)/t.columnPixelSpacing,u=n.dot(i)/t.rowPixelSpacing;return{x:l,y:u}},t.imagePointToPatientPoint=i,t.planePlaneIntersection=function(e,t){var a=(0,r.default)(e.rowCosines),o=(0,r.default)(e.columnCosines),l=(0,r.default)(e.imagePositionPatient),u=(0,r.default)(t.rowCosines),d=(0,r.default)(t.columnCosines),c=(0,r.default)(t.imagePositionPatient),s=a.clone().cross(o),f=new n.default.cornerstoneMath.Plane;f.setFromNormalAndCoplanarPoint(s,l);var v=u.clone().cross(d),m=new n.default.cornerstoneMath.Plane;m.setFromNormalAndCoplanarPoint(v,c);var g=m.clone().intersectPlane(f),p=g.origin,h=g.direction,E=i({x:t.columns,y:t.rows},t),T=c.distanceTo(E),y=new n.default.cornerstoneMath.Line3;y.start=p,y.end=p.clone().add(h.multiplyScalar(T));var M=function(e){var t=i({x:0,y:0},e),a=i({x:e.columns,y:0},e),r=i({x:0,y:e.rows},e),o=i({x:e.columns,y:e.rows},e);return{top:new n.default.cornerstoneMath.Line3(t,a),left:new n.default.cornerstoneMath.Line3(t,r),right:new n.default.cornerstoneMath.Line3(a,o),bottom:new n.default.cornerstoneMath.Line3(r,o)}}(t),S=function(e,t){var a=[];return Object.keys(t).forEach(function(n){var r=t[n],o=e.intersectLine(r);o&&a.push(o)}),a}(y,M);if(2!==S.length)return;return{start:S[0],end:S[1]}};var n=o(a(0)),r=o(a(17));function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var a=(0,r.default)(t.rowCosines),n=(0,r.default)(t.columnCosines),o=(0,r.default)(t.imagePositionPatient),i=a.clone().multiplyScalar(e.x);i.multiplyScalar(t.columnPixelSpacing);var l=n.clone().multiplyScalar(e.y);l.multiplyScalar(t.rowPixelSpacing);var u=i.add(l);return u.add(o),u}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(a(0)),r=a(26);var o={interaction:[],thumbnail:[],prefetch:[]},i={interaction:0,thumbnail:0,prefetch:0},l={interaction:6,thumbnail:6,prefetch:5},u=!1,d=20;function c(){u&&setTimeout(function(){f()},d)}function s(e){var t=n.default.cornerstone,a=e.type;i[a]++,u=!0;var r=e.imageId,o=e.doneCallback,l=e.failCallback,d=t.imageCache.getImageLoadObject(r);if(d)d.promise.then(function(e){i[a]--,o(e),c()},function(e){i[a]--,l(e),c()});else{var s=function(e){return"prefetch"===e.type?-5:"interactive"===e.type?0:"thumbnail"===e.type?5:void 0}(e);(!0===e.preventCache?t.loadImage(r,{priority:s,type:e.type}):t.loadAndCacheImage(r,{priority:s,type:e.type})).then(function(e){i[a]--,o(e),c()},function(e){i[a]--,l(e),c()})}}function f(){var e=(0,r.getMaxSimultaneousRequests)();l={interaction:Math.max(e,1),thumbnail:Math.max(e-2,1),prefetch:Math.max(e-1,1)};for(var t=e-(i.interaction+i.thumbnail+i.prefetch),a=0;a<t;a++){var n=v();n&&s(n)}}function v(){return o.interaction.length&&i.interaction<l.interaction?o.interaction.shift():o.thumbnail.length&&i.thumbnail<l.thumbnail?o.thumbnail.shift():o.prefetch.length&&i.prefetch<l.prefetch?o.prefetch.shift():(o.interaction.length||o.thumbnail.length||o.prefetch.length||(u=!1),!1)}t.default={addRequest:function(e,t,a,r,i,l,d){if(!o.hasOwnProperty(a))throw new Error("Request type must be one of interaction, thumbnail, or prefetch");if(e&&t){var c={type:a,imageId:t,preventCache:r,doneCallback:i,failCallback:l},s=n.default.cornerstone.imageCache.getImageLoadObject(t);s?s.promise.then(function(e){i(e)},function(e){l(e)}):(d?o[a].unshift(c):o[a].push(c),u=!0)}},clearRequestStack:function(e){if(!o.hasOwnProperty(e))throw new Error("Request type must be one of interaction, thumbnail, or prefetch");o[e]=[]},startGrabbing:f,getRequestPool:function(){return o}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],u=(0,o.getToolState)(e,"stack");if(u&&u.data&&u.data.length){var d=u.data[0];d.pending||(d.pending=[]);var c=d.currentImageIdIndex+t;if(a)c%=d.imageIds.length;else c=(0,i.default)(c,0,d.imageIds.length-1);if(l)(0,r.default)(e,c);else{var s={index:c};d.pending.push(s),function e(t,a,o){if(t.pending[0]===a){if(t.currentImageIdIndex===a.index)return t.pending.splice(t.pending.indexOf(a),1),void(t.pending.length>0&&e(t,t.pending[0],o));o.addEventListener(n.default.NEW_IMAGE,function e(i){t.imageIds.indexOf(i.detail.image.imageId)===a.index&&(t.pending.splice(t.pending.indexOf(a),1),o.removeEventListener(n.default.NEW_IMAGE,e),t.pending.length>0&&function e(t,a,o){if(t.pending[0]===a){if(t.currentImageIdIndex===a.index)return t.pending.splice(t.pending.indexOf(a),1),void(t.pending.length>0&&e(t,t.pending[0],o));o.addEventListener(n.default.NEW_IMAGE,function r(i){t.imageIds.indexOf(i.detail.image.imageId)===a.index&&(t.pending.splice(t.pending.indexOf(a),1),o.removeEventListener(n.default.NEW_IMAGE,r),t.pending.length>0&&e(t,t.pending[0],o))}),(0,r.default)(o,a.index)}}(t,t.pending[0],o))}),(0,r.default)(o,a.index)}}(d,s,e)}}};var n=l(a(1)),r=l(a(49)),o=a(2),i=l(a(8));function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t,a){if(e.pending[0]===t){if(e.currentImageIdIndex===t.index){e.pending.splice(e.pending.indexOf(t),1);if(e.pending.length>0){u(e,e.pending[0],a)}return}var o=function r(o){var i;if(e.imageIds.indexOf(o.detail.image.imageId)===t.index){e.pending.splice(e.pending.indexOf(t),1);a.removeEventListener(n.default.NEW_IMAGE,r);if(e.pending.length>0){u(e,e.pending[0],a)}}};a.addEventListener(n.default.NEW_IMAGE,o);(0,r.default)(a,t.index)}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a=Math.pow(10,t);return Math.round(e*a)/a}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a=e.width/2,n=e.height/2;if(a<=0||n<=0)return!1;var r=e.left+a,o=e.top+n,i=t.x-r,l=t.y-o;return i*i/(a*a)+l*l/(n*n)<=1}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,r,o){if(!e)throw new Error("getRGBPixels: parameter element must not be undefined");t=Math.round(t),a=Math.round(a);var i=n.default.cornerstone.getEnabledElement(e),l=[],u=0,d=i.image.getPixelData(),c=void 0,s=void 0,f=void 0;if(i.image.color)for(s=0;s<o;s++)for(f=0;f<r;f++){var v=d[c=4*((s+a)*i.image.columns+(f+t))],m=d[c+1],g=d[c+2],p=d[c+3];l[u++]=v,l[u++]=m,l[u++]=g,l[u++]=p}return l};var n=function(e){return e&&e.__esModule?e:{default:e}}(a(0))},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{page:n.default.cornerstoneMath.point.copy(e.page),image:n.default.cornerstoneMath.point.copy(e.image),client:n.default.cornerstoneMath.point.copy(e.client),canvas:n.default.cornerstoneMath.point.copy(e.canvas)}};var n=function(e){return e&&e.__esModule?e:{default:e}}(a(0))},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=void 0;var r={setCoords:function(e){n=e.currentPoints.canvas},getCoords:function(){return n}};t.default=r},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,r){r||(r=6);var o=function(e){var t=void 0;return Object.keys(e).forEach(function(a){var n=e[a];!0!==n.active||(t=n)}),t}(t),i=(0,n.default)(e,t,a,r);return o!==i&&(void 0!==i&&(i.active=!0),void 0!==o&&(o.active=!1),!0)};var n=function(e){return e&&e.__esModule?e:{default:e}}(a(24))},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,d,c,s){var f=r.default.cornerstone,v=e.detail.element;function m(e){var a=e.detail;t.active=!0,Object.keys(t.handles).forEach(function(e){var n=t.handles[e];!0!==n.movesIndependently&&(n.x+=a.deltaPoints.image.x,n.y+=a.deltaPoints.image.y,c.preventHandleOutsideImage&&(0,u.clipToBox)(n,a.image))}),f.updateImage(v);var r=n.default.MEASUREMENT_MODIFIED,o={toolType:d,element:v,measurementData:t};(0,l.default)(v,r,o),e.preventDefault(),e.stopPropagation()}function g(e){var a=e.detail;t.invalidated=!0,v.removeEventListener(n.default.MOUSE_DRAG,m),v.removeEventListener(n.default.MOUSE_UP,g),v.removeEventListener(n.default.MOUSE_CLICK,g),!0===c.deleteIfHandleOutsideImage&&(0,o.default)(a,t.handles)&&(0,i.removeToolState)(v,d,t),f.updateImage(v),"function"==typeof s&&s()}return v.addEventListener(n.default.MOUSE_DRAG,m),v.addEventListener(n.default.MOUSE_UP,g),v.addEventListener(n.default.MOUSE_CLICK,g),!0};var n=d(a(1)),r=d(a(0)),o=d(a(14)),i=a(2),l=d(a(5)),u=a(8);function d(e){return e&&e.__esModule?e:{default:e}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a){var l=(0,r.getToolState)(e,"timeSeries");if(l&&l.data&&l.data.length){var u=n.default.cornerstone,d=l.data[0],c=d.stacks[d.currentStackIndex].currentImageIdIndex,s=d.currentStackIndex+t;if(a?(s>=d.stacks.length&&(s=0),s<0&&(s=d.stacks.length-1)):s=(0,i.default)(s,0,d.stacks.length-1),s!==d.currentStackIndex){var f=u.getViewport(e),v=d.stacks[s],m=o.default.getStartLoadHandler(),g=o.default.getEndLoadHandler(),p=o.default.getErrorLoadingHandler();m&&m(e);(!0===v.preventCache?u.loadImage(v.imageIds[c]):u.loadAndCacheImage(v.imageIds[c])).then(function(t){d.currentImageIdIndex!==c&&(v.currentImageIdIndex=c,d.currentStackIndex=s,u.displayImage(e,t,f),g&&g(e,t))},function(t){var a=v.imageIds[c];p&&p(e,a,t)})}}};var n=l(a(0)),r=a(2),o=l(a(13)),i=l(a(8));function l(e){return e&&e.__esModule?e:{default:e}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a={},r=[n.default.MULTI_TOUCH_DRAG];return t&&!0===t.fireOnTouchStart&&r.push(n.default.MULTI_TOUCH_START),{activate:function(a){r.forEach(function(t){a.removeEventListener(t,e),a.addEventListener(t,e)}),t&&t.activateCallback&&t.activateCallback(a)},disable:function(a){r.forEach(function(t){a.removeEventListener(t,e)}),t&&t.disableCallback&&t.disableCallback(a)},enable:function(a){r.forEach(function(t){a.removeEventListener(t,e)}),t&&t.enableCallback&&t.enableCallback(a)},deactivate:function(a){r.forEach(function(t){a.removeEventListener(t,e)}),t&&t.deactivateCallback&&t.deactivateCallback(a)},getConfiguration:function(){return a},setConfiguration:function(e){a=e}}};var n=function(e){return e&&e.__esModule?e:{default:e}}(a(1))},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a=(0,n.planePlaneIntersection)(e,t);if(a)return{start:(0,n.projectPatientPointToImagePlane)(a.start,e),end:(0,n.projectPatientPointToImagePlane)(a.end,e)}};var n=a(33)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r={},o=function(e){return e};t.SetToolProxyWacher=function(e){o=e},t.RegisterToolProxyState=function(){var e={get:function(t,a){return"object"===n(t[a])&&null!==t[a]?new Proxy(t[a],e):t[a]},set:function(e,t,a){return e[t]=a,r=o(r),!0}};return new Proxy(r,e)},t.GetToolProxyState=function(){return r},t.RestoreToolProxyState=function(e){r=e}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,u){var d=n.default.cornerstone,c=d.getEnabledElement(a).image,s=d.getEnabledElement(u).image;if(c&&s){var f=d.metaData.get("imagePlaneModule",c.imageId),v=d.metaData.get("imagePlaneModule",s.imageId);if(f&&v&&f.rowCosines&&f.columnCosines&&f.imagePositionPatient&&v.rowCosines&&v.columnCosines&&v.imagePositionPatient&&f.frameOfReferenceUID===v.frameOfReferenceUID){f.rowCosines=(0,i.default)(f.rowCosines),f.columnCosines=(0,i.default)(f.columnCosines),f.imagePositionPatient=(0,i.default)(f.imagePositionPatient),v.rowCosines=(0,i.default)(v.rowCosines),v.columnCosines=(0,i.default)(v.columnCosines),v.imagePositionPatient=(0,i.default)(v.imagePositionPatient);var m=f.rowCosines.clone().cross(f.columnCosines),g=v.rowCosines.clone().cross(v.columnCosines),p=m.angleTo(g);if(!((p=Math.abs(p))<.5)){var h=(0,r.default)(f,v);if(h){var E=o.default.getActiveColor();e.setTransform(1,0,0,1,0,0),(0,l.draw)(e,function(e){(0,l.drawLine)(e,t.element,h.start,h.end,{color:E})})}}}}};var n=u(a(0)),r=u(a(45)),o=u(a(7)),i=u(a(17)),l=a(3);function u(e){return e&&e.__esModule?e:{default:e}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(a(67)),r=o(a(68));function o(e){return e&&e.__esModule?e:{default:e}}var i={getOrientationString:n.default,invertOrientationString:r.default};t.default=i},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a=(0,o.getToolState)(e,"stack");if(a&&a.data&&a.data.length){var d=r.default.cornerstone,c=void 0;if(a.data.length>1){var s=(0,o.getToolState)(e,"stackRenderer");s&&s.data&&s.data.length&&(c=s.data[0])}var f=a.data[0];t<0&&(t+=f.imageIds.length);var v=l.default.getStartLoadHandler(),m=l.default.getEndLoadHandler(),g=l.default.getErrorLoadingHandler();if(t!==f.currentImageIdIndex){v&&v(e);var p={newImageIdIndex:t,direction:t-f.currentImageIdIndex};f.currentImageIdIndex=t;var h=f.imageIds[t];(Boolean(f.preventCache)?d.loadImage(h):d.loadAndCacheImage(h)).then(function(n){if(f.currentImageIdIndex===t){try{d.getEnabledElement(e)}catch(e){return}c?(c.currentImageIdIndex=t,c.render(e,a.data)):d.displayImage(e,n),m&&m(e,n)}},function(a){var n=f.imageIds[t];g&&g(e,n,a)}),i.default.startGrabbing(),(0,u.default)(e,n.default.STACK_SCROLL,p)}}};var n=d(a(1)),r=d(a(0)),o=a(2),i=d(a(34)),l=d(a(13)),u=d(a(5));function d(e){return e&&e.__esModule?e:{default:e}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,r,o){if(!e)throw new Error("getLuminance: parameter element must not be undefined");t=Math.round(t),a=Math.round(a);var i=n.default.cornerstone.getEnabledElement(e).image,l=[],u=0,d=i.getPixelData(),c=void 0,s=void 0,f=void 0;if(i.color)for(s=0;s<o;s++)for(f=0;f<r;f++){var v=d[c=4*((s+a)*i.columns+(f+t))],m=d[c+1],g=d[c+2];l[u++]=.2126*v+.7152*m+.0722*g}else for(s=0;s<o;s++)for(f=0;f<r;f++)c=(s+a)*i.columns+(f+t),l[u++]=d[c]*i.slope+i.intercept;return l};var n=function(e){return e&&e.__esModule?e:{default:e}}(a(0))},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,r,o){var i=Math.atan2(a.y-t.y,a.x-t.x),l={color:r,lineWidth:o};(0,n.drawLine)(e,void 0,t,a,l,"canvas"),l={color:r,lineWidth:o,fillStyle:r};var u=[{x:a.x-10*Math.cos(i-Math.PI/7),y:a.y-10*Math.sin(i-Math.PI/7)},{x:a.x-10*Math.cos(i+Math.PI/7),y:a.y-10*Math.sin(i+Math.PI/7)},a];(0,n.drawJoinedLines)(e,void 0,a,u,l,"canvas")};var n=a(3)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){for(var a=0,r=0,o=0,i=0,l=t.top;l<t.top+t.height;l++)for(var u=t.left;u<t.left+t.width;u++){var d={x:u,y:l};(0,n.default)(t,d)&&(a+=e[i],r+=e[i]*e[i],o++),i++}if(0===o)return{count:o,mean:0,variance:0,stdDev:0};var c=a/o,s=r/o-c*c;return{count:o,mean:c,variance:s,stdDev:Math.sqrt(s)}};var n=function(e){return e&&e.__esModule?e:{default:e}}(a(37))},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r={},o=function(e){return e};t.SetStackProxyWacher=function(e){o=e},t.RegisterStackProxyState=function(){t.proxyState=r={};var e={get:function(t,a){return"object"===n(t[a])&&null!==t[a]?new Proxy(t[a],e):t[a]},set:function(e,a,n){return e[a]=n,t.proxyState=r=o(r),!0}};return new Proxy(r,e)},t.GetSatckProxyState=function(){return r},t.RestoreStackProxyState=function(e){t.proxyState=r=e},t.proxyState=r},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t={};return{activate:function(t){t.removeEventListener(n.default.KEY_DOWN,e),t.addEventListener(n.default.KEY_DOWN,e)},disable:function(t){t.removeEventListener(n.default.KEY_DOWN,e)},enable:function(t){t.removeEventListener(n.default.KEY_DOWN,e)},deactivate:function(t){t.removeEventListener(n.default.KEY_DOWN,e)},getConfiguration:function(){return t},setConfiguration:function(e){t=e}}};var n=function(e){return e&&e.__esModule?e:{default:e}}(a(1))},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,u,d,c){var s=e.detail.element,f=r.default.cornerstone;function v(e){var a=e.detail;t.active=!0,Object.keys(t.handles).forEach(function(e){var n=t.handles[e];!0!==n.movesIndependently&&(n.x+=a.deltaPoints.image.x,n.y+=a.deltaPoints.image.y)}),f.updateImage(s);var r=n.default.MEASUREMENT_MODIFIED,o={toolType:u,element:s,measurementData:t};(0,l.default)(s,r,o),e.preventDefault(),e.stopPropagation()}function m(e){var a=e.detail;t.active=!1,t.invalidated=!1,s.removeEventListener(n.default.TOUCH_DRAG,v),s.removeEventListener(n.default.TOUCH_PINCH,m),s.removeEventListener(n.default.TOUCH_PRESS,m),s.removeEventListener(n.default.TOUCH_END,m),s.removeEventListener(n.default.TOUCH_DRAG_END,m),s.removeEventListener(n.default.TAP,m);var r=(0,o.default)(a,t.handles);!0===d&&!0===r&&(0,i.removeToolState)(s,u,t),f.updateImage(s),"function"==typeof c&&c(e)}return s.addEventListener(n.default.TOUCH_DRAG,v),s.addEventListener(n.default.TOUCH_PINCH,m),s.addEventListener(n.default.TOUCH_PRESS,m),s.addEventListener(n.default.TOUCH_END,m),s.addEventListener(n.default.TOUCH_DRAG_END,m),s.addEventListener(n.default.TAP,m),!0};var n=u(a(1)),r=u(a(0)),o=u(a(14)),i=a(2),l=u(a(5));function u(e){return e&&e.__esModule?e:{default:e}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,i,d){l.value=!0;var c=e.detail,s=r.default.cornerstone,f=c.element,v=s.getEnabledElement(f),m=((new Date).getTime(),-57),g={x:c.currentPoints.page.x,y:c.currentPoints.page.y+m},p=s.pageToPixel(f,g.x,g.y);function h(e){var r=e.detail;l.value=!1,!1===i.hasMoved&&(i.hasMoved=!0),i.active=!0;var u=r.currentPoints,d={x:u.page.x,y:u.page.y+m};p=s.pageToPixel(f,d.x,d.y),i.x=p.x,i.y=p.y,s.updateImage(f);var c=n.default.MEASUREMENT_MODIFIED,v={toolType:t,element:f,measurementData:a};(0,o.default)(f,c,v)}function E(e){var t=e.detail;l.value=!1,i.active=!1,f.removeEventListener(n.default.TOUCH_DRAG,h),u.forEach(function(e){f.removeEventListener(e,E)}),s.updateImage(f),e.type===n.default.TOUCH_PRESS&&(t.handlePressed=a,i.x=c.currentPoints.image.x,i.y=c.currentPoints.image.y),"function"==typeof d&&d(e)}f.addEventListener(n.default.TOUCH_DRAG,h),u.forEach(function(e){f.addEventListener(e,E)}),function e(t,a,n,o,i){if(!n.value)return;var l=r.default.cornerstone;var u=(new Date).getTime();var d=Math.abs(a.y-i.y);var c=d/10;if(d<1)return a.y=i.y,void(n.value=!1);a.y>i.y?a.y-=c:a.y<i.y&&(a.y+=c);l.updateImage(o.element);l.requestAnimationFrame(function(){e(u,a,n,o,i)})}(0,i,l,v,p)};var n=i(a(1)),r=i(a(0)),o=i(a(5));function i(e){return e&&e.__esModule?e:{default:e}}var l={value:!1},u=[n.default.TOUCH_END,n.default.TOUCH_DRAG_END,n.default.TOUCH_PINCH,n.default.TOUCH_PRESS,n.default.TAP]},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=2e3,r={mouse:0,touch:1},o=void 0,i=void 0;function l(e,t){var a=Date.now();if(e!==o){if(a-i<=n)return t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),!1;o=e}i=a}var u=l.bind(null,r.mouse),d=l.bind(null,r.touch);function c(e,t,a){var n=a?u:d;t.forEach(function(t){e.addEventListener(t,n)})}function s(e,t,a){var n=a?u:d;t.forEach(function(t){e.removeEventListener(t,n)})}var f=["mousedown","mouseup"],v=["touchstart","touchend"];function m(e){s(e,f,r.mouse),s(e,v,r.touch)}var g={enable:function(e){m(e),c(e,f,r.mouse),c(e,v,r.touch)},disable:m};t.default=g},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{activate:function(t){t.removeEventListener(n.default.DOUBLE_TAP,e),t.addEventListener(n.default.DOUBLE_TAP,e)},disable:function(t){t.removeEventListener(n.default.DOUBLE_TAP,e)},enable:function(t){t.removeEventListener(n.default.DOUBLE_TAP,e)},deactivate:function(t){t.removeEventListener(n.default.DOUBLE_TAP,e)}}};var n=function(e){return e&&e.__esModule?e:{default:e}}(a(1))},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(!t)throw new Error("simpleTouchTool: toolType is required");var a={};return{activate:function(a){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,r.setToolOptions)(t,a,o),a.removeEventListener(n.default.TOUCH_START,e),a.addEventListener(n.default.TOUCH_START,e)},disable:function(t){t.removeEventListener(n.default.TOUCH_START,e)},enable:function(t){t.removeEventListener(n.default.TOUCH_START,e)},deactivate:function(t){t.removeEventListener(n.default.TOUCH_START,e)},getConfiguration:function(){return a},setConfiguration:function(e){a=e}}};var n=function(e){return e&&e.__esModule?e:{default:e}}(a(1)),r=a(4)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a=e.toolType;function m(r){var o=r.detail,i=o.element,l=(0,v.getToolOptions)(a,i);if((0,s.default)(o.which,l.mouseButtonMask))return function(r){var o=r.element,i=e.createNewMeasurement(r);i&&((0,f.addToolState)(r.element,a,i),o.removeEventListener(n.default.MOUSE_MOVE,g),(0,u.default)(r,a,i,i.handles.end,function(){i.active=!1,(0,c.default)(r,i.handles)&&(0,f.removeToolState)(r.element,a,i),o.addEventListener(n.default.MOUSE_MOVE,g)},t))}(o),!1}function g(t){var n=t.detail;o.default.setCoords(n);var i=(0,f.getToolState)(n.element,a);if(void 0!==i){for(var u=!1,d=n.currentPoints.canvas,c=0;c<i.data.length;c++){var s=i.data[c];!0===(0,l.default)(n.element,s.handles,d)&&(u=!0),(e.pointInsideRect(n.element,s,d)&&!s.active||!e.pointInsideRect(n.element,s,d)&&s.active)&&(s.active=!s.active,u=!0)}!0===u&&r.default.cornerstone.updateImage(n.element)}}function p(o){var l=o.detail,m=l.element,p=r.default.cornerstone,h=void 0,E=(0,v.getToolOptions)(a,m);if((0,s.default)(l.which,E.mouseButtonMask)){var T=l.startPoints.canvas,y=(0,f.getToolState)(o.currentTarget,a),M=void 0;if(void 0!==y)for(M=0;M<y.data.length;M++){h=y.data[M];var S=(0,i.default)(l.element,h.handles,T,25);if(void 0!==S)return m.removeEventListener(n.default.MOUSE_MOVE,g),h.active=!0,(0,u.default)(l,a,h,S,O,t),o.stopImmediatePropagation(),!1}var b={deleteIfHandleOutsideImage:!0,preventHandleOutsideImage:t};if(void 0!==y&&void 0!==e.pointInsideRect)for(M=0;M<y.data.length;M++)if(h=y.data[M],e.pointInsideRect(l.element,h,T))return m.removeEventListener(n.default.MOUSE_MOVE,g),(0,d.default)(o,h,y,a,b,O),m.addEventListener(n.default.MOUSE_MOVE,g),o.stopImmediatePropagation(),!1}function O(){h.active=!1,(0,c.default)(l,h.handles)&&(0,f.removeToolState)(l.element,a,h),p.updateImage(l.element),m.addEventListener(n.default.MOUSE_MOVE,g)}}return{enable:function(t){t.removeEventListener(n.default.IMAGE_RENDERED,e.onImageRendered),t.removeEventListener(n.default.MOUSE_MOVE,g),t.removeEventListener(n.default.MOUSE_DOWN,p),t.removeEventListener(n.default.MOUSE_DOWN_ACTIVATE,m),t.addEventListener(n.default.IMAGE_RENDERED,e.onImageRendered),r.default.cornerstone.updateImage(t)},disable:function(t){t.removeEventListener(n.default.IMAGE_RENDERED,e.onImageRendered),t.removeEventListener(n.default.MOUSE_MOVE,g),t.removeEventListener(n.default.MOUSE_DOWN,p),t.removeEventListener(n.default.MOUSE_DOWN_ACTIVATE,m),r.default.cornerstone.updateImage(t)},activate:function(t,o){(0,v.setToolOptions)(a,t,{mouseButtonMask:o}),t.removeEventListener(n.default.IMAGE_RENDERED,e.onImageRendered),t.removeEventListener(n.default.MOUSE_MOVE,g),t.removeEventListener(n.default.MOUSE_DOWN,p),t.removeEventListener(n.default.MOUSE_DOWN_ACTIVATE,m),t.addEventListener(n.default.IMAGE_RENDERED,e.onImageRendered),t.addEventListener(n.default.MOUSE_MOVE,g),t.addEventListener(n.default.MOUSE_DOWN,p),t.addEventListener(n.default.MOUSE_DOWN_ACTIVATE,m),r.default.cornerstone.updateImage(t)},deactivate:function(t,o){(0,v.setToolOptions)(a,t,{mouseButtonMask:o}),t.removeEventListener(n.default.IMAGE_RENDERED,e.onImageRendered),t.removeEventListener(n.default.MOUSE_MOVE,g),t.removeEventListener(n.default.MOUSE_DOWN,p),t.removeEventListener(n.default.MOUSE_DOWN_ACTIVATE,m),t.addEventListener(n.default.IMAGE_RENDERED,e.onImageRendered),t.addEventListener(n.default.MOUSE_MOVE,g),t.addEventListener(n.default.MOUSE_DOWN,p),r.default.cornerstone.updateImage(t)}}};var n=m(a(1)),r=m(a(0)),o=m(a(40)),i=m(a(24)),l=m(a(41)),u=m(a(27)),d=m(a(42)),c=m(a(14)),s=m(a(6)),f=a(2),v=a(4);function m(e){return e&&e.__esModule?e:{default:e}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{activate:function(t){t.removeEventListener(n.default.TOUCH_PINCH,e),t.addEventListener(n.default.TOUCH_PINCH,e)},disable:function(t){t.removeEventListener(n.default.TOUCH_PINCH,e)},enable:function(t){t.removeEventListener(n.default.TOUCH_PINCH,e)},deactivate:function(t){t.removeEventListener(n.default.TOUCH_PINCH,e)}}};var n=function(e){return e&&e.__esModule?e:{default:e}}(a(1))},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.toolType;function a(e){var t=e.detail,a=!1;a=function(e){var t=e.keyCode,a=!1;109===t||173===t?(g(),a=!0):61!==t&&107!==t||(m(),a=!0);return a}(t)||a,(a=function(e){var t=e.keyCode,a=!1;219===t?(h(),a=!0):221===t&&(p(),a=!0);return a}(t)||a)&&r.default.cornerstone.updateImage(t.element)}function c(e){var t=O.getConfiguration(),a=r.default.cornerstone.colors.getColormap(t.colormapId);t.draw=e;var n=a.getColor(t.draw);t.hoverColor="rgba("+n[[0]]+", "+n[[1]]+", "+n[[2]]+", 1.0 )",t.dragColor="rgba("+n[[0]]+", "+n[[1]]+", "+n[[2]]+", 0.8 )"}function m(){var e=O.getConfiguration();e.radius=(0,d.default)(e.radius+1,e.minRadius,e.maxRadius)}function g(){var e=O.getConfiguration();e.radius=(0,d.default)(e.radius-1,e.minRadius,e.maxRadius)}function p(){var e=O.getConfiguration(),t=E(),a=e.draw+1;a===t&&(a=0),c(a)}function h(){var e=O.getConfiguration(),t=E(),a=e.draw-1;a<0&&(a=t-1),c(a)}function E(){var e=O.getConfiguration(),t=r.default.cornerstone.colors.getColormap(e.colormapId);return t.getNumberOfColors()}function T(t){e.onMouseMove(t)}function y(t){var a=t.detail,r=a.element;e.onMouseUp(t),r.removeEventListener(n.default.MOUSE_DRAG,T),r.removeEventListener(n.default.MOUSE_DRAG,M),r.removeEventListener(n.default.MOUSE_UP,y),r.removeEventListener(n.default.MOUSE_CLICK,y)}function M(t){return e.onDrag(t),!1}function S(a){var r=a.detail,o=r.element,i=(0,u.getToolOptions)(t,o);if((0,l.default)(r.which,i.mouseButtonMask))return o.addEventListener(n.default.MOUSE_DRAG,M),o.addEventListener(n.default.MOUSE_UP,y),o.addEventListener(n.default.MOUSE_CLICK,y),e.onMouseDown(a),!1;o.addEventListener(n.default.MOUSE_DRAG,T),o.addEventListener(n.default.MOUSE_UP,y)}function b(t){var a=t.detail,n=a.element,i=(0,o.getToolState)(n,s),l=void 0;i?l=i.data[0].pixelData:(l=new Uint8ClampedArray(a.image.width*a.image.height),(0,o.addToolState)(n,s,{pixelData:l}));var u=r.default.cornerstone.getLayer(a.element,f);u.image.setPixelData(l),u.invalid=!0,r.default.cornerstone.updateImage(n),e.onImageRendered(t)}var O=(0,i.default)({mouseMoveCallback:T,mouseDownActivateCallback:S,onImageRendered:b,deactivate:function(e){e.removeEventListener(n.default.IMAGE_RENDERED,b),e.removeEventListener(n.default.MOUSE_DOWN_ACTIVATE,S),e.removeEventListener(n.default.MOUSE_MOVE,T),e.removeEventListener(n.default.KEY_DOWN,a),e.addEventListener(n.default.IMAGE_RENDERED,b),O.getConfiguration().active=!1}});return O.keyDownCallback=a,O.activate=function(e,i){(0,u.setToolOptions)(t,e,{mouseButtonMask:i}),e.removeEventListener(n.default.IMAGE_RENDERED,b),e.addEventListener(n.default.IMAGE_RENDERED,b),e.removeEventListener(n.default.MOUSE_DOWN_ACTIVATE,S),e.addEventListener(n.default.MOUSE_DOWN_ACTIVATE,S),e.removeEventListener(n.default.MOUSE_MOVE,T),e.addEventListener(n.default.MOUSE_MOVE,T),e.removeEventListener(n.default.KEY_DOWN,a),e.addEventListener(n.default.KEY_DOWN,a);var l=r.default.cornerstone.getEnabledElement(e),d=l.image,c=d.width,m=d.height,g=new Uint8ClampedArray(c*m),p=O.getConfiguration();p.active=!0;var h=p.colormapId;if(!h){var E=O.getConfiguration();(function(e){var t=r.default.cornerstone.colors.getColormap(e);t.setNumberOfColors(20),t.setColor(0,[255,255,255,0]),t.setColor(1,[230,25,75,102]),t.setColor(2,[60,180,175,102]),t.setColor(3,[255,225,25,102]),t.setColor(4,[0,130,200,102]),t.setColor(5,[245,130,48,102]),t.setColor(6,[145,30,180,102]),t.setColor(7,[70,240,240,102]),t.setColor(8,[240,50,230,102]),t.setColor(9,[210,245,60,102]),t.setColor(10,[250,190,190,102]),t.setColor(11,[0,128,128,102]),t.setColor(12,[230,190,255,102]),t.setColor(13,[170,110,40,102]),t.setColor(14,[255,250,200,102]),t.setColor(15,[128,0,0,102]),t.setColor(16,[170,255,195,102]),t.setColor(17,[128,128,0,102]),t.setColor(18,[255,215,180,102]),t.setColor(19,[0,0,128,102])})(h="BrushColorMap"),E.colormapId=h}var y={minPixelValue:0,maxPixelValue:1,slope:1,intercept:0,getPixelData:function(){return g},rows:l.image.height,columns:l.image.width,height:m,width:c,pixelData:g,setPixelData:function(e){g=e},colormap:h,color:!1,rgba:!1,labelmap:!0,invert:!1,columnPixelSpacing:1,rowPixelSpacing:1,sizeInBytes:l.image.width*l.image.height},M=void 0;v||(v=r.default.cornerstone.addLayer(e,r.default.cornerstone.getEnabledElement(e).image)),f&&(M=r.default.cornerstone.getLayer(e,f)),M||(f=r.default.cornerstone.addLayer(e,y,{viewport:{pixelReplication:!0}})),(0,o.addToolState)(e,s,{pixelData:g}),p.brushLayerId=f,O.setConfiguration(p),r.default.cornerstone.updateImage(e)},O.changeDrawColor=c,O.increaseRadius=m,O.decreaseRadius=g,O.nextSegmentation=p,O.previousSegmentation=h,O};var n=c(a(1)),r=c(a(0)),o=a(2),i=c(a(10)),l=c(a(6)),u=a(4),d=c(a(8));function c(e){return e&&e.__esModule?e:{default:e}}var s="brush",f=void 0,v=void 0},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=Math.round(n),i=Math.round(r);if(1===e)return[[o,i]];for(var l=[],u=0,d=-e;d<=e;d++){var c=i+d;if(!(c>t||c<0))for(var s=-e;s<=e;s++){var f=o+s;f>a||f<0||s*s+d*d<e*e&&(l[u++]=[o+s,i+d])}}return l}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawBrushOnCanvas=t.drawBrushPixels=void 0;var n=function(e){return e&&e.__esModule?e:{default:e}}(a(0)),r=a(3);t.drawBrushPixels=function(e,t,a,n){e.forEach(function(e){var r=function(e,t){return t*n+e}(e[0],e[1]);t[r]=a})},t.drawBrushOnCanvas=function(e,t,a,o){var i=n.default.cornerstone.pixelToCanvas(o,{x:0,y:0}),l=n.default.cornerstone.pixelToCanvas(o,{x:1,y:1}),u=l.x-i.x,d=l.y-i.y;(0,r.draw)(t,function(t){e.forEach(function(e){var i=n.default.cornerstone.pixelToCanvas(o,{x:e[0],y:e[1]}),l={left:i.x,top:i.y,width:u,height:d};(0,r.fillBox)(t,l,a)})})}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(a(45)),r=i(a(66)),o=i(a(47));function i(e){return e&&e.__esModule?e:{default:e}}var l={calculateReferenceLine:n.default,tool:r.default,renderActiveReferenceLine:o.default};t.default=l},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(a(1)),r=l(a(0)),o=a(2),i=l(a(47));function l(e){return e&&e.__esModule?e:{default:e}}var u="referenceLines";function d(e){var t=e.detail,a=(0,o.getToolState)(e.currentTarget,u);if(void 0!==a){var n=a.data[0].synchronizationContext.getSourceElements(),i=a.data[0].renderer,l=t.canvasContext.canvas.getContext("2d");r.default.cornerstone.setToPixelCoordinateSystem(t.enabledElement,l),n.forEach(function(a){a!==e.currentTarget&&i(l,t,e.currentTarget,a)})}}var c={enable:function(e,t,a){a=a||i.default,(0,o.addToolState)(e,u,{synchronizationContext:t,renderer:a}),e.removeEventListener(n.default.IMAGE_RENDERED,d),e.addEventListener(n.default.IMAGE_RENDERED,d),r.default.cornerstone.updateImage(e)},disable:function(e){e.removeEventListener(n.default.IMAGE_RENDERED,d),r.default.cornerstone.updateImage(e)}};t.default=c},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t=(0,r.default)(e),a="",o=t.x<0?"R":"L",i=t.y<0?"A":"P",l=t.z<0?"F":"H",u=new n.default.cornerstoneMath.Vector3(Math.abs(t.x),Math.abs(t.y),Math.abs(t.z)),d=0;d<3;d++)if(u.x>1e-4&&u.x>u.y&&u.x>u.z)a+=o,u.x=0;else if(u.y>1e-4&&u.y>u.x&&u.y>u.z)a+=i,u.y=0;else{if(!(u.z>1e-4&&u.z>u.x&&u.z>u.y))break;a+=l,u.z=0}return a};var n=o(a(0)),r=o(a(17));function o(e){return e&&e.__esModule?e:{default:e}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.replace("H","f");return t=(t=(t=(t=(t=(t=t.replace("F","h")).replace("R","l")).replace("L","r")).replace("A","p")).replace("P","a")).toUpperCase()}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a){return n.default.cornerstone.setToPixelCoordinateSystem(e,t,.1),{fontSize:a/e.viewport.scale/.1,lineHeight:a/e.viewport.scale/.1,fontScale:.1}};var n=function(e){return e&&e.__esModule?e:{default:e}}(a(0))},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){e.style.webkitUserSelect="none",e.style.webkitTouchCallout="none",e.style.mozUserSelect="none",e.style.msUserSelect="none",e.style.oUserSelect="none",e.style.khtmlUserSelect="none",e.style.userSelect="none",e.unselectable="on",e.oncontextmenu=function(){return!1},!0===t&&(e.style.pointerEvents="none")}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,r,o){var i={x:t,y:a},l={x:t+r,y:a+o};(0,n.drawEllipse)(e,void 0,i,l,{},"canvas")};var n=a(3)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,r){var o={color:a,lineWidth:r};(0,n.drawCircle)(e,void 0,t,6,o,"canvas")};var n=a(3)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(a(0)),r=s(a(10)),o=s(a(11)),i=a(2),l=s(a(74)),u=s(a(75)),d=s(a(9)),c=a(3);function s(e){return e&&e.__esModule?e:{default:e}}var f="probe4D";var v=(0,r.default)({createNewMeasurement:function(e){var t=(0,i.getToolState)(e.element,"timeSeries");if(void 0!==t&&void 0!==t.data&&0!==t.data.length){var a=t.data[0],r={timeSeries:a,lineSample:new u.default,imageIdIndex:a.stacks[a.currentStackIndex].currentImageIdIndex,visible:!0,handles:{end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0}}};return function(e){var t=n.default.cornerstone,a=[];e.timeSeries.stacks.forEach(function(n){(!0===n.preventCache?t.loadImage(n.imageIds[e.imageIdIndex]):t.loadAndCacheImage(n.imageIds[e.imageIdIndex])).then(function(t){var n=Math.round(e.handles.end.x)+Math.round(e.handles.end.y)*t.width,r=t.getPixelData()[n];a.push(r)})}),e.lineSample.set(a)}(r),l.default.add(r),r}},onImageRendered:function(e){var t=n.default.cornerstone,a=e.detail,r=(0,i.getToolState)(e.currentTarget,f);if(r){var l=a.canvasContext;l.setTransform(1,0,0,1,0,0);for(var u=function(e){(0,c.draw)(l,function(n){var i=r.data[e];(0,o.default)(n,a,i.handles,"white");var l={x:i.handles.end.x+3,y:i.handles.end.y-3},u=t.pixelToCanvas(a.element,l);(0,d.default)(n,i.handles.end.x+", "+i.handles.end.y,u.x,u.y,"white")})},s=0;s<r.data.length;s++)u(s)}},toolType:f});t.default=v},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(a(1)),r=i(a(0)),o=i(a(5));function i(e){return e&&e.__esModule?e:{default:e}}var l=new function(){var e=r.default.cornerstone,t=this;t.measurements=[],this.add=function(a){var r={index:t.measurements.push(a),measurement:a};(0,o.default)(e.events,n.default.MEASUREMENT_ADDED,r)},this.remove=function(a){var r=t.measurements[a];t.measurements.splice(a,1);var i={index:a,measurement:r};(0,o.default)(e.events,n.default.MEASUREMENT_REMOVED,i)}};t.default=l},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=r.default.cornerstone,t=this;t.samples=[],this.set=function(a){t.samples=a,(0,o.default)(e.events,n.default.LINE_SAMPLE_UPDATED)}};var n=i(a(1)),r=i(a(0)),o=i(a(5));function i(e){return e&&e.__esModule?e:{default:e}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2),r=function(e){return e&&e.__esModule?e:{default:e}}(a(43));var o="timeSeriesPlayer";var i={start:function(e,t){if(void 0===e)throw new Error("playClip: element must not be undefined");void 0===t&&(t=30);var a=(0,n.getToolState)(e,"timeSeries");if(void 0!==a&&void 0!==a.data&&0!==a.data.length){var i=(0,n.getToolState)(e,o),l=void 0;void 0===i||0===i.data.length?(l={intervalId:void 0,framesPerSecond:t,lastFrameTimeStamp:void 0,frameRate:0},(0,n.addToolState)(e,o,l)):(l=i.data[0]).framesPerSecond=t,void 0===l.intervalId&&(l.intervalId=setInterval(function(){l.framesPerSecond>0?(0,r.default)(e,1,!0):(0,r.default)(e,-1,!0)},1e3/Math.abs(l.framesPerSecond)))}},stop:function(e){var t=(0,n.getToolState)(e,o);if(t&&t.data&&t.data.length){var a=t.data[0];clearInterval(a.intervalId),a.intervalId=void 0}}};t.default=i},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.timeSeriesScrollTouchDrag=t.timeSeriesScrollWheel=t.timeSeriesScroll=void 0;var n=s(a(1)),r=s(a(16)),o=s(a(18)),i=s(a(29)),l=s(a(43)),u=s(a(6)),d=a(2),c=a(4);function s(e){return e&&e.__esModule?e:{default:e}}var f="timeSeriesScroll";function v(e){var t=e.detail.element;t.removeEventListener(n.default.MOUSE_DRAG,m),t.removeEventListener(n.default.MOUSE_UP,v),t.removeEventListener(n.default.MOUSE_CLICK,v)}function m(e){var t=e.detail,a=t.element;e.data.deltaY+=t.deltaPoints.page.y;var n=(0,d.getToolState)(t.element,"timeSeries");if(void 0!==n&&void 0!==n.data&&0!==n.data.length){var r=n.data[0],o=a.offsetHeight/r.stacks.length;if(void 0!==e.data.options&&void 0!==e.data.options.timeSeriesScrollSpeed&&(o=e.data.options.timeSeriesScrollSpeed),e.data.deltaY>=o||e.data.deltaY<=-o){var i=Math.round(e.data.deltaY/o),u=e.data.deltaY%o;(0,l.default)(t.element,i),e.data.deltaY=u}return!1}}var g=(0,r.default)(function(e){var t=e.detail,a=t.element,r=(0,c.getToolOptions)(f,a);if((0,u.default)(t.which,r.mouseButtonMask))return r.deltaY=0,(0,c.setToolOptions)(f,a,r),a.addEventListener(n.default.MOUSE_DRAG,m),a.addEventListener(n.default.MOUSE_UP,v),a.addEventListener(n.default.MOUSE_CLICK,v),e.stopImmediatePropagation(),!1},f),p=(0,i.default)(function(e){var t=e.detail,a=-t.direction;(0,l.default)(t.element,a)}),h=(0,o.default)(function(e){var t=e.originalEvent.detail,a={deltaY:0};a.deltaY+=t.deltaPoints.page.y;var n=(0,d.getToolState)(t.element,"stack");if(void 0!==n&&void 0!==n.data&&0!==n.data.length){if(a.deltaY>=3||a.deltaY<=-3){var r=a.deltaY/3,o=a.deltaY%3;(0,l.default)(a.element,r),a.deltaY=o}return!1}});t.timeSeriesScroll=g,t.timeSeriesScrollWheel=p,t.timeSeriesScrollTouchDrag=h},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a){if(a!==t){var r=n.default.cornerstone,o=r.getViewport(t),i=r.getViewport(a);i.voi.windowWidth===o.voi.windowWidth&&i.voi.windowCenter===o.voi.windowCenter&&i.invert===o.invert||(i.voi.windowWidth=o.voi.windowWidth,i.voi.windowCenter=o.voi.windowCenter,i.invert=o.invert,e.setViewport(a,i))}};var n=function(e){return e&&e.__esModule?e:{default:e}}(a(0))},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a){a!==t&&n.default.cornerstone.updateImage(a)};var n=function(e){return e&&e.__esModule?e:{default:e}}(a(0))},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(a(1)),r=l(a(0)),o=l(a(17)),i=a(4);function l(e){return e&&e.__esModule?e:{default:e}}function u(e){return e.filter(function(e,t,a){return a.indexOf(e)===t})}t.default=function(e,t){var a=r.default.cornerstone,l=this,d=[],c=[],s=!1,f={},v=t;function m(e,t){l.enabled&&d.length&&c.length&&(s=!0,c.forEach(function(a){var n=c.indexOf(a);if(-1!==n){var r=f.imageIds.targetElements[n],o=d.indexOf(e);if(-1!==o){var i=f.imageIds.sourceElements[o],u=void 0;i===r?u=0:void 0!==f.distances[i]&&(u=f.distances[i][r]),v(l,e,a,t,u)}}}),s=!1)}function g(e){var t=e.detail;!0!==s&&m(e.currentTarget,t)}function p(e){var t=e.detail.element;l.remove(t),(0,i.clearToolOptionsByElement)(t)}this.enabled=!0,this.setHandler=function(e){v=e},this.getHandler=function(){return v},this.getDistances=function(){d.length&&c.length&&(f.distances={},f.imageIds={sourceElements:[],targetElements:[]},d.forEach(function(e){var t=a.getEnabledElement(e);if(t&&t.image){var n=t.image.imageId,r=a.metaData.get("imagePlaneModule",n);if(r&&r.imagePositionPatient){var i=(0,o.default)(r.imagePositionPatient);f.hasOwnProperty(t)||(f.distances[n]={},f.imageIds.sourceElements.push(n),c.forEach(function(t){var r=a.getEnabledElement(t);if(r&&r.image){var l=r.image.imageId;if(f.imageIds.targetElements.push(l),e!==t&&n!==l&&!f.distances[n].hasOwnProperty(l)){var u=a.metaData.get("imagePlaneModule",l);if(u&&u.imagePositionPatient){var d=(0,o.default)(u.imagePositionPatient);f.distances[n][l]=d.clone().sub(i)}}}}),Object.keys(f.distances[n]).length||delete f.distances[n])}}}))},this.addSource=function(t){-1===d.indexOf(t)&&(d.push(t),e.split(" ").forEach(function(e){t.addEventListener(e,g)}),l.getDistances(),l.updateDisableHandlers())},this.addTarget=function(e){-1===c.indexOf(e)&&(c.push(e),l.getDistances(),v(l,e,e,0),l.updateDisableHandlers())},this.add=function(e){l.addSource(e),l.addTarget(e)},this.removeSource=function(t){var a=d.indexOf(t);-1!==a&&(d.splice(a,1),e.split(" ").forEach(function(e){t.removeEventListener(e,g)}),l.getDistances(),m(t),l.updateDisableHandlers())},this.removeTarget=function(e){var t=c.indexOf(e);-1!==t&&(c.splice(t,1),l.getDistances(),v(l,e,e,0),l.updateDisableHandlers())},this.remove=function(e){l.removeTarget(e),l.removeSource(e)},this.getSourceElements=function(){return d},this.getTargetElements=function(){return c},this.displayImage=function(e,t,n){s=!0,a.displayImage(e,t,n),s=!1},this.setViewport=function(e,t){s=!0,a.setViewport(e,t),s=!1},this.updateDisableHandlers=function(){u(d.concat(c)).forEach(function(e){e.removeEventListener(n.default.ELEMENT_DISABLED,p),e.addEventListener(n.default.ELEMENT_DISABLED,p)})},this.destroy=function(){u(d.concat(c)).forEach(function(e){l.remove(e)})}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,l){if(t!==a&&l&&l.direction){var u=n.default.cornerstone,d=(0,r.getToolState)(a,"stack").data[0],c=d.currentImageIdIndex+l.direction;if(c=(0,i.default)(c,0,d.imageIds.length-1),d.currentImageIdIndex!==c){var s=o.default.getStartLoadHandler(),f=o.default.getEndLoadHandler(),v=o.default.getErrorLoadingHandler();d.currentImageIdIndex=c;var m=d.imageIds[c];s&&s(a);(!0===d.preventCache?u.loadImage(m):u.loadAndCacheImage(m)).then(function(t){var n=u.getViewport(a);d.currentImageIdIndex===c&&(e.displayImage(a,t,n),f&&f(a,t))},function(e){var t=d.imageIds[c];v&&v(a,t,e)})}}};var n=l(a(0)),r=a(2),o=l(a(13)),i=l(a(8));function l(e){return e&&e.__esModule?e:{default:e}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a){if(a!==t){var l=n.default.cornerstone,u=l.getEnabledElement(t).image,d=l.metaData.get("imagePlaneModule",u.imageId);if(void 0!==d&&void 0!==d.imagePositionPatient){var c=(0,i.default)(d.imagePositionPatient),s=(0,r.getToolState)(a,"stack").data[0],f=Number.MAX_VALUE,v=-1;if(s.imageIds.forEach(function(e,t){var a=l.metaData.get("imagePlaneModule",e);if(void 0!==a&&void 0!==a.imagePositionPatient){var n=(0,i.default)(a.imagePositionPatient).distanceToSquared(c);n<f&&(f=n,v=t)}}),v!==s.currentImageIdIndex){var m=o.default.getStartLoadHandler(),g=o.default.getEndLoadHandler(),p=o.default.getErrorLoadingHandler();s.currentImageIdIndex=v;var h=s.imageIds[v];if(m&&m(a),-1!==v){(!0===s.preventCache?l.loadImage(h):l.loadAndCacheImage(h)).then(function(t){var n=l.getViewport(a);s.currentImageIdIndex===v&&(e.displayImage(a,t,n),g&&g(a,t))},function(e){var t=s.imageIds[v];p&&p(a,t,e)})}}}}};var n=l(a(0)),r=a(2),o=l(a(13)),i=l(a(17));function l(e){return e&&e.__esModule?e:{default:e}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,l,u){if(a!==t){var d=n.default.cornerstone,c=d.getEnabledElement(t),s=d.metaData.get("imagePlaneModule",c.image.imageId);if(void 0!==s&&void 0!==s.imagePositionPatient){var f=(0,i.default)(s.imagePositionPatient),v=(0,r.getToolState)(a,"stack").data[0],m=Number.MAX_VALUE,g=-1;if(u){var p=f.clone().add(u);if(v.imageIds.forEach(function(e,t){var a=d.metaData.get("imagePlaneModule",e);if(void 0!==a&&void 0!==a.imagePositionPatient){var n=(0,i.default)(a.imagePositionPatient),r=p.distanceToSquared(n);r<m&&(m=r,g=t)}}),g!==v.currentImageIdIndex&&-1!==g){var h=o.default.getStartLoadHandler(),E=o.default.getEndLoadHandler(),T=o.default.getErrorLoadingHandler();v.currentImageIdIndex=g;var y=v.imageIds[g];h&&h(a);(!0===v.preventCache?d.loadImage(y):d.loadAndCacheImage(y)).then(function(t){var n=d.getViewport(a);v.currentImageIdIndex===g&&(e.displayImage(a,t,n),E&&E(a,t))},function(e){var t=v.imageIds[g];T&&T(a,t,e)})}}}}};var n=l(a(0)),r=a(2),o=l(a(13)),i=l(a(17));function l(e){return e&&e.__esModule?e:{default:e}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a){if(a!==t){var l=n.default.cornerstone,u=(0,r.getToolState)(t,"stack").data[0],d=(0,r.getToolState)(a,"stack").data[0],c=u.currentImageIdIndex;if((c=(0,i.default)(c,0,d.imageIds.length-1))!==d.currentImageIdIndex){var s=o.default.getStartLoadHandler(),f=o.default.getEndLoadHandler(),v=o.default.getErrorLoadingHandler();s&&s(a);(!0===d.preventCache?l.loadImage(d.imageIds[c]):l.loadAndCacheImage(d.imageIds[c])).then(function(t){var n=l.getViewport(a);d.currentImageIdIndex=c,e.displayImage(a,t,n),f&&f(a,t)},function(e){var t=d.imageIds[c];v&&v(a,t,e)})}}};var n=l(a(0)),r=a(2),o=l(a(13)),i=l(a(8));function l(e){return e&&e.__esModule?e:{default:e}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a){if(a!==t){var r=n.default.cornerstone,o=r.getViewport(t),i=r.getViewport(a);i.scale===o.scale&&i.translation.x===o.translation.x&&i.translation.y===o.translation.y||(i.scale=o.scale,i.translation.x=o.translation.x,i.translation.y=o.translation.y,e.setViewport(a,i))}};var n=function(e){return e&&e.__esModule?e:{default:e}}(a(0))},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.newTimeSeriesSpecificToolStateManager=t.addTimeSeriesStateManager=void 0;var n=a(19),r=a(2);function o(e,t){var a={};return{get:function(n,r){return e.indexOf(r)>=0?(!1===a.hasOwnProperty(r)&&(a[r]={data:[]}),a[r]):t.get(n,r)},add:function(n,r,o){if(!(e.indexOf(r)>=0))return t.add(n,r,o);!1===a.hasOwnProperty(r)&&(a[r]={data:[]}),a[r].data.push(o)}}}var i=[];t.addTimeSeriesStateManager=function(e,t){t=t||["timeSeries"];var a=(0,r.getElementToolStateManager)(e);void 0===a&&(a=n.globalImageIdSpecificToolStateManager);var l=o(t,a);i.push(l),(0,r.setElementToolStateManager)(e,l)},t.newTimeSeriesSpecificToolStateManager=o},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addStackStateManager=t.newStackSpecificToolStateManager=t.stackSpecificStateManager=void 0;var n=a(19),r=a(2);function o(e,t){var a={};return{get:function(n,r){return e.indexOf(r)>=0?(!1===a.hasOwnProperty(r)&&(a[r]={data:[]}),a[r]):t.get(n,r)},add:function(n,r,o){if(!(e.indexOf(r)>=0))return t.add(n,r,o);!1===a.hasOwnProperty(r)&&(a[r]={data:[]}),a[r].data.push(o)},saveToolState:function(){return a},restoreToolState:function(e){a=e},toolState:a}}var i=[];function l(e,t){var a=(0,r.getElementToolStateManager)(e);a||(a=n.globalImageIdSpecificToolStateManager);var l=["stack","stackPrefetch","playClip","volume","slab","referenceLines","crosshairs","stackRenderer"];t&&(l=l.concat(t));var u=o(l,a);i.push(u),(0,r.setElementToolStateManager)(e,u)}var u={newStackSpecificToolStateManager:o,addStackStateManager:l};t.stackSpecificStateManager=u,t.newStackSpecificToolStateManager=o,t.addStackStateManager=l},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addProxyStackStateManager=t.newProxyStackSpecificToolStateManager=void 0;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=a(19),o=a(2),i=(0,a(53).RegisterStackProxyState)();function l(e,t,a){var r={},o=a,l={get:function(e,t){return"object"===n(e[t])&&null!==e[t]?new Proxy(e[t],l):e[t]},set:function(e,t,a){return e[t]=a,i[o]=r,!0}},u=new Proxy(r,l);return i[o]=u,{get:function(a,n){return e.indexOf(n)>=0?(!1===u.hasOwnProperty(n)&&(u[n]={data:[]}),u[n]):t.get(a,n)},add:function(a,n,r){if(!(e.indexOf(n)>=0))return t.add(a,n,r);!1===u.hasOwnProperty(n)&&(u[n]={data:[]}),u[n].data.push(r)},saveToolState:function(){return u},restoreToolState:function(e){u=e},toolState:u}}var u=[];t.newProxyStackSpecificToolStateManager=l,t.addProxyStackStateManager=function(e,t,a){var n=(0,o.getElementToolStateManager)(e);n||(n=r.globalImageIdSpecificToolStateManager);var i=["stack","stackPrefetch","playClip","volume","slab","referenceLines","crosshairs","stackRenderer"];t&&(i=i.concat(t));var d=l(i,n,a);u.push(d),(0,o.setElementToolStateManager)(e,d)}},function(e,t,a){"use strict";function n(){var e={};return{get:function(t,a){if(!1!==e.hasOwnProperty(t)){var n=e[t];if(!1!==n.hasOwnProperty(a))return n[a]}},add:function(t,a,n){!1===e.hasOwnProperty(t)&&(e[t]={});var r=e[t];!1===r.hasOwnProperty(a)&&(r[a]={data:[]}),r[a].data.push(n)},remove:function(t,a,n){if(!1!==e.hasOwnProperty(t)){var r=e[t];if(!1!==r.hasOwnProperty(a)){for(var o=r[a],i=-1,l=0;l<o.data.length;l++)o.data[l]===n&&(i=l);-1!==i&&o.data.splice(i,1)}}}}}Object.defineProperty(t,"__esModule",{value:!0});var r=n();t.newFrameOfReferenceSpecificToolStateManager=n,t.globalFrameOfReferenceSpecificToolStateManager=r},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(a(0)),r=a(19),o=a(2);var i={save:function(e){var t={imageIdToolState:r.globalImageIdSpecificToolStateManager.saveToolState(),elementToolState:{},elementViewport:{}};return e.forEach(function(e){var a=(0,o.getElementToolStateManager)(e);a!==r.globalImageIdSpecificToolStateManager&&(t.elementToolState[e.id]=a.saveToolState(),t.elementViewport[e.id]=n.default.cornerstone.getViewport(e))}),t},restore:function(e){if(e.hasOwnProperty("imageIdToolState")&&e.hasOwnProperty("elementToolState")&&e.hasOwnProperty("elementViewport")){var t=n.default.cornerstone;return r.globalImageIdSpecificToolStateManager.restoreToolState(e.imageIdToolState),Object.keys(e.elementViewport).forEach(function(a){var n=document.getElementById(a);if(n&&e.elementToolState.hasOwnProperty(a)){var i=(0,o.getElementToolStateManager)(n);if(i!==r.globalImageIdSpecificToolStateManager){i.restoreToolState(e.elementToolState[a]);var l=e.elementViewport[a];t.setViewport(n,l),t.updateImage(n)}}}),e}}};t.default=i},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(a(35));function r(e){return e&&e.__esModule?e:{default:e}}var o={UP:38,DOWN:40};var i=(0,r(a(54)).default)(function(e){var t=e.detail,a=t.keyCode;if(a===o.UP||a===o.DOWN){var r=1;a===o.DOWN&&(r=-1),(0,n.default)(t.element,r)}});t.default=i},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stackScrollMultiTouch=t.stackScrollTouchDrag=t.stackScrollWheel=t.stackScroll=void 0;var n=f(a(1)),r=f(a(18)),o=f(a(44)),i=f(a(16)),l=f(a(29)),u=f(a(6)),d=f(a(35)),c=a(2),s=a(4);function f(e){return e&&e.__esModule?e:{default:e}}var v="stackScroll";function m(e){var t=e.detail.element;t.removeEventListener(n.default.MOUSE_DRAG,g),t.removeEventListener(n.default.MOUSE_UP,m),t.removeEventListener(n.default.MOUSE_CLICK,m)}function g(e){var t=e.detail,a=t.element,n=(0,c.getToolState)(a,"stack");if(n&&n.data&&n.data.length){var r=n.data[0],o=p.getConfiguration(),i=!0;o&&void 0!==o.allowSkipping&&(i=o.allowSkipping);var l=Math.max(2,a.offsetHeight/Math.max(r.imageIds.length,8));o&&o.stackScrollSpeed&&(l=o.stackScrollSpeed);var u=(0,s.getToolOptions)(v,a),f=u.deltaY||0;if(f+=t.deltaPoints.page.y,Math.abs(f)>=l){var m=Math.round(f/l);(0,d.default)(a,m,!1,i),u.deltaY=f%l}else u.deltaY=f;(0,s.setToolOptions)(v,a,u),e.preventDefault(),e.stopPropagation()}}var p=(0,i.default)(function(e){var t=e.detail,a=t.element,r=(0,s.getToolOptions)(v,a);if((0,u.default)(t.which,r.mouseButtonMask))return r.deltaY=0,(0,s.setToolOptions)(v,a,r),a.addEventListener(n.default.MOUSE_DRAG,g),a.addEventListener(n.default.MOUSE_UP,m),a.addEventListener(n.default.MOUSE_CLICK,m),e.stopImmediatePropagation(),!1},v),h=(0,l.default)(function(e){var t=e.detail,a=-t.direction,n=p.getConfiguration(),r=!1,o=!0;n&&(r=void 0!==n.loop&&n.loop,o=void 0===n.allowSkipping||n.allowSkipping),(0,d.default)(t.element,a,r,o)}),E={eventData:{deltaY:0}},T=(0,r.default)(g,"stackScrollTouchDrag",E);var y=(0,o.default)(function(e){var t=e.detail,a=y.getConfiguration();a&&a.testPointers(t)&&g(e)},E);y.setConfiguration({testPointers:function(e){return e.numPointers>=3}}),t.stackScroll=p,t.stackScrollWheel=h,t.stackScrollTouchDrag=T,t.stackScrollMultiTouch=y},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(a(1)),r=d(a(0)),o=d(a(34)),i=d(a(13)),l=a(2),u=a(26);function d(e){return e&&e.__esModule?e:{default:e}}var c="stackPrefetch",s="prefetch",f={maxImagesToPrefetch:1/0},v=void 0,m=10;var g=function(e){return Math.max.apply(null,e)},p=function(e){return Math.min.apply(null,e)};function h(e){var t=(0,l.getToolState)(e,"stack");if(t&&t.data&&t.data.length){var a=t.data[0],n=(0,l.getToolState)(e,c);if(n){var u=n.data[0]||{};if(u.indicesToRequest&&u.indicesToRequest.length||(u.enabled=!1),!1!==u.enabled)if(n.data[0].indicesToRequest.sort(function(e,t){return e-t}),u.indicesToRequest.slice().forEach(function(e){var t=a.imageIds[e];t&&(r.default.cornerstone.imageCache.getImageLoadObject(t)&&_(e))}),u.indicesToRequest.length){o.default.clearRequestStack(s);for(var d=function(e,t){var a=[],n=[];return e.forEach(function(e){e<t?a.push(e):e>t&&n.push(e)}),{low:e.indexOf(g(a)),high:e.indexOf(p(n))}}(u.indicesToRequest,a.currentImageIdIndex),v=void 0,m=void 0,h=i.default.getErrorLoadingHandler(),E=d.low,T=d.high;E>=0||T<u.indicesToRequest.length;){var y=a.currentImageIdIndex,M=y-u.indicesToRequest[E]>f.maxImagesToPrefetch,S=u.indicesToRequest[T]-y>f.maxImagesToPrefetch,b=!M&&E>=0,O=!S&&T<u.indicesToRequest.length;if(!O&&!b)break;b&&(m=u.indicesToRequest[E--],v=a.imageIds[m],o.default.addRequest(e,v,s,!1,P,x)),O&&(m=u.indicesToRequest[T++],v=a.imageIds[m],o.default.addRequest(e,v,s,!1,P,x))}o.default.startGrabbing()}}}function _(e){var t=u.indicesToRequest.indexOf(e);t>-1&&u.indicesToRequest.splice(t,1)}function P(e){_(a.imageIds.indexOf(e.imageId))}function x(t){console.log("prefetch errored: "+t),h&&h(e,v,t,"stackPrefetch")}}function E(e){return function(t){var a=t.detail,n=void 0;try{n=(0,l.getToolState)(e,"stack")}catch(e){return}if(n&&n.data&&n.data.length){var r=n.data[0].imageIds.indexOf(a.imageId);if(!(r<0)){var o=(0,l.getToolState)(e,c);o&&o.data&&o.data.length&&o.data[0].indicesToRequest.push(r)}}}}function T(e){clearTimeout(v),v=setTimeout(function(){var t=e.target;try{h(t)}catch(e){return}},m)}var y={enable:function(e){(0,l.getToolState)(e,c).data=[];var t=(0,l.getToolState)(e,"stack");if(t&&t.data&&t.data.length){var a=t.data[0];if(!0!==a.preventCache){var o={indicesToRequest:function(e,t){e=Math.round(e)||0;var a=[],n=(t=Math.round(t)||0)-e+1;if(n<=0)return a;for(;n--;)a[n]=t--;return a}(0,a.imageIds.length-1),enabled:!0,direction:1},i=o.indicesToRequest.indexOf(a.currentImageIdIndex);o.indicesToRequest.splice(i,1),(0,l.addToolState)(e,c,o),h(e),e.removeEventListener(n.default.NEW_IMAGE,T),e.addEventListener(n.default.NEW_IMAGE,T);var u=E(e);r.default.cornerstone.events.removeEventListener(n.default.IMAGE_CACHE_PROMISE_REMOVED,u),r.default.cornerstone.events.addEventListener(n.default.IMAGE_CACHE_PROMISE_REMOVED,u)}else console.warn("A stack that should not be cached was given the stackPrefetch")}},disable:function(e){clearTimeout(v),e.removeEventListener(n.default.NEW_IMAGE,T);var t=E(e);r.default.cornerstone.events.removeEventListener(n.default.IMAGE_CACHE_PROMISE_REMOVED,t);var a=(0,l.getToolState)(e,c);a&&a.data.length&&(a.data[0].enabled=!1,o.default.clearRequestStack(s))},getConfiguration:function(){return f},setConfiguration:function(e){f=e,e.maxSimultaneousRequests&&(0,u.setMaxSimultaneousRequests)(e.maxSimultaneousRequests)}};t.default=y},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(a(25)),r=a(2),o=a(3);var i=6;var l=(0,n.default)(function(e){var t=e.detail,a=t.element,n=t.enabledElement.canvas.width,u=t.enabledElement.canvas.height;if(!n||!u)return!1;var d=(0,o.getNewContext)(t.enabledElement.canvas);(0,o.draw)(d,function(e){var t=l.getConfiguration(),d=void 0;d="horizontal"===t.orientation?{left:0,top:u-i,width:n,height:i}:{left:0,top:0,width:i,height:u},(0,o.fillBox)(e,d,t.backgroundColor);var c=(0,r.getToolState)(a,"stack");if(c&&c.data&&c.data.length){var s=c.data[0].imageIds,f=c.data[0].currentImageIdIndex,v=n/s.length,m=u/s.length,g=v*f,p=m*f;d="horizontal"===t.orientation?{left:g,top:u-i,width:v,height:i}:{left:0,top:p,width:i,height:m},(0,o.fillBox)(e,d,t.fillColor)}})});l.setConfiguration({backgroundColor:"rgb(19, 63, 141)",fillColor:"white",orientation:"horizontal"}),t.default=l},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(a(96));var r={};r.FusionRenderer=n.default,t.default=r},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=function(e){return e&&e.__esModule?e:{default:e}}(a(0)),o=a(2);var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.currentImageIdIndex=0,this.layerIds=[],this.findImageFn=void 0}return n(e,[{key:"render",value:function(e,t){var a=this;if(!Number.isInteger(this.currentImageIdIndex))throw new Error("FusionRenderer: render - Image ID Index is not an integer");if(!this.findImageFn)throw new Error("No findImage function has been defined");t||(t=(0,o.getToolState)(e,"stack").data);var n=r.default.cornerstone,i=t[0],l=i.imageIds[this.currentImageIdIndex],u=t.slice(1,t.length);n.loadAndCacheImage(l).then(function(t){var r=a.layerIds[0];r?n.setLayerImage(e,t,r):(r=n.addLayer(e,t,i.options),a.layerIds.push(r)),n.displayImage(e,t),u.forEach(function(t,o){var i=a.findImageFn(t.imageIds,l),u=o+1,d=a.layerIds[u];d||(d=n.addLayer(e,void 0,t.options),a.layerIds.push(d)),i?n.loadAndCacheImage(i).then(function(t){n.setLayerImage(e,t,d),n.updateImage(e)}):(n.setLayerImage(e,void 0,d),n.setActiveLayer(e,r),n.updateImage(e))})})}}]),e}();t.default=i},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stopClip=t.playClip=void 0;var n=u(a(1)),r=u(a(0)),o=u(a(13)),i=a(2),l=u(a(5));function u(e){return e&&e.__esModule?e:{default:e}}var d="playClip";function c(e){var t=e.intervalId;void 0!==t&&(e.intervalId=void 0,e.usingFrameTimeVector?clearTimeout(t):clearInterval(t))}t.playClip=function(e,t){var a=void 0,u=void 0;if(void 0===e)throw new Error("playClip: element must not be undefined");var s=(0,i.getToolState)(e,"stack");if(s&&s.data&&s.data.length){var f=r.default.cornerstone,v=void 0;if(s.data.length>1){var m=(0,i.getToolState)(e,"stackRenderer");m&&m.data&&m.data.length&&(v=m.data[0])}var g=s.data[0],p=(0,i.getToolState)(e,d);p&&p.data&&p.data.length?c(a=p.data[0]):(a={intervalId:void 0,framesPerSecond:30,lastFrameTimeStamp:void 0,frameRate:0,frameTimeVector:void 0,ignoreFrameTimeVector:!1,usingFrameTimeVector:!1,speed:1,reverse:!1,loop:!0},(0,i.addToolState)(e,d,a)),(t<0||t>0)&&(a.framesPerSecond=Number(t),a.reverse=a.framesPerSecond<0,a.ignoreFrameTimeVector=!0),!0!==a.ignoreFrameTimeVector&&a.frameTimeVector&&a.frameTimeVector.length===g.imageIds.length&&(u=function(e,t){var a=void 0,n=void 0,r=void 0,o=0,i=e.length,l=[];for(l.isTimeVarying=!1,("number"!=typeof t||t<=0)&&(t=1),a=1;a<i;a++)r=Number(e[a])/t|0,l.push(r),1===a?n=r:r!==n&&(l.isTimeVarying=!0),o+=r;return l.length>0&&(r=l.isTimeVarying?o/l.length|0:l[0],l.push(r)),l}(a.frameTimeVector,a.speed));var h=function(){var t=void 0,r=void 0,i=void 0,u=g.currentImageIdIndex,d=g.imageIds.length;if(a.reverse?u--:u++,!a.loop&&(u<0||u>=d))return c(a),void function(e){var t={element:e};(0,l.default)(e,n.default.CLIP_STOPPED,t)}(e);u>=d&&(u=0),u<0&&(u=d-1),u!==g.currentImageIdIndex&&(t=o.default.getStartLoadHandler(),r=o.default.getEndLoadHandler(),i=o.default.getErrorLoadingHandler(),t&&t(e),(!0===g.preventCache?f.loadImage(g.imageIds[u]):f.loadAndCacheImage(g.imageIds[u])).then(function(t){try{g.currentImageIdIndex=u,v?(v.currentImageIdIndex=u,v.render(e,s.data)):f.displayImage(e,t),r&&r(e,t)}catch(e){return}},function(t){var a=g.imageIds[u];i&&i(e,a,t)}))};u&&u.length>0&&u.isTimeVarying?(a.usingFrameTimeVector=!0,a.intervalId=setTimeout(function e(){a.intervalId=setTimeout(e,u[g.currentImageIdIndex]),h()},0)):(a.usingFrameTimeVector=!1,a.intervalId=setInterval(h,1e3/Math.abs(a.framesPerSecond)))}},t.stopClip=function(e){var t=(0,i.getToolState)(e,d);t&&t.data&&t.data.length&&c(t.data[0])}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(a(1)),r=i(a(0)),o=i(a(5));function i(e){return e&&e.__esModule?e:{default:e}}var l=void 0,u=void 0;function d(e){var t=r.default.cornerstone,a=e.currentTarget,i=t.getEnabledElement(a);if(i.image){var d={event:window.event||e,element:a,viewport:t.getViewport(a),image:i.image,currentPoints:{page:{x:l,y:u},image:t.pageToPixel(a,l,u)},keyCode:e.keyCode,which:e.which};d.currentPoints.canvas=t.pixelToCanvas(a,d.currentPoints.image);var c={keydown:n.default.KEY_DOWN,keypress:n.default.KEY_PRESS,keyup:n.default.KEY_UP};(0,o.default)(a,c[e.type],d)}}function c(e){l=e.pageX,u=e.pageY}var s=["keydown","keypress","keyup"];var f={enable:function(e){s.forEach(function(t){e.removeEventListener(t,d),e.addEventListener(t,d)}),e.removeEventListener("mousemove",c),e.addEventListener("mousemove",c)},disable:function(e){s.forEach(function(t){e.removeEventListener(t,d)}),e.removeEventListener("mousemove",c)}};t.default=f},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(a(1)),r=l(a(0)),o=l(a(39)),i=l(a(5));function l(e){return e&&e.__esModule?e:{default:e}}var u=!0,d=void 0,c=200;function s(e){return"number"!=typeof e.buttons?e.which:0===e.buttons?0:e.buttons%2==1?1:e.buttons%4==2?3:e.buttons%8==4?2:0}function f(){u=!1}function v(e){var t=r.default.cornerstone,a=e.currentTarget,l=t.getEnabledElement(a);if(l.image){var u=n.default.MOUSE_DOUBLE_CLICK,d={page:r.default.cornerstoneMath.point.pageToPoint(e),image:t.pageToPixel(a,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};d.canvas=t.pixelToCanvas(a,d.image);var c=(0,o.default)(d),s={event:e,which:e.which,viewport:t.getViewport(a),image:l.image,element:a,startPoints:d,lastPoints:c,currentPoints:d,deltaPoints:{x:0,y:0},type:u};(0,i.default)(a,u,s)}}function m(e){var t=r.default.cornerstone,a=e.currentTarget,l=t.getEnabledElement(a);if(l.image){d=setTimeout(f,c);var v=n.default.MOUSE_DOWN;a.removeEventListener("mousemove",g);var m={page:r.default.cornerstoneMath.point.pageToPoint(e),image:t.pageToPixel(a,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};m.canvas=t.pixelToCanvas(a,m.image);var p=(0,o.default)(m),h={event:e,which:s(e),viewport:t.getViewport(a),image:l.image,element:a,startPoints:m,lastPoints:p,currentPoints:m,deltaPoints:{x:0,y:0},type:v};(0,i.default)(h.element,v,h)&&(h.type=n.default.MOUSE_DOWN_ACTIVATE,(0,i.default)(h.element,n.default.MOUSE_DOWN_ACTIVATE,h));var E=s(e);document.addEventListener("mousemove",T),document.addEventListener("mouseup",function e(o){clearTimeout(d);var c=n.default.MOUSE_UP;u&&(c=n.default.MOUSE_CLICK);var s={page:r.default.cornerstoneMath.point.pageToPoint(o),image:t.pageToPixel(a,o.pageX,o.pageY),client:{x:o.clientX,y:o.clientY}};s.canvas=t.pixelToCanvas(a,s.image);var f={page:r.default.cornerstoneMath.point.subtract(s.page,p.page),image:r.default.cornerstoneMath.point.subtract(s.image,p.image),client:r.default.cornerstoneMath.point.subtract(s.client,p.client),canvas:r.default.cornerstoneMath.point.subtract(s.canvas,p.canvas)},v={event:o,which:E,viewport:t.getViewport(a),image:l.image,element:a,startPoints:m,lastPoints:p,currentPoints:s,deltaPoints:f,type:c};(0,i.default)(v.element,c,v),document.removeEventListener("mousemove",T),document.removeEventListener("mouseup",e),a.addEventListener("mousemove",g),u=!0})}function T(e){var u=n.default.MOUSE_DRAG,d={page:r.default.cornerstoneMath.point.pageToPoint(e),image:t.pageToPixel(a,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};d.canvas=t.pixelToCanvas(a,d.image);var c={page:r.default.cornerstoneMath.point.subtract(d.page,p.page),image:r.default.cornerstoneMath.point.subtract(d.image,p.image),client:r.default.cornerstoneMath.point.subtract(d.client,p.client),canvas:r.default.cornerstoneMath.point.subtract(d.canvas,p.canvas)},s={which:E,viewport:t.getViewport(a),image:l.image,element:a,startPoints:m,lastPoints:p,currentPoints:d,deltaPoints:c,type:u,ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey};(0,i.default)(s.element,u,s),p=(0,o.default)(d)}}function g(e){var t=r.default.cornerstone,a=e.currentTarget,l=t.getEnabledElement(a);if(l.image){var u=n.default.MOUSE_MOVE,d={page:r.default.cornerstoneMath.point.pageToPoint(e),image:t.pageToPixel(a,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};d.canvas=t.pixelToCanvas(a,d.image);var c=(0,o.default)(d),s={page:r.default.cornerstoneMath.point.pageToPoint(e),image:t.pageToPixel(a,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};s.canvas=t.pixelToCanvas(a,s.image);var f={page:r.default.cornerstoneMath.point.subtract(s.page,c.page),image:r.default.cornerstoneMath.point.subtract(s.image,c.image),client:r.default.cornerstoneMath.point.subtract(s.client,c.client),canvas:r.default.cornerstoneMath.point.subtract(s.canvas,c.canvas)},v={viewport:t.getViewport(a),image:l.image,element:a,startPoints:d,lastPoints:c,currentPoints:s,deltaPoints:f,type:u};(0,i.default)(a,u,v),c=(0,o.default)(s)}}function p(e){e.removeEventListener("mousedown",m),e.removeEventListener("mousemove",g),e.removeEventListener("dblclick",v)}var h={enable:function(e){p(e),e.addEventListener("mousedown",m),e.addEventListener("mousemove",g),e.addEventListener("dblclick",v)},disable:p};t.default=h},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(a(1)),r=i(a(0)),o=i(a(5));function i(e){return e&&e.__esModule?e:{default:e}}function l(e){var t=r.default.cornerstone,a=e.currentTarget,i=t.getEnabledElement(a);if(i.image&&!("mousewheel"===e.type&&0===e.wheelDeltaY||"DOMMouseScroll"===e.type&&1===e.axis)){e.preventDefault();var l=void 0,u=void 0;void 0!==e.pageX&&void 0!==e.pageY?(l=e.pageX,u=e.pageY):(l=e.x,u=e.y);var d=t.pageToPixel(a,l,u),c=((e=window.event&&window.event.wheelDelta?window.event:e).wheelDelta?e.wheelDelta:e.deltaY?-e.deltaY:e.detail?-e.detail:e.wheelDelta)<0?-1:1,s={element:a,viewport:t.getViewport(a),image:i.image,direction:c,pageX:l,pageY:u,imageX:d.x,imageY:d.y};(0,o.default)(a,n.default.MOUSE_WHEEL,s)}}var u=["mousewheel","DOMMouseScroll"];function d(e){u.forEach(function(t){e.removeEventListener(t,l)})}var c={enable:function(e){d(e),u.forEach(function(t){e.addEventListener(t,l)})},disable:d};t.default=c},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(a(1)),r=d(a(0)),o=d(a(39)),i=d(a(57)),l=d(a(5)),u=a(4);function d(e){return e&&e.__esModule?e:{default:e}}var c=void 0,s=void 0,f=void 0,v=void 0,m=void 0,g=void 0,p=void 0,h=void 0,E=1,T=0,y=!1,M=!1,S=void 0,b=700,O=5,_="touchInput";function P(e){var t=r.default.cornerstone,a=e.currentTarget||e.srcEvent.currentTarget,i=t.getEnabledElement(a);if(i.image){var u=void 0,d=void 0,_=void 0,P=void 0;switch(e.preventDefault(),(e.pointers&&e.pointers.length>1||e.touches&&e.touches.length>1)&&(M=!1,clearTimeout(p)),e.type){case"tap":M=!1,clearTimeout(p),(s={page:r.default.cornerstoneMath.point.pageToPoint(e.pointers[0]),image:t.pageToPixel(a,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}}).canvas=t.pixelToCanvas(a,s.image),u=n.default.TAP,m={event:e,viewport:t.getViewport(a),image:i.image,element:a,currentPoints:s,type:u,isTouchEvent:!0},(0,l.default)(a,u,m);break;case"doubletap":M=!1,clearTimeout(p),(s={page:r.default.cornerstoneMath.point.pageToPoint(e.pointers[0]),image:t.pageToPixel(a,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}}).canvas=t.pixelToCanvas(a,s.image),u=n.default.DOUBLE_TAP,m={event:e,viewport:t.getViewport(a),image:i.image,element:a,currentPoints:s,type:u,isTouchEvent:!0},(0,l.default)(a,u,m);break;case"pinchstart":M=!1,clearTimeout(p),E=1;break;case"pinchmove":if(M=!1,clearTimeout(p),!0===y){E=e.scale,y=!1;break}d=(e.scale-E)/E,(c={page:e.center,image:t.pageToPixel(a,e.center.x,e.center.y)}).canvas=t.pixelToCanvas(a,c.image),u=n.default.TOUCH_PINCH,m={event:e,startPoints:c,viewport:t.getViewport(a),image:i.image,element:a,direction:e.scale<1?1:-1,scaleChange:d,type:u,isTouchEvent:!0},(0,l.default)(a,u,m),E=e.scale;break;case"touchstart":E=1,clearTimeout(p),clearTimeout(g),g=setTimeout(function(){(c={page:r.default.cornerstoneMath.point.pageToPoint(e.touches[0]),image:t.pageToPixel(a,e.touches[0].pageX,e.touches[0].pageY),client:{x:e.touches[0].clientX,y:e.touches[0].clientY}}).canvas=t.pixelToCanvas(a,c.image),u=n.default.TOUCH_START,e.touches.length>1&&(u=n.default.MULTI_TOUCH_START),m={event:e,viewport:t.getViewport(a),image:i.image,element:a,startPoints:c,currentPoints:c,type:u,isTouchEvent:!0},!0===(0,l.default)(a,u,m)&&(u=n.default.TOUCH_START_ACTIVE,e.touches.length>1&&(u=n.default.MULTI_TOUCH_START_ACTIVE),m.type=u,(0,l.default)(a,u,m)),f=(0,o.default)(c)},50),M=!0,h=0,p=setTimeout(function(){M&&((s={page:r.default.cornerstoneMath.point.pageToPoint(e.touches[0]),image:t.pageToPixel(a,e.touches[0].pageX,e.touches[0].pageY),client:{x:e.touches[0].clientX,y:e.touches[0].clientY}}).canvas=t.pixelToCanvas(a,c.image),u=n.default.TOUCH_PRESS,m={event:e,viewport:t.getViewport(a),image:i.image,element:a,currentPoints:s,type:u,isTouchEvent:!0},(0,l.default)(a,u,m))},b);break;case"touchend":E=1,M=!1,clearTimeout(p),setTimeout(function(){(c={page:r.default.cornerstoneMath.point.pageToPoint(e.changedTouches[0]),image:t.pageToPixel(a,e.changedTouches[0].pageX,e.changedTouches[0].pageY),client:{x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY}}).canvas=t.pixelToCanvas(a,c.image),u=n.default.TOUCH_END,m={event:e,viewport:t.getViewport(a),image:i.image,element:a,startPoints:c,currentPoints:c,type:u,isTouchEvent:!0},(0,l.default)(a,u,m)},50);break;case"panmove":_={x:e.deltaX-S.x,y:e.deltaY-S.y},S={x:e.deltaX,y:e.deltaY},(s={page:{x:f.page.x+_.x,y:f.page.y+_.y},image:t.pageToPixel(a,f.page.x+_.x,f.page.y+_.y),client:{x:f.client.x+_.x,y:f.client.y+_.y}}).canvas=t.pixelToCanvas(a,s.image),v={page:r.default.cornerstoneMath.point.subtract(s.page,f.page),image:r.default.cornerstoneMath.point.subtract(s.image,f.image),client:r.default.cornerstoneMath.point.subtract(s.client,f.client),canvas:r.default.cornerstoneMath.point.subtract(s.canvas,f.canvas)},(h+=Math.sqrt(v.page.x*v.page.x+v.page.y*v.page.y))>O&&(M=!1,clearTimeout(p)),u=n.default.TOUCH_DRAG,e.pointers.length>1&&(u=n.default.MULTI_TOUCH_DRAG),m={viewport:t.getViewport(a),image:i.image,element:a,startPoints:c,lastPoints:f,currentPoints:s,deltaPoints:v,numPointers:e.pointers.length,type:u,isTouchEvent:!0},(0,l.default)(a,u,m),f=(0,o.default)(s);break;case"panstart":S={x:e.deltaX,y:e.deltaY},(s={page:r.default.cornerstoneMath.point.pageToPoint(e.pointers[0]),image:t.pageToPixel(a,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}}).canvas=t.pixelToCanvas(a,s.image),f=(0,o.default)(s);break;case"panend":if(M=!1,clearTimeout(p),!f)return!1;(s={page:r.default.cornerstoneMath.point.pageToPoint(e.pointers[0]),image:t.pageToPixel(a,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}}).canvas=t.pixelToCanvas(a,s.image),v={page:r.default.cornerstoneMath.point.subtract(s.page,f.page),image:r.default.cornerstoneMath.point.subtract(s.image,f.image),client:r.default.cornerstoneMath.point.subtract(s.client,f.client),canvas:r.default.cornerstoneMath.point.subtract(s.canvas,f.canvas)},u=n.default.TOUCH_DRAG_END,m={event:e.srcEvent,viewport:t.getViewport(a),image:i.image,element:a,startPoints:c,lastPoints:f,currentPoints:s,deltaPoints:v,type:u,isTouchEvent:!0},(0,l.default)(a,u,m),2===e.pointers.length-e.changedPointers.length&&(y=!0);break;case"rotatemove":M=!1,clearTimeout(p),P=e.rotation-T,T=e.rotation,u=n.default.TOUCH_ROTATE,m={event:e.srcEvent,viewport:t.getViewport(a),image:i.image,element:a,rotation:P,type:u},(0,l.default)(a,u,m)}return!1}}function x(e){i.default.disable(e);["touchstart","touchend"].forEach(function(t){e.removeEventListener(t,P)});var t=(0,u.getToolOptions)(_,e).hammer;t&&t.off("tap doubletap panstart panmove panend pinchstart pinchmove rotatemove",P)}var C={enable:function(e){x(e);var t=r.default.Hammer,a={inputClass:t.SUPPORT_POINTER_EVENTS?t.PointerEventInput:t.TouchInput},n=new t.Manager(e,a),o={pointers:0,direction:t.DIRECTION_ALL,threshold:0},l=new t.Pan(o),d=new t.Pinch({threshold:0}),c=new t.Rotate({threshold:0});d.recognizeWith(l),d.recognizeWith(c),c.recognizeWith(l);var s=new t.Tap({event:"doubletap",taps:2,interval:1500,threshold:50,posThreshold:50});s.recognizeWith(l),n.add([s,l,c,d]),n.on("tap doubletap panstart panmove panend pinchstart pinchmove rotatemove",P),i.default.enable(e),["touchstart","touchend"].forEach(function(t){e.addEventListener(t,P)});var f=(0,u.getToolOptions)(_,e);f.hammer=n,(0,u.setToolOptions)(_,e,f)},disable:x};t.default=C},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.angleTouch=t.angle=void 0;var n=v(a(0)),r=v(a(10)),o=v(a(12)),i=v(a(9)),l=v(a(36)),u=v(a(7)),d=v(a(11)),c=a(2),s=v(a(31)),f=a(3);function v(e){return e&&e.__esModule?e:{default:e}}var m="angle";function g(e){return{visible:!0,active:!0,color:void 0,handles:{start:{x:e.currentPoints.image.x-20,y:e.currentPoints.image.y+10,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},start2:{x:e.currentPoints.image.x-20,y:e.currentPoints.image.y+10,highlight:!0,active:!1},end2:{x:e.currentPoints.image.x,y:e.currentPoints.image.y+20,highlight:!0,active:!1}}}}function p(e,t,a){return!1!==t.visible&&((0,s.default)(e,t.handles.start,t.handles.end,a)<5||(0,s.default)(e,t.handles.start2,t.handles.end2,a)<5)}function h(e){var t=e.detail,a=(0,c.getToolState)(e.currentTarget,m);if(void 0!==a)for(var r=(0,f.getNewContext)(t.canvasContext.canvas),o=E.getConfiguration(),s=n.default.cornerstone,v=function(e){var n=a.data[e];if(!1===n.visible)return"continue";(0,f.draw)(r,function(e){(0,f.setShadow)(e,o);var a=u.default.getColorIfActive(n);(0,f.drawJoinedLines)(e,t.element,n.handles.end,[n.handles.start,n.handles.end2],{color:a}),(0,d.default)(e,t,n.handles);var r=(Math.ceil(n.handles.start.x)-Math.ceil(n.handles.end.x))*t.image.columnPixelSpacing,c=(Math.ceil(n.handles.start.y)-Math.ceil(n.handles.end.y))*t.image.rowPixelSpacing,v=(Math.ceil(n.handles.start2.x)-Math.ceil(n.handles.end2.x))*t.image.columnPixelSpacing,m=(Math.ceil(n.handles.start2.y)-Math.ceil(n.handles.end2.y))*t.image.rowPixelSpacing,g=Math.acos(Math.abs((r*v+c*m)/(Math.sqrt(r*r+c*c)*Math.sqrt(v*v+m*m))));g*=180/Math.PI;var p=(0,l.default)(g,2).toString()+String.fromCharCode(parseInt("00B0",16)),h=s.pixelToCanvas(t.element,n.handles.start2),E=s.pixelToCanvas(t.element,n.handles.end2),T=(h.x+E.x)/2,y=(h.y+E.y)/2;(0,i.default)(e,p,T,y,a)})},g=0;g<a.data.length;g++)v(g)}var E=(0,r.default)({createNewMeasurement:g,onImageRendered:h,pointNearTool:p,toolType:m}),T=(0,o.default)({createNewMeasurement:g,onImageRendered:h,pointNearTool:p,toolType:m});t.angle=E,t.angleTouch=T},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.arrowAnnotateTouch=t.arrowAnnotate=void 0;var n=b(a(1)),r=b(a(0)),o=b(a(10)),i=b(a(12)),l=b(a(15)),u=b(a(20)),d=b(a(7)),c=b(a(11)),s=b(a(51)),f=b(a(28)),v=b(a(30)),m=b(a(14)),g=b(a(6)),p=b(a(22)),h=b(a(21)),E=a(2),T=a(4),y=b(a(31)),M=a(3),S=a(9);function b(e){return e&&e.__esModule?e:{default:e}}var O="arrowAnnotate";var _={getTextCallback:function(e){e(prompt("Enter your annotation:"))},changeTextCallback:function(e,t,a){a(prompt("Change your annotation:"))},drawHandles:!1,drawHandlesOnHover:!0,arrowFirst:!0};function P(e){return{visible:!0,active:!0,color:void 0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function x(e,t,a){return!1!==t.visible&&(0,y.default)(e,t.handles.start,t.handles.end,a)<25}function C(e){var t=e.detail,a=(0,E.getToolState)(e.currentTarget,O);if(a)for(var n=t.enabledElement,o=r.default.cornerstone,i=(0,M.getNewContext)(t.canvasContext.canvas),f=l.default.getToolWidth(),v=I.getConfiguration(),m=function(e){var r=a.data[e];if(!1===r.visible)return"continue";(0,M.draw)(i,function(e){(0,M.setShadow)(e,v);var a=d.default.getColorIfActive(r),i=o.pixelToCanvas(t.element,r.handles.start),l=o.pixelToCanvas(t.element,r.handles.end);v.arrowFirst?(0,s.default)(e,l,i,a,f):(0,s.default)(e,i,l,a,f);var m={drawHandlesIfActive:v&&v.drawHandlesOnHover};v.drawHandles&&(0,c.default)(e,t,r.handles,a,m);var g=function(e){return e.text}(r);if(g&&""!==g){var E=(0,S.textBoxWidth)(e,g,5),T=u.default.getFontSize()+10,y=Math.max(E,T)/2+5;if(l.x<i.x&&(y=-y),!r.handles.textBox.hasMoved){var b=void 0;b=v.arrowFirst?{x:l.x-E/2+y,y:l.y-T/2}:{x:i.x-E/2-y,y:i.y-T/2};var O=o.internal.getTransform(n);O.invert();var _=O.transformPoint(b.x,b.y);r.handles.textBox.x=_.x,r.handles.textBox.y=_.y}(0,h.default)(e,t.element,r.handles.textBox,g,r.handles,p,a,f,0,!1)}})},g=0;g<a.data.length;g++)m(g);function p(e){var t={x:(e.start.x+e.end.x)/2,y:(e.start.y+e.end.y)/2};return[e.start,t,e.end]}}var I=(0,o.default)({addNewMeasurement:function(e){var t=e.element,a=P(e),o=r.default.cornerstone;function i(e){null===e?(0,E.removeToolState)(t,O,a):a.text=e,a.active=!1,o.updateImage(t),t.addEventListener(n.default.MOUSE_MOVE,I.mouseMoveCallback),t.addEventListener(n.default.MOUSE_DOWN,I.mouseDownCallback),t.addEventListener(n.default.MOUSE_DOWN_ACTIVATE,I.mouseDownActivateCallback),t.addEventListener(n.default.MOUSE_DOUBLE_CLICK,I.mouseDoubleClickCallback)}(0,E.addToolState)(t,O,a),t.removeEventListener(n.default.MOUSE_MOVE,I.mouseMoveCallback),t.removeEventListener(n.default.MOUSE_DOWN,I.mouseDownCallback),t.removeEventListener(n.default.MOUSE_DOWN_ACTIVATE,I.mouseDownActivateCallback),t.removeEventListener(n.default.MOUSE_DOUBLE_CLICK,I.mouseDoubleClickCallback),o.updateImage(t),(0,f.default)(e,O,a,a.handles.end,function(){(0,m.default)(e,a.handles)&&(0,E.removeToolState)(t,O,a);var n=I.getConfiguration();void 0===a.text&&n.getTextCallback(i),o.updateImage(t)})},createNewMeasurement:P,onImageRendered:C,pointNearTool:x,toolType:O,mouseDoubleClickCallback:function(e){var t=e.detail,a=t.element,n=r.default.cornerstone,o=(0,T.getToolOptions)(O,a),i=void 0;if((0,g.default)(t.which,o.mouseButtonMask)){var l=I.getConfiguration(),u=t.currentPoints.canvas,d=(0,E.getToolState)(a,O);if(d)for(var c=0;c<d.data.length;c++)if(i=d.data[c],x(a,i,u)||(0,p.default)(i.handles.textBox,u))return i.active=!0,n.updateImage(a),l.changeTextCallback(i,t,s),e.stopImmediatePropagation(),!1}function s(e,t,r){!0===r?(0,E.removeToolState)(a,O,e):e.text=t,e.active=!1,n.updateImage(a)}}});I.setConfiguration(_);var w=(0,i.default)({addNewMeasurement:function(e){var t=e.element,a=P(e),o=r.default.cornerstone;function i(e){null===e?(0,E.removeToolState)(t,O,a):a.text=e,a.active=!1,o.updateImage(t),t.addEventListener(n.default.TOUCH_PRESS,w.pressCallback),t.addEventListener(n.default.TOUCH_START_ACTIVE,w.touchDownActivateCallback),t.addEventListener(n.default.TAP,w.tapCallback)}(0,E.addToolState)(t,O,a),t.removeEventListener(n.default.TOUCH_PRESS,w.pressCallback),t.removeEventListener(n.default.TOUCH_START_ACTIVE,w.touchDownActivateCallback),t.removeEventListener(n.default.TAP,w.tapCallback),o.updateImage(t),(0,v.default)(e,O,a,a.handles.end,function(){o.updateImage(t),(0,m.default)(e,a.handles)&&(0,E.removeToolState)(t,O,a);var n=I.getConfiguration();void 0===a.text&&n.getTextCallback(i)})},createNewMeasurement:P,onImageRendered:C,pointNearTool:x,toolType:O,pressCallback:function(e){var t=e.detail,a=t.element,o=r.default.cornerstone,i=void 0;function l(e,t,r){console.log("pressCallback doneChangingTextCallback"),!0===r?(0,E.removeToolState)(a,O,e):e.text=t,e.active=!1,o.updateImage(a),a.addEventListener(n.default.TOUCH_START,w.touchStartCallback),a.addEventListener(n.default.TOUCH_START_ACTIVE,w.touchDownActivateCallback),a.addEventListener(n.default.TAP,w.tapCallback)}var u=I.getConfiguration(),d=t.currentPoints.canvas,c=(0,E.getToolState)(a,O);if(c){if(t.handlePressed)return a.removeEventListener(n.default.TOUCH_START,w.touchStartCallback),a.removeEventListener(n.default.TOUCH_START_ACTIVE,w.touchDownActivateCallback),a.removeEventListener(n.default.TAP,w.tapCallback),u.changeTextCallback(t.handlePressed,t,l),e.stopImmediatePropagation(),!1;for(var s=0;s<c.data.length;s++)if(i=c.data[s],x(a,i,d)||(0,p.default)(i.handles.textBox,d))return i.active=!0,o.updateImage(a),a.removeEventListener(n.default.TOUCH_START,w.touchStartCallback),a.removeEventListener(n.default.TOUCH_START_ACTIVE,w.touchDownActivateCallback),a.removeEventListener(n.default.TAP,w.tapCallback),u.changeTextCallback(i,t,l),e.stopImmediatePropagation(),!1;e.preventDefault(),e.stopPropagation()}}});t.arrowAnnotate=I,t.arrowAnnotateTouch=w},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,o,i,l){var u=e.length>0?n.default.cornerstoneMath.point.findClosestPoint(e,t):t,d=[{x:a.left+a.width/2,y:a.top},{x:a.left,y:a.top+a.height/2},{x:a.left+a.width/2,y:a.top+a.height},{x:a.left+a.width,y:a.top+a.height/2}],c=n.default.cornerstoneMath.point.findClosestPoint(d,u),s={color:i,lineWidth:l,lineDash:[2,3]};(0,r.drawLine)(o,void 0,u,c,s,"canvas")};var n=function(e){return e&&e.__esModule?e:{default:e}}(a(0)),r=a(3)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.crosshairsTouch=t.crosshairs=void 0;var n=s(a(1)),r=s(a(0)),o=s(a(13)),i=a(2),l=s(a(6)),u=a(33),d=s(a(17)),c=a(4);function s(e){return e&&e.__esModule?e:{default:e}}var f="crosshairs";function v(e){var t=e.detail;e.stopImmediatePropagation();var a=(0,i.getToolState)(e.currentTarget,f);if(a){var n=r.default.cornerstone,l=e.currentTarget,c=n.getEnabledElement(l).image.imageId,s=n.metaData.get("imagePlaneModule",c);if(s){var v=t.currentPoints.image,m=(0,u.imagePointToPatientPoint)(v,s);a.data[0].synchronizationContext.getSourceElements().forEach(function(e){if(e!==l){var t=Number.MAX_VALUE,a=-1,r=(0,i.getToolState)(e,"stack");if(void 0!==r){var u=r.data[0];if(u.imageIds.forEach(function(e,r){var o=n.metaData.get("imagePlaneModule",e);if(o&&o.imagePositionPatient&&o.rowCosines&&o.columnCosines){var i=(0,d.default)(o.imagePositionPatient),l=(0,d.default)(o.rowCosines),u=(0,d.default)(o.columnCosines).clone().cross(l.clone()),c=Math.abs(u.clone().dot(i)-u.clone().dot(m));c<t&&(t=c,a=r)}}),a!==u.currentImageIdIndex&&-1!==a&&void 0!==u.imageIds[a]){var c=o.default.getStartLoadHandler(),s=o.default.getEndLoadHandler(),f=o.default.getErrorLoadingHandler();c&&c(e);(!0===u.preventCache?n.loadImage(u.imageIds[a]):n.loadAndCacheImage(u.imageIds[a])).then(function(t){var r=n.getViewport(e);u.currentImageIdIndex=a,n.displayImage(e,t,r),s&&s(e,t)},function(t){var n=u.imageIds[a];f&&f(e,n,t)})}}}})}}}function m(e){var t=e.detail.element;t.removeEventListener(n.default.MOUSE_DRAG,p),t.removeEventListener(n.default.MOUSE_UP,m)}function g(e){var t=e.detail,a=t.element,r=(0,c.getToolOptions)(f,a);(0,l.default)(t.which,r.mouseButtonMask)&&(a.addEventListener(n.default.MOUSE_DRAG,p),a.addEventListener(n.default.MOUSE_UP,m),v(e),e.preventDefault(),e.stopPropagation())}function p(e){v(e),e.preventDefault(),e.stopPropagation()}function h(e,t,a){(0,c.setToolOptions)(f,e,{mouseButtonMask:t}),(0,i.clearToolState)(e,f),(0,i.addToolState)(e,f,{synchronizationContext:a}),e.removeEventListener(n.default.MOUSE_DOWN,g),e.addEventListener(n.default.MOUSE_DOWN,g)}function E(e){e.removeEventListener(n.default.MOUSE_DOWN,g)}var T={activate:h,deactivate:E,enable:h,disable:E};function y(e){var t=e.detail.element;t.removeEventListener(n.default.TOUCH_DRAG,S),t.removeEventListener(n.default.TOUCH_DRAG_END,y)}function M(e){var t=e.detail.element;return t.addEventListener(n.default.TOUCH_DRAG,S),t.addEventListener(n.default.TOUCH_DRAG_END,y),v(e),!1}function S(e){v(e),e.preventDefault(),e.stopPropagation()}function b(e,t){(0,i.clearToolState)(e,f),(0,i.addToolState)(e,f,{synchronizationContext:t}),e.removeEventListener(n.default.TOUCH_START,M),e.addEventListener(n.default.TOUCH_START,M)}function O(e){e.removeEventListener(n.default.TOUCH_START,M)}var _={activate:b,deactivate:O,enable:b,disable:O};t.crosshairs=T,t.crosshairsTouch=_},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(a(0));function r(e){return e&&e.__esModule?e:{default:e}}function o(e){n.default.cornerstone.fitToWindow(e.element)}var i=(0,r(a(58)).default)(function(e){var t=e.detail;i.strategy(t),e.preventDefault(),e.stopPropagation()});i.strategies={default:o},i.strategy=o,t.default=i},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dragProbeTouch=t.dragProbe=void 0;var n=p(a(1)),r=p(a(0)),o=p(a(16)),i=p(a(18)),l=p(a(20)),u=p(a(7)),d=a(9),c=p(d),s=p(a(38)),f=p(a(23)),v=p(a(6)),m=a(4),g=a(3);function p(e){return e&&e.__esModule?e:{default:e}}var h="dragProbe",E=void 0;function T(e){var t=r.default.cornerstone,a=t.getEnabledElement(e.element),n=(0,g.getNewContext)(a.canvas),o=u.default.getActiveColor(),i=l.default.getFontSize(),d=b.getConfiguration(),v=Math.round(e.currentPoints.image.x),m=Math.round(e.currentPoints.image.y);v<0||m<0||v>=e.image.columns||m>=e.image.rows||(0,g.draw)(n,function(a){(0,g.setShadow)(a,d);var n=void 0,r=void 0,l=void 0;if(e.image.color)n=(0,s.default)(e.element,v,m,1,1),r=v+", "+m,l="R: "+n[0]+" G: "+n[1]+" B: "+n[2]+" A: "+n[3];else{var u=(n=t.getStoredPixels(e.element,v,m,1,1))[0],p=u*e.image.slope+e.image.intercept,h=(0,f.default)(e.image,u);r=v+", "+m,l="SP: "+u+" MO: "+parseFloat(p.toFixed(3)),h&&(l+=" SUV: "+parseFloat(h.toFixed(3)))}var E={x:e.currentPoints.image.x+3,y:e.currentPoints.image.y-3},T=t.pixelToCanvas(e.element,E);(0,c.default)(a,l,T.x,T.y+i+5,o),(0,c.default)(a,r,T.x,T.y,o)})}function y(e){var t=e.detail,a=t.element;a.removeEventListener(n.default.IMAGE_RENDERED,M),a.removeEventListener(n.default.MOUSE_DRAG,S),a.removeEventListener(n.default.MOUSE_UP,y),a.removeEventListener(n.default.MOUSE_CLICK,y),r.default.cornerstone.updateImage(t.element)}function M(){E&&(b.strategy(E),E=null)}function S(e){var t=e.detail,a=t.element;E=t,r.default.cornerstone.updateImage(a),e.preventDefault(),e.stopPropagation()}var b=(0,o.default)(function(e){var t=e.detail,a=t.element,r=(0,m.getToolOptions)(h,a);(0,v.default)(t.which,r.mouseButtonMask)&&(a.addEventListener(n.default.IMAGE_RENDERED,M),a.addEventListener(n.default.MOUSE_DRAG,S),a.addEventListener(n.default.MOUSE_UP,y),a.addEventListener(n.default.MOUSE_CLICK,y),b.strategy(t),e.preventDefault(),e.stopPropagation())},h);b.strategies={default:T,minimal:function(e){var t=r.default.cornerstone,a=e.element,n=t.getEnabledElement(a),o=n.image,i=(0,g.getNewContext)(n.canvas),v=u.default.getActiveColor(),m=b.getConfiguration(),p=void 0;(p=!0===e.isTouchEvent?t.pageToPixel(a,e.currentPoints.page.x,e.currentPoints.page.y-4*l.default.getFontSize()):t.pageToPixel(a,e.currentPoints.page.x,e.currentPoints.page.y-l.default.getFontSize()/2)).x<0||p.y<0||p.x>=o.columns||p.y>=o.rows||(0,g.draw)(i,function(n){(0,g.setShadow)(n,m);var r=t.metaData.get("generalSeriesModule",o.imageId),i=void 0;r&&(i=r.modality);var u=void 0,h="";if(o.color)h="R: "+(u=(0,s.default)(a,p.x,p.y,1,1))[0]+" G: "+u[1]+" B: "+u[2];else{var E=(u=t.getStoredPixels(a,p.x,p.y,1,1))[0],T=E*e.image.slope+e.image.intercept,y=parseFloat(T.toFixed(2));if("CT"===i)h+="HU: "+y;else if("PT"===i){h+=y;var M=(0,f.default)(e.image,E);M&&(h+=" SUV: "+parseFloat(M.toFixed(2)))}else h+=y}var S=t.pixelToCanvas(a,p),b=void 0,O=(0,d.textBoxWidth)(n,h,5);b=!0===e.isTouchEvent?{x:-O/2,y:-l.default.getFontSize()-10-12}:{x:12,y:-(l.default.getFontSize()+10)/2},(0,g.drawCircle)(n,a,S,6,{color:v},"canvas"),(0,c.default)(n,h,S.x+b.x,S.y+b.y,v)})}},b.strategy=T;var O={fireOnTouchStart:!0,touchStartCallback:function(e){e.detail.element.addEventListener(n.default.IMAGE_RENDERED,M)},touchEndCallback:function(e){var t=e.detail.element;t.removeEventListener(n.default.IMAGE_RENDERED,M),r.default.cornerstone.updateImage(t)}},_=(0,i.default)(S,h,O);t.dragProbe=b,t.dragProbeTouch=_},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ellipticalRoiTouch=t.ellipticalRoi=void 0;var n=g(a(0)),r=g(a(10)),o=g(a(12)),i=g(a(15)),l=g(a(7)),u=g(a(11)),d=g(a(37)),c=g(a(52)),s=g(a(23)),f=g(a(21)),v=a(2),m=a(3);function g(e){return e&&e.__esModule?e:{default:e}}var p="ellipticalRoi";function h(e){return{visible:!0,active:!0,invalidated:!0,color:void 0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function E(e,t,a,r){if(!1===t.visible)return!1;var o=n.default.cornerstone,i=o.pixelToCanvas(e,t.handles.start),l=o.pixelToCanvas(e,t.handles.end),u={left:Math.min(i.x,l.x)+r/2,top:Math.min(i.y,l.y)+r/2,width:Math.abs(i.x-l.x)-r,height:Math.abs(i.y-l.y)-r},c={left:Math.min(i.x,l.x)-r/2,top:Math.min(i.y,l.y)-r/2,width:Math.abs(i.x-l.x)+r,height:Math.abs(i.y-l.y)+r},s=(0,d.default)(u,a);return!(!(0,d.default)(c,a)||s)}function T(e){var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}function y(e){var t=e.detail,a=(0,v.getToolState)(e.currentTarget,p);if(a){var r=n.default.cornerstone,o=t.image,d=t.element,g=i.default.getToolWidth(),h=M.getConfiguration(),E=r.metaData.get("generalSeriesModule",o.imageId),y=r.metaData.get("imagePlaneModule",o.imageId),S=void 0,b=void 0,O=void 0;y?(b=y.rowPixelSpacing||y.rowImagePixelSpacing,O=y.columnPixelSpacing||y.colImagePixelSpacing):(b=o.rowPixelSpacing,O=o.columnPixelSpacing),E&&(S=E.modality);for(var _=(0,m.getNewContext)(t.canvasContext.canvas),P=function(e){var n=a.data[e];if(!1===n.visible)return"continue";(0,m.draw)(_,function(e){(0,m.setShadow)(e,h);var a=l.default.getColorIfActive(n);if((0,m.drawEllipse)(e,d,n.handles.start,n.handles.end,{color:a}),h&&h.drawHandlesOnHover)if(!0===n.active)(0,u.default)(e,t,n.handles,a);else{(0,u.default)(e,t,n.handles,a,{drawHandlesIfActive:!0})}else(0,u.default)(e,t,n.handles,a);var i=void 0,v=void 0,p=void 0;if(!1===n.invalidated)v=n.meanStdDev,p=n.meanStdDevSUV,i=n.area;else{var E={left:Math.round(Math.min(n.handles.start.x,n.handles.end.x)),top:Math.round(Math.min(n.handles.start.y,n.handles.end.y)),width:Math.round(Math.abs(n.handles.start.x-n.handles.end.x)),height:Math.round(Math.abs(n.handles.start.y-n.handles.end.y))};if(!o.color){var y=r.getPixels(d,E.left,E.top,E.width,E.height);v=(0,c.default)(y,E),"PT"===S&&(p={mean:(0,s.default)(o,(v.mean-o.intercept)/o.slope),stdDev:(0,s.default)(o,(v.stdDev-o.intercept)/o.slope)}),v&&!isNaN(v.mean)&&(n.meanStdDev=v,n.meanStdDevSUV=p)}i=Math.PI*(E.width*(O||1)/2)*(E.height*(b||1)/2),isNaN(i)||(n.area=i),n.invalidated=!1}n.handles.textBox.hasMoved||(n.handles.textBox.x=Math.max(n.handles.start.x,n.handles.end.x),n.handles.textBox.y=(n.handles.start.y+n.handles.end.y)/2);var M=function(e){var t=e.meanStdDev,a=e.meanStdDevSUV,n=e.area,r=[];if(t&&void 0!==t.mean){var o="";"CT"===S&&(o=" HU");var i="Mean: "+T(t.mean.toFixed(2))+o,l="StdDev: "+T(t.stdDev.toFixed(2))+o;if(a&&void 0!==a.mean){i+=" SUV: "+T(a.mean.toFixed(2)),l+=" SUV: "+T(a.stdDev.toFixed(2))}r.push(i),r.push(l)}if(n){var u=" mm"+String.fromCharCode(178);b&&O||(u=" pixels"+String.fromCharCode(178));var d="Area: "+T(n.toFixed(2))+u;r.push(d)}return[]}(n);(0,f.default)(e,d,n.handles.textBox,M,n.handles,C,a,g,0,!0)})},x=0;x<a.data.length;x++)P(x)}function C(e){var t=Math.min(e.start.x,e.end.x),a=Math.min(e.start.y,e.end.y),n=Math.abs(e.start.x-e.end.x),r=Math.abs(e.start.y-e.end.y);return[{x:t+n/2,y:a},{x:t,y:a+r/2},{x:t+n/2,y:a+r},{x:t+n,y:a+r/2}]}}var M=(0,r.default)({createNewMeasurement:h,onImageRendered:y,pointNearTool:function(e,t,a){return E(e,t,a,15)},toolType:p}),S=(0,o.default)({createNewMeasurement:h,onImageRendered:y,pointNearTool:function(e,t,a){return E(e,t,a,25)},toolType:p});t.ellipticalRoi=M,t.ellipticalRoiTouch=S},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.eraserTouch=t.eraser=void 0;var n=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var a=[],n=!0,r=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(n=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);n=!0);}catch(e){r=!0,o=e}finally{try{!n&&l.return&&l.return()}finally{if(r)throw o}}return a}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a(32)),o=u(a(0)),i=u(a(1)),l=a(4);function u(e){return e&&e.__esModule?e:{default:e}}var d={supportedTools:{}};function c(e){var t=e.detail.currentPoints.canvas,a=e.detail.element,i=!1,l=!1;Object.entries(d.supportedTools).forEach(function(e){var o=n(e,2),u=o[0],d=o[1],c=r.getToolState(a,u);c&&c.data.forEach(function(e){!i&&d.pointNearTool(a,e,t)&&(r.removeToolState(a,u,e),i=!0,l=!0)})}),l&&o.default.cornerstone.updateImage(a)}function s(e){var t=e.detail.currentPoints.canvas,a=e.detail.element,i=!1,l=!1;Object.entries(d.supportedTools).forEach(function(e){var o=n(e,2),u=o[0],d=o[1],c=r.getToolState(a,u);c&&c.data.forEach(function(e){e.active&&(e.active=!1,i=!0),!l&&d.pointNearTool(a,e,t)&&(e.active=!0,i=!0,l=!0)})}),i&&o.default.cornerstone.updateImage(a)}var f={activate:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};a.mouseButtonMask=t,(0,l.setToolOptions)("eraser",e,a),e.removeEventListener(i.default.MOUSE_DOWN_ACTIVATE,c),e.removeEventListener(i.default.MOUSE_MOVE,s),e.addEventListener(i.default.MOUSE_DOWN_ACTIVATE,c),e.addEventListener(i.default.MOUSE_MOVE,s),d.supportedTools={},Object.keys(r).forEach(function(e){var t=r[e];"function"==typeof t.pointNearTool&&(d.supportedTools[e]=t)})},disable:function(e){e.removeEventListener(i.default.MOUSE_DOWN_ACTIVATE,c),e.removeEventListener(i.default.MOUSE_MOVE,s)},enable:function(e){e.removeEventListener(i.default.MOUSE_DOWN_ACTIVATE,c),e.removeEventListener(i.default.MOUSE_MOVE,s)},deactivate:function(e){e.removeEventListener(i.default.MOUSE_DOWN_ACTIVATE,c),e.removeEventListener(i.default.MOUSE_MOVE,s)},getConfiguration:function(){return d},setConfiguration:function(e){d=e}},v=(0,u(a(59)).default)(c,"eraser");t.eraser=f,t.eraserTouch=v},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.highlightTouch=t.highlight=void 0;var n=c(a(0)),r=c(a(60)),o=c(a(12)),i=c(a(7)),l=c(a(11)),u=a(2),d=a(3);function c(e){return e&&e.__esModule?e:{default:e}}var s="highlight";function f(e){var t=(0,u.getToolState)(e.event.currentTarget,s);if(!(t&&t.data&&t.data.length>0))return{visible:!0,active:!0,color:void 0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0}}}}function v(e,t,a){var r=n.default.cornerstone,o=r.pixelToCanvas(e,t.handles.start),i=r.pixelToCanvas(e,t.handles.end),l=Math.min(o.x,i.x),u=Math.min(o.y,i.y),d=Math.abs(o.x-i.x),c=Math.abs(o.y-i.y),s=!1;return a.x>=l&&a.x<=l+d&&a.y>=u&&a.y<=u+c&&(s=!0),s}function m(e,t,a){if(!1===t.visible)return!1;var r=n.default.cornerstone,o=r.pixelToCanvas(e,t.handles.start),i=r.pixelToCanvas(e,t.handles.end),l={left:Math.min(o.x,i.x),top:Math.min(o.y,i.y),width:Math.abs(o.x-i.x),height:Math.abs(o.y-i.y)};return n.default.cornerstoneMath.rect.distanceToPoint(l,a)<5}function g(e){var t=e.detail,a=(0,u.getToolState)(e.currentTarget,s);if(void 0!==a){var n=(0,d.getNewContext)(t.canvasContext.canvas),r=a.data[0];!1!==r.visible&&r&&(0,d.draw)(n,function(e){var a={color:"transparent",fillStyle:"rgba(0,0,0,0.7)"};(0,d.fillOutsideRect)(e,t.element,r.handles.start,r.handles.end,a);var n=i.default.getColorIfActive(r);a={color:n,lineDash:[4]},(0,d.drawRect)(e,t.element,r.handles.start,r.handles.end,a),(0,l.default)(e,t,r.handles,n)})}}var p=(0,r.default)({createNewMeasurement:f,onImageRendered:g,pointNearTool:m,pointInsideRect:v,toolType:s},!0),h=(0,o.default)({createNewMeasurement:f,onImageRendered:g,pointNearTool:m,pointInsideRect:v,toolType:s},!0);t.highlight=p,t.highlightTouch=h},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(a(25)),r=i(a(9)),o=a(3);function i(e){return e&&e.__esModule?e:{default:e}}var l=(0,n.default)(function(e){var t=e.detail,a=t.image.stats,n=(0,o.getNewContext)(t.canvasContext.canvas),i=[];Object.keys(a).forEach(function(e){var t=e+" : "+a[e];i.push(t)}),(0,r.default)(n,i,0,0,"orange"),i.forEach(function(e){console.log(e)})});t.default=l},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lengthTouch=t.length=void 0;var n=v(a(0)),r=v(a(10)),o=v(a(12)),i=v(a(21)),l=v(a(15)),u=v(a(7)),d=v(a(11)),c=a(2),s=v(a(31)),f=a(3);function v(e){return e&&e.__esModule?e:{default:e}}var m="length";function g(e){return{visible:!0,active:!0,color:void 0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function p(e,t,a){return!1!==t.visible&&(0,s.default)(e,t.handles.start,t.handles.end,a)<25}function h(e){var t=e.detail,a=(0,c.getToolState)(e.currentTarget,m);if(a){var r=n.default.cornerstone,o=(0,f.getNewContext)(t.canvasContext.canvas),s=t.image,v=t.element,g=l.default.getToolWidth(),p=E.getConfiguration(),h=r.metaData.get("imagePlaneModule",s.imageId),T=void 0,y=void 0;h?(T=h.rowPixelSpacing||h.rowImagePixelSpacing,y=h.columnPixelSpacing||h.colImagePixelSpacing):(T=s.rowPixelSpacing,y=s.columnPixelSpacing);for(var M=function(e){var n=a.data[e];if(!1===n.visible)return"continue";(0,f.draw)(o,function(e){(0,f.setShadow)(e,p);var a=u.default.getColorIfActive(n);(0,f.drawLine)(e,v,n.handles.start,n.handles.end,{color:a});var r={drawHandlesIfActive:p&&p.drawHandlesOnHover};(0,d.default)(e,t,n.handles,a,r);var o=(n.handles.end.x-n.handles.start.x)*(y||1),l=(n.handles.end.y-n.handles.start.y)*(T||1),c=Math.sqrt(o*o+l*l);if(n.length=c,!n.handles.textBox.hasMoved){var s={x:Math.max(n.handles.start.x,n.handles.end.x)};s.x===n.handles.start.x?s.y=n.handles.start.y:s.y=n.handles.end.y,n.handles.textBox.x=s.x,n.handles.textBox.y=s.y}var m=function(e,t,a){var n=" mm";t&&a||(n=" pixels");return""+e.length.toFixed(2)+n}(n,T,y);(0,i.default)(e,v,n.handles.textBox,m,n.handles,b,a,g,10,!0)})},S=0;S<a.data.length;S++)M(S)}function b(e){var t={x:(e.start.x+e.end.x)/2,y:(e.start.y+e.end.y)/2};return[e.start,t,e.end]}}var E=(0,r.default)({createNewMeasurement:g,onImageRendered:h,pointNearTool:p,toolType:m}),T=(0,o.default)({createNewMeasurement:g,onImageRendered:h,pointNearTool:p,toolType:m});t.length=E,t.lengthTouch=T},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.magnifyTouchDrag=t.magnify=void 0;var n=c(a(1)),r=c(a(0)),o=a(26),i=c(a(6)),l=a(4),u=a(8),d=a(3);function c(e){return e&&e.__esModule?e:{default:e}}var s="magnify",f={magnifySize:300,magnificationLevel:5},v=void 0,m=void 0,g=void 0,p=void 0;function h(e){var t=e.detail,a=t.element;a.removeEventListener(n.default.MOUSE_DRAG,S),a.removeEventListener(n.default.MOUSE_UP,h),a.removeEventListener(n.default.MOUSE_CLICK,h),E(t)}function E(e){e.element.querySelector(".magnifyTool").style.display="none",document.body.style.cursor="default",_()}function T(e){var t=e.detail,a=t.element,o=(0,l.getToolOptions)(s,a);(e.isTouchEvent||(0,i.default)(t.which,o.mouseButtonMask))&&(a.addEventListener(n.default.MOUSE_DRAG,S),a.addEventListener(n.default.TOUCH_DRAG,S),a.addEventListener(n.default.MOUSE_UP,h),a.addEventListener(n.default.TOUCH_END,h),a.addEventListener(n.default.MOUSE_CLICK,h),a.addEventListener(n.default.NEW_IMAGE,y),function(e){_();var t=e.enabledElement;void 0===t&&(t=r.default.cornerstone.getEnabledElement(e.element));var a=x.getConfiguration().magnificationLevel,n=t.canvas,o=t.image;(p=document.createElement("div")).width=n.width*a,p.height=n.height*a,r.default.cornerstone.enable(p);var i=r.default.cornerstone.getEnabledElement(p),l=r.default.cornerstone.getViewport(t.element);(g=i.canvas).width=n.width*a,g.height=n.height*a,i.viewport=Object.assign({},l),l.scale*=a,r.default.cornerstone.displayImage(p,o),r.default.cornerstone.setViewport(p,l)}(t),window.requestAnimationFrame(function(){return b(t)}),e.preventDefault(),e.stopPropagation())}function y(e){var t=e.detail;t.currentPoints=m,b(t)}function M(e){var t=e.detail,a=t.element;a.removeEventListener(n.default.TOUCH_DRAG_END,M),a.removeEventListener(n.default.TOUCH_END,M),a.removeEventListener(n.default.NEW_IMAGE,y),E(t)}function S(e){var t=e.detail,a=t.element;b(t),!0===t.isTouchEvent&&(a.addEventListener(n.default.TOUCH_DRAG_END,M),a.addEventListener(n.default.TOUCH_END,M)),e.preventDefault(),e.stopPropagation()}function b(e){var t=e.element,a=t.querySelector(".magnifyTool");if(a||O(e.element),void 0!==g){var n=x.getConfiguration(),o=n.magnifySize,i=n.magnificationLevel,l=t.querySelector("canvas:not(.magnifyTool)"),c=(0,d.getNewContext)(a),s=o,f=r.default.cornerstone.pixelToCanvas(e.element,e.currentPoints.image);(0,u.clipToBox)(f,l),c.clearRect(0,0,o,o);var m={left:0,top:0,width:o,height:o};(0,d.fillBox)(c,m,"transparent");var p={x:f.x*i-.5*s,y:f.y*i-.5*s};"Safari"===v&&(p.x=Math.max(p.x,0),p.y=Math.max(p.y,0)),p.x=Math.min(p.x,g.width),p.y=Math.min(p.y,g.height),c.drawImage(g,p.x,p.y,s,s,0,0,s,s),a.style.top=f.y-.5*o+"px",a.style.left=f.x-.5*o+"px",e.isTouchEvent&&(a.style.top=f.y-.5*o-120+"px"),a.style.display="block",document.body.style.cursor="none"}}function O(e){if(null===e.querySelector(".magnifyTool")){var t=document.createElement("canvas");t.classList.add("magnifyTool");var a=x.getConfiguration();t.width=a.magnifySize,t.height=a.magnifySize,t.style.position="absolute",t.style.display="none",e.appendChild(t)}}function _(){void 0!==p&&(r.default.cornerstone.disable(p),p=void 0,g=void 0)}function P(e){e.removeEventListener(n.default.MOUSE_DOWN,T),function(e){var t=e.querySelector(".magnifyTool");t&&e.removeChild(t)}(e)}var x={enable:function(e){var t=x.getConfiguration(t);if(!v){var a=(0,o.getBrowserInfo)().split(" ");v=a[0]}O(e)},activate:function(e,t){(0,l.setToolOptions)(s,e,{mouseButtonMask:t}),e.removeEventListener(n.default.MOUSE_DOWN,T),e.addEventListener(n.default.MOUSE_DOWN,T),O(e)},deactivate:P,disable:P,getConfiguration:function(){return f},setConfiguration:function(e){f=e}};function C(e){e.removeEventListener(n.default.TOUCH_START,T),e.addEventListener(n.default.TOUCH_START,T)}function I(e){e.removeEventListener(n.default.TOUCH_START,T)}var w={activate:C,deactivate:I,enable:C,disable:I};t.magnify=x,t.magnifyTouchDrag=w},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(a(0)),r=c(a(48)),o=c(a(25)),i=c(a(7)),l=a(9),u=c(l),d=a(3);function c(e){return e&&e.__esModule?e:{default:e}}var s=(0,o.default)(function(e){var t=e.detail,a=t.element,o=function(e){var t=n.default.cornerstone,a=t.getEnabledElement(e),o=t.metaData.get("imagePlaneModule",a.image.imageId);if(o&&o.rowCosines&&o.columnCosines){var i=r.default.getOrientationString(o.rowCosines),l=r.default.getOrientationString(o.columnCosines),u=r.default.invertOrientationString(i);return{top:r.default.invertOrientationString(l),bottom:l,left:u,right:i}}}(a);if(o){var c=function(e){var t=n.default.cornerstone,a=t.getEnabledElement(e),r=void 0;r={x:a.image.width/2,y:5};var o=t.pixelToCanvas(e,r);r={x:a.image.width/2,y:a.image.height-5};var i=t.pixelToCanvas(e,r);r={x:5,y:a.image.height/2};var l=t.pixelToCanvas(e,r);return r={x:a.image.width-10,y:a.image.height/2},{top:o,bottom:i,left:l,right:t.pixelToCanvas(e,r)}}(a),f=(0,d.getNewContext)(t.canvasContext.canvas),v=i.default.getToolColor(),m=(0,l.textBoxWidth)(f,o.top,0),g=(0,l.textBoxWidth)(f,o.left,0),p=(0,l.textBoxWidth)(f,o.right,0),h=(0,l.textBoxWidth)(f,o.bottom,0);(0,u.default)(f,o.top,c.top.x-m/2,c.top.y,v),(0,u.default)(f,o.left,c.left.x-g/2,c.left.y,v);var E=s.getConfiguration();E&&E.drawAllMarkers&&((0,u.default)(f,o.right,c.right.x-p/2,c.right.y,v),(0,u.default)(f,o.bottom,c.bottom.x-h/2,c.bottom.y,v))}});t.default=s},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.panTouchDrag=t.pan=void 0;var n=d(a(1)),r=d(a(0)),o=d(a(16)),i=d(a(18)),l=d(a(6)),u=a(4);function d(e){return e&&e.__esModule?e:{default:e}}var c="pan";function s(e){var t=e.detail.element;t.removeEventListener(n.default.MOUSE_DRAG,f),t.removeEventListener(n.default.MOUSE_UP,s),t.removeEventListener(n.default.MOUSE_CLICK,s)}function f(e){var t=e.detail,a=t.viewport.scale,n=t.viewport.scale;t.image.rowPixelSpacing<t.image.columnPixelSpacing?a*=t.image.columnPixelSpacing/t.image.rowPixelSpacing:t.image.columnPixelSpacing<t.image.rowPixelSpacing&&(n*=t.image.rowPixelSpacing/t.image.columnPixelSpacing),t.viewport.translation.x+=t.deltaPoints.page.x/a,t.viewport.translation.y+=t.deltaPoints.page.y/n,r.default.cornerstone.setViewport(t.element,t.viewport),e.preventDefault(),e.stopPropagation()}var v=(0,o.default)(function(e){var t=e.detail,a=t.element,r=(0,u.getToolOptions)(c,a);(0,l.default)(t.which,r.mouseButtonMask)&&(a.addEventListener(n.default.MOUSE_DRAG,f),a.addEventListener(n.default.MOUSE_UP,s),a.addEventListener(n.default.MOUSE_CLICK,s),e.preventDefault(),e.stopPropagation())},c),m=(0,i.default)(f,c);t.pan=v,t.panTouchDrag=m},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(a(0));function r(e){return e&&e.__esModule?e:{default:e}}var o=(0,r(a(44)).default)(function(e){var t=e.detail,a=o.getConfiguration();a&&a.testPointers(t)&&(t.viewport.translation.x+=t.deltaPoints.page.x/t.viewport.scale,t.viewport.translation.y+=t.deltaPoints.page.y/t.viewport.scale,n.default.cornerstone.setViewport(t.element,t.viewport),e.preventDefault(),e.stopPropagation())});o.setConfiguration({testPointers:function(e){return e.numPointers>=2}}),t.default=o},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.probeTouch=t.probe=void 0;var n=v(a(0)),r=v(a(10)),o=v(a(12)),i=v(a(7)),l=v(a(20)),u=v(a(11)),d=(v(a(9)),v(a(38))),c=v(a(23)),s=a(2),f=a(3);function v(e){return e&&e.__esModule?e:{default:e}}var m="probe";function g(e){return{visible:!0,active:!0,color:void 0,handles:{end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0}}}}function p(e,t,a){if(!1===t.visible)return!1;var r=n.default.cornerstone.pixelToCanvas(e,t.handles.end);return n.default.cornerstoneMath.point.distance(r,a)<5}function h(e){var t=e.detail,a=(0,s.getToolState)(e.currentTarget,m);if(a)for(var r=n.default.cornerstone,o=(0,f.getNewContext)(t.canvasContext.canvas),v=(l.default.getFontSize(),function(e){var n=a.data[e];if(!1===n.visible)return"continue";(0,f.draw)(o,function(e){var a=i.default.getColorIfActive(n);(0,u.default)(e,t,n.handles,a);var o=Math.round(n.handles.end.x),l=Math.round(n.handles.end.y),s=void 0;if(o>=0&&l>=0&&o<t.image.columns&&l<t.image.rows){if(t.image.color)o+", "+l,"R: "+(s=(0,d.default)(t.element,o,l,1,1))[0]+" G: "+s[1]+" B: "+s[2];else{var f=(s=r.getStoredPixels(t.element,o,l,1,1))[0],v=f*t.image.slope+t.image.intercept,m=(0,c.default)(t.image,f);o+", "+l,"SP: "+f+" MO: "+parseFloat(v.toFixed(3)),m&&" SUV: "+parseFloat(m.toFixed(3))}var g={x:n.handles.end.x+3,y:n.handles.end.y-3};r.pixelToCanvas(t.element,g)}})}),g=0;g<a.data.length;g++)v(g)}var E=(0,r.default)({createNewMeasurement:g,onImageRendered:h,pointNearTool:p,toolType:m}),T=(0,o.default)({createNewMeasurement:g,onImageRendered:h,pointNearTool:p,toolType:m});t.probe=E,t.probeTouch=T},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.rectangleRoiTouch=t.rectangleRoi=void 0;var n=v(a(0)),r=v(a(10)),o=v(a(12)),i=v(a(15)),l=v(a(7)),u=v(a(11)),d=v(a(23)),c=a(2),s=v(a(21)),f=a(3);function v(e){return e&&e.__esModule?e:{default:e}}var m="rectangleRoi";function g(e){return{visible:!0,active:!0,invalidated:!0,color:void 0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function p(e,t,a){if(!1===t.visible)return!1;var r=n.default.cornerstone,o=r.pixelToCanvas(e,t.handles.start),i=r.pixelToCanvas(e,t.handles.end),l={left:Math.min(o.x,i.x),top:Math.min(o.y,i.y),width:Math.abs(o.x-i.x),height:Math.abs(o.y-i.y)};return n.default.cornerstoneMath.rect.distanceToPoint(l,a)<5}function h(e){var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}function E(e){var t=e.detail,a=(0,c.getToolState)(e.currentTarget,m);if(a){var r=n.default.cornerstone,o=t.image,v=t.element,g=i.default.getToolWidth(),p=T.getConfiguration(),E=r.metaData.get("generalSeriesModule",o.imageId),y=r.metaData.get("imagePlaneModule",o.imageId),M=void 0,S=void 0,b=void 0;y?(S=y.rowPixelSpacing||y.rowImagePixelSpacing,b=y.columnPixelSpacing||y.colImagePixelSpacing):(S=o.rowPixelSpacing,b=o.columnPixelSpacing),E&&(M=E.modality);for(var O=(0,f.getNewContext)(t.canvasContext.canvas),_=function(e){var n=a.data[e];if(!1===n.visible)return"continue";(0,f.draw)(O,function(e){(0,f.setShadow)(e,p);var a=l.default.getColorIfActive(n);if((0,f.drawRect)(e,v,n.handles.start,n.handles.end,{color:a}),p&&p.drawHandlesOnHover)if(!0===n.active)(0,u.default)(e,t,n.handles,a);else{(0,u.default)(e,t,n.handles,a,{drawHandlesIfActive:!0})}else(0,u.default)(e,t,n.handles,a);var i=void 0,c=void 0,m=void 0;if(!1===n.invalidated)c=n.meanStdDev,m=n.meanStdDevSUV,i=n.area;else{var E={left:Math.min(n.handles.start.x,n.handles.end.x),top:Math.min(n.handles.start.y,n.handles.end.y),width:Math.abs(n.handles.start.x-n.handles.end.x),height:Math.abs(n.handles.start.y-n.handles.end.y)};if(!o.color)c=function(e,t){for(var a=0,n=0,r=0,o=0,i=t.top;i<t.top+t.height;i++)for(var l=t.left;l<t.left+t.width;l++)a+=e[o],n+=e[o]*e[o],r++,o++;if(0===r)return{count:r,mean:0,variance:0,stdDev:0};var u=a/r,d=n/r-u*u;return{count:r,mean:u,variance:d,stdDev:Math.sqrt(d)}}(r.getPixels(v,E.left,E.top,E.width,E.height),E),"PT"===M&&(m={mean:(0,d.default)(o,(c.mean-o.intercept)/o.slope),stdDev:(0,d.default)(o,(c.stdDev-o.intercept)/o.slope)}),c&&!isNaN(c.mean)&&(n.meanStdDev=c,n.meanStdDevSUV=m);i=E.width*(b||1)*(E.height*(S||1)),isNaN(i)||(n.area=i),n.invalidated=!1}var T=function(e){var t=e.meanStdDev,a=e.meanStdDevSUV,n=e.area,r=[];if(t&&t.mean){var o="";"CT"===M&&(o=" HU");var i="Mean: "+h(t.mean.toFixed(2))+o,l="StdDev: "+h(t.stdDev.toFixed(2))+o;if(a&&void 0!==a.mean){i+=" SUV: "+h(a.mean.toFixed(2)),l+=" SUV: "+h(a.stdDev.toFixed(2))}r.push(i),r.push(l)}if(n){var u=" mm"+String.fromCharCode(178);S&&b||(u=" pixels"+String.fromCharCode(178));var d="Area: "+h(n.toFixed(2))+u;r.push(d)}return[]}(n);n.handles.textBox.hasMoved||(n.handles.textBox.x=Math.max(n.handles.start.x,n.handles.end.x),n.handles.textBox.y=(n.handles.start.y+n.handles.end.y)/2),(0,s.default)(e,v,n.handles.textBox,T,n.handles,x,a,g,0,!0)})},P=0;P<a.data.length;P++)_(P)}function x(e){var t=Math.min(e.start.x,e.end.x),a=Math.min(e.start.y,e.end.y),n=Math.abs(e.start.x-e.end.x),r=Math.abs(e.start.y-e.end.y);return[{x:t+n/2,y:a},{x:t,y:a+r/2},{x:t+n/2,y:a+r},{x:t+n,y:a+r/2}]}}var T=(0,r.default)({createNewMeasurement:g,onImageRendered:E,pointNearTool:p,toolType:m}),y=(0,o.default)({createNewMeasurement:g,onImageRendered:E,pointNearTool:p,toolType:m});t.rectangleRoi=T,t.rectangleRoiTouch=y},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.rotateTouchDrag=t.rotate=void 0;var n=d(a(1)),r=d(a(0)),o=d(a(16)),i=d(a(59)),l=d(a(6)),u=a(4);function d(e){return e&&e.__esModule?e:{default:e}}var c="rotate";function s(e,t,a){var n=e.element.getBoundingClientRect(e.element),o=e.element.clientWidth,i=e.element.clientHeight,l=e.viewport.scale,u=e.viewport.translation,d={x:n.left+o/2+u.x*l,y:n.top+i/2+u.y*l},c=t,s={x:e.currentPoints.client.x,y:e.currentPoints.client.y},f=Math.sqrt(Math.pow(d.x-c.x,2)+Math.pow(d.y-c.y,2)),v=Math.sqrt(Math.pow(d.x-s.x,2)+Math.pow(d.y-s.y,2)),m=Math.sqrt(Math.pow(c.x-s.x,2)+Math.pow(c.y-s.y,2)),g=180*Math.acos((Math.pow(f,2)+Math.pow(v,2)-Math.pow(m,2))/(2*f*v))/Math.PI;(c.x-d.x)*(s.y-d.y)-(c.y-d.y)*(s.x-d.x)<0&&(g=-g),e.viewport.rotation=a+g,r.default.cornerstone.setViewport(e.element,e.viewport)}function f(e,t,a){var n=a.detail;v.strategy(n,e,t),r.default.cornerstone.setViewport(n.element,n.viewport),a.preventDefault(),a.stopPropagation()}var v=(0,o.default)(function(e){var t=e.detail,a=t.element,r=(0,u.getToolOptions)(c,a),o={x:t.currentPoints.client.x,y:t.currentPoints.client.y},i=t.viewport.rotation;if((0,l.default)(t.which,r.mouseButtonMask)){var d=f.bind({},o,i),s=function e(t){var a=t.detail.element;a.removeEventListener(n.default.MOUSE_DRAG,d),a.removeEventListener(n.default.MOUSE_UP,e),a.removeEventListener(n.default.MOUSE_CLICK,e)};a.addEventListener(n.default.MOUSE_DRAG,d),a.addEventListener(n.default.MOUSE_UP,s),a.addEventListener(n.default.MOUSE_CLICK,s),e.preventDefault(),e.stopPropagation()}},c);v.strategies={default:s,horizontal:function(e){e.viewport.rotation+=e.deltaPoints.page.x/e.viewport.scale,r.default.cornerstone.setViewport(e.element,e.viewport)},vertical:function(e){e.viewport.rotation+=e.deltaPoints.page.y/e.viewport.scale,r.default.cornerstone.setViewport(e.element,e.viewport)}},v.strategy=s;var m=(0,i.default)(function(e){var t=e.detail,a=t.element,r={x:t.currentPoints.client.x,y:t.currentPoints.client.y},o=t.viewport.rotation,i=f.bind({},r,o);a.addEventListener(n.default.TOUCH_DRAG,i),a.addEventListener(n.default.TOUCH_END,function e(t){var a=t.detail.element;a.removeEventListener(n.default.TOUCH_DRAG,i),a.removeEventListener(n.default.TOUCH_END,e)}),e.preventDefault(),e.stopPropagation()},c);t.rotate=v,t.rotateTouchDrag=m},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(a(1)),r=o(a(0));function o(e){return e&&e.__esModule?e:{default:e}}function i(e){var t=e.detail;return t.viewport.rotation+=t.rotation,r.default.cornerstone.setViewport(t.element,t.viewport),!1}var l={activate:function(e){e.removeEventListener(n.default.TOUCH_ROTATE,i),e.addEventListener(n.default.TOUCH_ROTATE,i)},disable:function(e){e.removeEventListener(n.default.TOUCH_ROTATE,i)}};t.default=l},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"image/png",n=e.querySelector("canvas");if(n.msToBlob){var r=n.msToBlob();return window.navigator.msSaveBlob(r,t)}var o=document.createElement("a");if(o.download=t,o.href=n.toDataURL(a,1),document.createEvent){var i=document.createEvent("MouseEvents");i.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),o.dispatchEvent(i)}else o.fireEvent&&o.fireEvent("onclick")}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(a(25)),r=l(a(1)),o=l(a(0)),i=a(3);function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t,a,n,r){var o={left:0,top:0,width:t.width,height:t.height},i=n*Math.min(1e3,t.width),l=r*Math.min(1e3,t.height);return{topLeft:{x:(o={left:o.left+i,top:o.top+l,width:o.width-2*i,height:o.height-2*l}).left,y:o.top},bottomRight:{x:o.left+o.width,y:o.top+o.height}}}function d(e){var t=e.detail,a=(0,i.getNewContext)(t.canvasContext.canvas),n=t.image,r=t.viewport,l=o.default.cornerstone.metaData.get("imagePlaneModule",n.imageId),d=void 0,s=void 0;if(l?(d=l.rowPixelSpacing||l.rowImagePixelSpacing,s=l.columnPixelSpacing||l.colImagePixelSpacing):(d=n.rowPixelSpacing,s=n.columnPixelSpacing),d&&s){var f={width:a.canvas.width,height:a.canvas.height},v={width:n.width,height:n.height},m=10/d*r.scale,g=10/s*r.scale,p=u(0,f,0,.25,.05),h=u(0,f,0,.05,.15);if(f.width&&f.height&&v.width&&v.height&&p&&h){var E=c.getConfiguration(),T=Object.assign({},{hscaleBounds:p,vscaleBounds:h,verticalMinorTick:m,horizontalMinorTick:g,minorTickLength:12.5,majorTickLength:25,verticalLine:{start:{x:h.bottomRight.x,y:h.topLeft.y},end:{x:h.bottomRight.x,y:h.bottomRight.y}},horizontalLine:{start:{x:p.topLeft.x,y:p.bottomRight.y},end:{x:p.bottomRight.x,y:p.bottomRight.y}}},E),y={color:T.color,lineWidth:T.lineWidth},M=function(e){for(var t=0,a=[];e.verticalLine.start.y+t*e.verticalMinorTick<=e.vscaleBounds.bottomRight.y;){var n={x:e.verticalLine.start.x,y:e.verticalLine.start.y+t*e.verticalMinorTick},r={x:0,y:e.verticalLine.start.y+t*e.verticalMinorTick};r.x=t%5==0?e.verticalLine.start.x-e.majorTickLength:e.verticalLine.start.x-e.minorTickLength,a.push({start:n,end:r}),t++}return a}(T),S=function(e){for(var t=0,a=[];e.horizontalLine.start.x+t*e.horizontalMinorTick<=e.hscaleBounds.bottomRight.x;){var n={x:e.horizontalLine.start.x+t*e.horizontalMinorTick,y:e.horizontalLine.start.y},r={x:e.horizontalLine.start.x+t*e.horizontalMinorTick,y:0};r.y=t%5==0?e.horizontalLine.start.y-e.majorTickLength:e.horizontalLine.start.y-e.minorTickLength,a.push({start:n,end:r}),t++}return a}(T);(0,i.draw)(a,function(e){e.shadowColor=T.shadowColor,e.shadowBlur=T.shadowBlur,(0,i.drawLine)(e,void 0,T.verticalLine.start,T.verticalLine.end,y,"canvas"),(0,i.drawLine)(e,void 0,T.horizontalLine.start,T.horizontalLine.end,y,"canvas"),(0,i.drawLines)(e,void 0,M,y,"canvas"),(0,i.drawLines)(e,void 0,S,y,"canvas")})}}}var c=(0,n.default)(d);c.setConfiguration({color:"white",lineWidth:2,shadowColor:"black",shadowBlur:4}),c.disable=function(e){e.removeEventListener(r.default.IMAGE_RENDERED,d),o.default.cornerstone.updateImage(e)},t.default=c},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.seedAnnotateTouch=t.seedAnnotate=void 0;var n=y(a(1)),r=y(a(0)),o=y(a(10)),i=y(a(12)),l=y(a(20)),u=y(a(15)),d=y(a(7)),c=y(a(14)),s=y(a(27)),f=y(a(11)),v=y(a(6)),m=y(a(22)),g=y(a(21)),p=a(2),h=a(4),E=a(3),T=a(9);function y(e){return e&&e.__esModule?e:{default:e}}var M="seedAnnotate";var S={getTextCallback:function(e){e(prompt("Enter your annotation:"))},changeTextCallback:function(e,t,a){a(prompt("Change your annotation:"))},drawHandles:!1,drawHandlesOnHover:!0,currentLetter:"A",currentNumber:0,showCoordinates:!0,countUp:!0};function b(e){return{visible:!0,active:!0,color:void 0,handles:{end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function O(e,t,a){if(!1===t.visible)return!1;if(t.handles.end){var n=r.default.cornerstone.pixelToCanvas(e,t.handles.end);return r.default.cornerstoneMath.point.distance(n,a)<25}}function _(e){var t=e.detail,a=(0,p.getToolState)(e.currentTarget,M);if(a)for(var n=r.default.cornerstone,o=t.enabledElement,i=(0,E.getNewContext)(t.canvasContext.canvas),c=t.canvasContext.canvas.width,s=u.default.getToolWidth(),v=P.getConfiguration(),m=function(e){var r=a.data[e];if(!1===r.visible)return"continue";(0,E.draw)(i,function(e){(0,E.setShadow)(e,v);var a=d.default.getColorIfActive(r),i=n.pixelToCanvas(t.element,r.handles.end);(0,E.drawCircle)(e,t.element,r.handles.end,6,{color:a});var u={drawHandlesIfActive:v&&v.drawHandlesOnHover};if(v.drawHandles&&(0,f.default)(e,t,i,a,u),r.text&&""!==r.text){var m=function(e){var t="";t=v.showCoordinates?e.text+" x: "+Math.round(e.handles.end.x)+" y: "+Math.round(e.handles.end.y):e.text;return t}(r),p=(0,T.textBoxWidth)(e,m,5),h=l.default.getFontSize()+10,M=Math.max(p,h)/2+5;i.x>c/2&&(M=-M);var S=void 0;if(!r.handles.textBox.hasMoved){S={x:i.x-p/2+M,y:i.y-h/2};var b=n.internal.getTransform(o);b.invert();var O=b.transformPoint(S.x,S.y);r.handles.textBox.x=O.x,r.handles.textBox.y=O.y}(0,g.default)(e,t.element,r.handles.textBox,m,r.handles,y,a,s,0,!1)}})},h=0;h<a.data.length;h++)m(h);function y(e){return[e.end]}}var P=(0,o.default)({addNewMeasurement:function(e){var t=r.default.cornerstone,a=e.element,n=P.getConfiguration(),o=b(e);function i(e){null===e?(0,p.removeToolState)(a,M,o):o.text=e,o.active=!1,t.updateImage(a)}(0,p.addToolState)(a,M,o),t.updateImage(a),(0,s.default)(e,M,o,o.handles.end,function(){(0,c.default)(e,o.handles)&&(0,p.removeToolState)(a,M,o),void 0===o.text&&n.getTextCallback(i),t.updateImage(a)})},createNewMeasurement:b,onImageRendered:_,pointNearTool:O,toolType:M,mouseDoubleClickCallback:function(e){var t=e.detail,a=r.default.cornerstone,n=t.element,o=void 0,i=(0,h.getToolOptions)(M,n);if((0,v.default)(t.which,i.mouseButtonMask)){var l=P.getConfiguration(),u=t.currentPoints.canvas,d=(0,p.getToolState)(n,M);if(d){for(var c=0;c<d.data.length;c++)if(o=d.data[c],O(n,o,u)||(0,m.default)(o.handles.textBox,u))return o.active=!0,a.updateImage(n),l.changeTextCallback(o,t,s),e.stopImmediatePropagation(),!1;e.preventDefault(),e.stopPropagation()}}function s(e,t,r){!0===r?(0,p.removeToolState)(n,M,e):e.text=t,e.active=!1,a.updateImage(n)}}});P.setConfiguration(S);var x=(0,i.default)({addNewMeasurement:function(e){var t=r.default.cornerstone,a=e.element,n=P.getConfiguration(),o=b(e);function i(e){null===e?(0,p.removeToolState)(a,M,o):o.text=e,o.active=!1,t.updateImage(a)}(0,p.addToolState)(a,M,o),t.updateImage(a),(0,s.default)(e,M,o,o.handles.end,function(){(0,c.default)(e,o.handles)&&(0,p.removeToolState)(a,M,o),void 0===o.text&&n.getTextCallback(i),t.updateImage(a)})},createNewMeasurement:b,onImageRendered:_,pointNearTool:O,toolType:M,pressCallback:function(e){var t=e.detail,a=r.default.cornerstone,o=t.element,i=void 0;function l(e,t,r){console.log("pressCallback doneChangingTextCallback"),!0===r?(0,p.removeToolState)(o,M,e):e.text=t,e.active=!1,a.updateImage(o),o.addEventListener(n.default.TOUCH_START,x.touchStartCallback),o.addEventListener(n.default.TOUCH_START_ACTIVE,x.touchDownActivateCallback),o.addEventListener(n.default.TAP,x.tapCallback)}var u=P.getConfiguration(),d=t.currentPoints.canvas,c=(0,p.getToolState)(o,M);if(!c)return!1;if(t.handlePressed)return o.removeEventListener(n.default.TOUCH_START,x.touchStartCallback),o.removeEventListener(n.default.TOUCH_START_ACTIVE,x.touchDownActivateCallback),o.removeEventListener(n.default.TAP,x.tapCallback),u.changeTextCallback(t.handlePressed,t,l),e.stopImmediatePropagation(),!1;for(var s=0;s<c.data.length;s++)if(i=c.data[s],O(o,i,d)||(0,m.default)(i.handles.textBox,d))return i.active=!0,a.updateImage(o),o.removeEventListener(n.default.TOUCH_START,x.touchStartCallback),o.removeEventListener(n.default.TOUCH_START_ACTIVE,x.touchDownActivateCallback),o.removeEventListener(n.default.TAP,x.tapCallback),u.changeTextCallback(i,t,l),e.stopImmediatePropagation(),!1;e.preventDefault(),e.stopPropagation()}});t.seedAnnotate=P,t.seedAnnotateTouch=x},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.simpleAngleTouch=t.simpleAngle=void 0;var n=T(a(1)),r=T(a(0)),o=T(a(10)),i=T(a(36)),l=T(a(21)),u=T(a(15)),d=T(a(7)),c=T(a(14)),s=T(a(28)),f=T(a(30)),v=T(a(11)),m=T(a(12)),g=T(a(31)),p=a(2),h=a(3),E=a(9);function T(e){return e&&e.__esModule?e:{default:e}}var y="simpleAngle";function M(e){return{visible:!0,active:!0,color:void 0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},middle:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function S(e,t,a){return!1!==t.visible&&((0,g.default)(e,t.handles.start,t.handles.middle,a)<25||(0,g.default)(e,t.handles.middle,t.handles.end,a)<25)}function b(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}function O(e){var t=e.detail,a=(0,p.getToolState)(e.currentTarget,y);if(a)for(var n=r.default.cornerstone,o=t.enabledElement,c=(0,h.getNewContext)(t.canvasContext.canvas),s=u.default.getToolWidth(),f=_.getConfiguration(),m=function(e){var r=a.data[e];if(!1===r.visible)return"continue";(0,h.draw)(c,function(e){(0,h.setShadow)(e,f);var a=d.default.getColorIfActive(r),u=n.pixelToCanvas(t.element,r.handles.start),c=n.pixelToCanvas(t.element,r.handles.middle);(0,h.drawJoinedLines)(e,t.element,r.handles.start,[r.handles.middle,r.handles.end],{color:a});var m={drawHandlesIfActive:f&&f.drawHandlesOnHover};(0,v.default)(e,t,r.handles,a,m);var g=t.image.columnPixelSpacing||1,p=t.image.rowPixelSpacing||1,y={x:(Math.ceil(r.handles.middle.x)-Math.ceil(r.handles.start.x))*g,y:(Math.ceil(r.handles.middle.y)-Math.ceil(r.handles.start.y))*p},M={x:(Math.ceil(r.handles.end.x)-Math.ceil(r.handles.middle.x))*g,y:(Math.ceil(r.handles.end.y)-Math.ceil(r.handles.middle.y))*p},S={x:(Math.ceil(r.handles.end.x)-Math.ceil(r.handles.start.x))*g,y:(Math.ceil(r.handles.end.y)-Math.ceil(r.handles.start.y))*p},O=b(y),_=b(M),P=b(S),x=Math.acos((Math.pow(O,2)+Math.pow(_,2)-Math.pow(P,2))/(2*O*_));if(x*=180/Math.PI,r.rAngle=(0,i.default)(x,2),r.rAngle){var C=function(e,t,a){var n=t&&a?"":" (isotropic)";return e.rAngle.toString()+String.fromCharCode(parseInt("00B0",16))+n}(r,t.image.rowPixelSpacing,t.image.columnPixelSpacing),I=void 0;if(!r.handles.textBox.hasMoved){I={x:c.x,y:c.y};var w=(0,E.textBoxWidth)(e,C,5);c.x<u.x?I.x-=15+w:I.x+=15;var L=n.internal.getTransform(o);L.invert();var D=L.transformPoint(I.x,I.y);r.handles.textBox.x=D.x,r.handles.textBox.y=D.y}(0,l.default)(e,t.element,r.handles.textBox,C,r.handles,T,a,s,0,!0)}})},g=0;g<a.data.length;g++)m(g);function T(e){return[e.start,e.middle,e.end]}}var _=(0,o.default)({createNewMeasurement:M,addNewMeasurement:function(e){var t=r.default.cornerstone,a=M(e),o=e.element;(0,p.addToolState)(o,y,a),o.removeEventListener(n.default.MOUSE_MOVE,_.mouseMoveCallback),o.removeEventListener(n.default.MOUSE_DRAG,_.mouseMoveCallback),o.removeEventListener(n.default.MOUSE_DOWN,_.mouseDownCallback),o.removeEventListener(n.default.MOUSE_DOWN_ACTIVATE,_.mouseDownActivateCallback),t.updateImage(o),(0,s.default)(e,y,a,a.handles.middle,function(){if(a.active=!1,(0,c.default)(e,a.handles))return(0,p.removeToolState)(o,y,a),o.addEventListener(n.default.MOUSE_MOVE,_.mouseMoveCallback),o.addEventListener(n.default.MOUSE_DRAG,_.mouseMoveCallback),o.addEventListener(n.default.MOUSE_DOWN,_.mouseDownCallback),o.addEventListener(n.default.MOUSE_DOWN_ACTIVATE,_.mouseDownActivateCallback),void t.updateImage(o);a.handles.end.active=!0,t.updateImage(o),(0,s.default)(e,y,a,a.handles.end,function(){a.active=!1,(0,c.default)(e,a.handles)&&(0,p.removeToolState)(o,y,a),o.addEventListener(n.default.MOUSE_MOVE,_.mouseMoveCallback),o.addEventListener(n.default.MOUSE_DRAG,_.mouseMoveCallback),o.addEventListener(n.default.MOUSE_DOWN,_.mouseDownCallback),o.addEventListener(n.default.MOUSE_DOWN_ACTIVATE,_.mouseDownActivateCallback),t.updateImage(o)})})},onImageRendered:O,pointNearTool:S,toolType:y}),P=(0,m.default)({createNewMeasurement:M,addNewMeasurement:function(e){var t=r.default.cornerstone,a=M(e),o=e.element;(0,p.addToolState)(o,y,a),o.removeEventListener(n.default.TOUCH_DRAG,P.touchMoveCallback),o.removeEventListener(n.default.TOUCH_START_ACTIVE,P.touchDownActivateCallback),o.removeEventListener(n.default.TOUCH_START,P.touchStartCallback),o.removeEventListener(n.default.TAP,P.tapCallback),t.updateImage(o),(0,f.default)(e,y,a,a.handles.middle,function(){if((0,c.default)(e,a.handles))return(0,p.removeToolState)(o,y,a),o.addEventListener(n.default.TOUCH_DRAG,P.touchMoveCallback),o.addEventListener(n.default.TOUCH_START,P.touchStartCallback),o.addEventListener(n.default.TOUCH_START_ACTIVE,P.touchDownActivateCallback),o.addEventListener(n.default.TAP,P.tapCallback),void t.updateImage(o);(0,f.default)(e,y,a,a.handles.end,function(){(0,c.default)(e,a.handles)&&((0,p.removeToolState)(o,y,a),t.updateImage(o)),o.addEventListener(n.default.TOUCH_DRAG,P.touchMoveCallback),o.addEventListener(n.default.TOUCH_START,P.touchStartCallback),o.addEventListener(n.default.TOUCH_START_ACTIVE,P.touchDownActivateCallback),o.addEventListener(n.default.TAP,P.tapCallback)})})},onImageRendered:O,pointNearTool:S,toolType:y});t.simpleAngle=_,t.simpleAngleTouch=P},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.textMarkerTouch=t.textMarker=void 0;var n=g(a(1)),r=g(a(0)),o=g(a(10)),i=g(a(12)),l=g(a(22)),u=g(a(7)),d=g(a(6)),c=a(9),s=g(c),f=a(2),v=a(4),m=a(3);function g(e){return e&&e.__esModule?e:{default:e}}var p="textMarker";function h(e){var t=y.getConfiguration();if(t.current){var a={visible:!0,active:!0,text:t.current,color:void 0,handles:{end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0,hasBoundingBox:!0}}},n={left:0,top:0,width:e.image.width,height:e.image.height};if(r.default.cornerstoneMath.point.insideRect(a.handles.end,n)){var o=t.markers.indexOf(t.current);return t.ascending?(o+=1)>=t.markers.length&&(t.loop?o-=t.markers.length:o=-1):(o-=1)<0&&(t.loop?o+=t.markers.length:o=-1),t.current=t.markers[o],a}}}function E(e,t,a){if(!1===t.visible)return!1;if(t.handles.end.boundingBox){var n=r.default.cornerstoneMath.rect.distanceToPoint(t.handles.end.boundingBox,a),o=(0,l.default)(t.handles.end,a);return n<10||o}}function T(e){var t=e.detail,a=(0,f.getToolState)(t.element,p);if(a)for(var n=(0,m.getNewContext)(t.canvasContext.canvas),o=y.getConfiguration(),i=function(e){var i=a.data[e];if(!1===i.visible)return"continue";var l=u.default.getColorIfActive(i);(0,m.draw)(n,function(e){(0,m.setShadow)(e,o);i.textWidth=(0,c.textBoxWidth)(e,i.text,5);var a=r.default.cornerstone.pixelToCanvas(t.element,i.handles.end);i.handles.end.boundingBox=(0,s.default)(e,i.text,a.x,a.y-10,l,{centering:{x:!0,y:!0}})})},l=0;l<a.data.length;l++)i(l)}var y=(0,o.default)({createNewMeasurement:h,onImageRendered:T,pointNearTool:E,toolType:p,mouseDoubleClickCallback:function(e){var t=e.detail,a=r.default.cornerstone,o=t.element,i=void 0,l=(0,v.getToolOptions)(p,o);if((0,d.default)(t.which,l.mouseButtonMask)){var u=y.getConfiguration(),c=t.currentPoints.canvas,s=(0,f.getToolState)(o,p);if(s){for(var m=0;m<s.data.length;m++)if(E(0,i=s.data[m],c))return i.active=!0,a.updateImage(o),o.removeEventListener(n.default.MOUSE_MOVE,y.mouseMoveCallback),o.removeEventListener(n.default.MOUSE_DOWN,y.mouseDownCallback),o.removeEventListener(n.default.MOUSE_DOWN_ACTIVATE,y.mouseDownActivateCallback),o.removeEventListener(n.default.MOUSE_DOUBLE_CLICK,y.mouseDoubleClickCallback),u.changeTextCallback(i,t,g),e.stopImmediatePropagation(),e.preventDefault(),void e.stopPropagation();e.preventDefault(),e.stopPropagation()}}function g(e,t,r){!0===r?(0,f.removeToolState)(o,p,e):e.text=t,e.active=!1,a.updateImage(o),o.addEventListener(n.default.MOUSE_MOVE,y.mouseMoveCallback),o.addEventListener(n.default.MOUSE_DOWN,y.mouseDownCallback),o.addEventListener(n.default.MOUSE_DOWN_ACTIVATE,y.mouseDownActivateCallback),o.addEventListener(n.default.MOUSE_DOUBLE_CLICK,y.mouseDoubleClickCallback)}}}),M=(0,i.default)({createNewMeasurement:h,onImageRendered:T,pointNearTool:E,toolType:p,pressCallback:function(e){var t=e.detail,a=r.default.cornerstone,o=t.element,i=void 0;function l(e,t,r){!0===r?(0,f.removeToolState)(o,p,e):e.text=t,e.active=!1,a.updateImage(o),o.addEventListener(n.default.TOUCH_DRAG,M.touchMoveCallback),o.addEventListener(n.default.TOUCH_START_ACTIVE,M.touchDownActivateCallback),o.addEventListener(n.default.TOUCH_START,M.touchStartCallback),o.addEventListener(n.default.TAP,M.tapCallback),o.addEventListener(n.default.TOUCH_PRESS,M.pressCallback)}var u=y.getConfiguration(),d=t.currentPoints.canvas,c=(0,f.getToolState)(o,p);if(!c)return!1;if(t.handlePressed)return t.handlePressed.active=!0,a.updateImage(o),o.removeEventListener(n.default.TOUCH_DRAG,M.touchMoveCallback),o.removeEventListener(n.default.TOUCH_START_ACTIVE,M.touchDownActivateCallback),o.removeEventListener(n.default.TOUCH_START,M.touchStartCallback),o.removeEventListener(n.default.TAP,M.tapCallback),o.removeEventListener(n.default.TOUCH_PRESS,M.pressCallback),u.changeTextCallback(t.handlePressed,t,l),e.stopImmediatePropagation(),e.preventDefault(),void e.stopPropagation();for(var s=0;s<c.data.length;s++)if(E(0,i=c.data[s],d))return i.active=!0,a.updateImage(o),o.removeEventListener(n.default.TOUCH_DRAG,M.touchMoveCallback),o.removeEventListener(n.default.TOUCH_START_ACTIVE,M.touchDownActivateCallback),o.removeEventListener(n.default.TOUCH_START,M.touchStartCallback),o.removeEventListener(n.default.TAP,M.tapCallback),o.removeEventListener(n.default.TOUCH_PRESS,M.pressCallback),u.changeTextCallback(i,t,l),e.stopImmediatePropagation(),e.preventDefault(),void e.stopPropagation();e.preventDefault(),e.stopPropagation()}});t.textMarker=y,t.textMarkerTouch=M},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wwwcTouchDrag=t.wwwc=void 0;var n=d(a(1)),r=d(a(0)),o=d(a(16)),i=d(a(18)),l=d(a(6)),u=a(4);function d(e){return e&&e.__esModule?e:{default:e}}var c="wwwc";function s(e){var t=e.detail.element;t.removeEventListener(n.default.MOUSE_DRAG,v),t.removeEventListener(n.default.MOUSE_UP,s),t.removeEventListener(n.default.MOUSE_CLICK,s)}function f(e){var t=(e.image.maxPixelValue*e.image.slope+e.image.intercept-(e.image.minPixelValue*e.image.slope+e.image.intercept))/1024,a=e.deltaPoints.page.x*t,n=e.deltaPoints.page.y*t;e.viewport.voi.windowWidth+=a,e.viewport.voi.windowCenter+=n}function v(e){var t=e.detail;m.strategy(t),r.default.cornerstone.setViewport(t.element,t.viewport)}var m=(0,o.default)(function(e){var t=e.detail,a=t.element,r=(0,u.getToolOptions)(c,a);(0,l.default)(t.which,r.mouseButtonMask)&&(a.addEventListener(n.default.MOUSE_DRAG,v),a.addEventListener(n.default.MOUSE_UP,s),a.addEventListener(n.default.MOUSE_CLICK,s),e.preventDefault(),e.stopPropagation())},c);m.strategies={default:f},m.strategy=f;var g=(0,i.default)(function(e){var t=e.detail;e.stopImmediatePropagation();var a=t,n=(a.image.maxPixelValue*a.image.slope+a.image.intercept-(a.image.minPixelValue*a.image.slope+a.image.intercept))/1024,o=a.deltaPoints.page.x*n,i=a.deltaPoints.page.y*n,l=m.getConfiguration();l.orientation?0===l.orientation?(a.viewport.voi.windowWidth+=o,a.viewport.voi.windowCenter+=i):(a.viewport.voi.windowWidth+=i,a.viewport.voi.windowCenter+=o):(a.viewport.voi.windowWidth+=o,a.viewport.voi.windowCenter+=i),r.default.cornerstone.setViewport(a.element,a.viewport)});t.wwwc=m,t.wwwcTouchDrag=g},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wwwcRegionTouch=t.wwwcRegion=void 0;var n=f(a(1)),r=f(a(0)),o=f(a(7)),i=a(2),l=f(a(50)),u=f(a(6)),d=a(4),c=f(a(8)),s=a(3);function f(e){return e&&e.__esModule?e:{default:e}}var v="wwwcRegion",m={minWindowWidth:10};function g(e){var t=e.detail.element,a=(0,i.getToolState)(t,v);a&&a.data&&(a.data=[]),t.removeEventListener(n.default.MOUSE_MOVE,M),t.removeEventListener(n.default.MOUSE_DRAG,M),t.removeEventListener(n.default.MOUSE_UP,p),t.removeEventListener(n.default.MOUSE_CLICK,p),t.addEventListener(n.default.MOUSE_DOWN,T)}function p(e){var t=e.detail,a=t.element;a.removeEventListener(n.default.MOUSE_MOVE,M),a.removeEventListener(n.default.MOUSE_DRAG,M),a.removeEventListener(n.default.MOUSE_UP,p),a.removeEventListener(n.default.MOUSE_CLICK,p),a.addEventListener(n.default.MOUSE_DOWN,T);var r=(0,i.getToolState)(t.element,v);r&&r.data&&r.data.length&&(r.data[0].endPoint={x:t.currentPoints.image.x,y:t.currentPoints.image.y},h(t))}function h(e){var t=r.default.cornerstone,a=(0,i.getToolState)(e.element,v);if(a&&a.data&&a.data.length){var n=a.data[0].startPoint,o=a.data[0].endPoint,u=Math.abs(n.x-o.x),d=Math.abs(n.y-o.y),s=Math.min(n.x,o.x),f=Math.min(n.y,o.y);s=(0,c.default)(s,0,e.image.width),f=(0,c.default)(f,0,e.image.height),u=Math.floor(Math.min(u,Math.abs(e.image.width-s))),d=Math.floor(Math.min(d,Math.abs(e.image.height-f)));var m=function(e,t,a){var n=e.length;if(n<2)return{min:t,max:a,mean:(t+a)/2};for(var r=a,o=t,i=0,l=0;l<n;l++){var u=e[l];r=Math.min(r,u),o=Math.max(o,u),i+=u}return{min:r,max:o,mean:i/n}}((0,l.default)(e.element,s,f,u,d),e.image.minPixelValue,e.image.maxPixelValue),g=_.getConfiguration(),p=t.getViewport(e.element);void 0===g.minWindowWidth&&(g.minWindowWidth=10),p.voi.windowWidth=Math.max(Math.abs(m.max-m.min),g.minWindowWidth),p.voi.windowCenter=m.mean,t.setViewport(e.element,p),a.data=[],t.updateImage(e.element)}}function E(e){var t=e.detail.element;t.removeEventListener(n.default.MOUSE_MOVE,E),t.removeEventListener(n.default.MOUSE_DRAG,E),t.addEventListener(n.default.MOUSE_MOVE,M),t.addEventListener(n.default.MOUSE_DRAG,M),t.addEventListener(n.default.MOUSE_CLICK,p),e.type===n.default.MOUSE_DRAG&&t.addEventListener(n.default.MOUSE_UP,p)}function T(e){var t=e.detail,a=t.element,r=(0,d.getToolOptions)(v,a);if((0,u.default)(t.which,r.mouseButtonMask))return a.addEventListener(n.default.MOUSE_DRAG,E),a.addEventListener(n.default.MOUSE_MOVE,E),a.removeEventListener(n.default.MOUSE_DOWN,T),y(t),!1}function y(e){var t=(0,i.getToolState)(e.element,v);t&&t.data&&(t.data=[]);var a={startPoint:{x:e.currentPoints.image.x,y:e.currentPoints.image.y}};(0,i.addToolState)(e.element,v,a)}function M(e){var t=e.detail,a=t.element,n=(0,i.getToolState)(a,v);n&&n.data&&n.data.length&&(n.data[0].endPoint={x:t.currentPoints.image.x,y:t.currentPoints.image.y},r.default.cornerstone.updateImage(a))}function S(e){var t=e.detail,a=t.element,n=t.canvasContext,r=(0,i.getToolState)(t.element,v);if(r&&r.data&&r.data.length){var l=r.data[0].startPoint,u=r.data[0].endPoint;if(l&&u){n.setTransform(1,0,0,1,0,0);var d=o.default.getActiveColor(),c=_.getConfiguration();(0,s.draw)(n,function(e){(0,s.setShadow)(e,c),(0,s.drawRect)(e,a,l,u,{color:d})})}}}function b(e){e.removeEventListener(n.default.MOUSE_DOWN,T),e.removeEventListener(n.default.MOUSE_UP,p),e.removeEventListener(n.default.MOUSE_CLICK,p),e.removeEventListener(n.default.MOUSE_DRAG,M),e.removeEventListener(n.default.MOUSE_MOVE,M),e.removeEventListener(n.default.IMAGE_RENDERED,S),e.removeEventListener(n.default.NEW_IMAGE,g),r.default.cornerstone.updateImage(e)}function O(e){e.removeEventListener(n.default.TOUCH_DRAG,M),e.removeEventListener(n.default.TOUCH_START,y),e.removeEventListener(n.default.TOUCH_DRAG_END,h),e.removeEventListener(n.default.IMAGE_RENDERED,S)}var _={activate:function(e,t){(0,d.setToolOptions)(v,e,{mouseButtonMask:t}),(0,i.getToolState)(e,v)||(0,i.addToolState)(e,v,[]);e.removeEventListener(n.default.MOUSE_DOWN,T),e.removeEventListener(n.default.MOUSE_UP,p),e.removeEventListener(n.default.MOUSE_CLICK,p),e.removeEventListener(n.default.MOUSE_DRAG,M),e.removeEventListener(n.default.MOUSE_MOVE,M),e.removeEventListener(n.default.IMAGE_RENDERED,S),e.removeEventListener(n.default.NEW_IMAGE,g),e.addEventListener(n.default.MOUSE_DOWN,T),e.addEventListener(n.default.IMAGE_RENDERED,S),e.addEventListener(n.default.NEW_IMAGE,g),r.default.cornerstone.updateImage(e)},deactivate:b,disable:b,setConfiguration:function(e){m=e},getConfiguration:function(){return m}},P={activate:function(e){(0,i.getToolState)(e,v)||(0,i.addToolState)(e,v,[]);e.removeEventListener(n.default.TOUCH_DRAG,M),e.removeEventListener(n.default.TOUCH_START,y),e.removeEventListener(n.default.TOUCH_DRAG_END,h),e.removeEventListener(n.default.IMAGE_RENDERED,S),e.addEventListener(n.default.TOUCH_DRAG,M),e.addEventListener(n.default.TOUCH_START,y),e.addEventListener(n.default.TOUCH_DRAG_END,h),e.addEventListener(n.default.IMAGE_RENDERED,S)},deactivate:O,disable:O};t.wwwcRegion=_,t.wwwcRegionTouch=P},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.zoomTouchDrag=t.zoomTouchPinch=t.zoomWheel=t.zoom=void 0;var n=f(a(1)),r=f(a(0)),o=f(a(16)),i=f(a(6)),l=f(a(29)),u=f(a(61)),d=f(a(18)),c=a(4),s=a(8);function f(e){return e&&e.__esModule?e:{default:e}}var v="zoom",m=void 0;function g(e,t){var a=y.getConfiguration(),n=Math.log(e.scale)/Math.log(1.7)+t,r=Math.pow(1.7,n);return a.maxScale&&r>a.maxScale?e.scale=a.maxScale:a.minScale&&r<a.minScale?e.scale=a.minScale:e.scale=r,e}function p(e,t){if(t.hflip&&(e.x*=-1),t.vflip&&(e.y*=-1),0!==t.rotation){var a=t.rotation*Math.PI/180,n=Math.cos(a),r=Math.sin(a),o=e.x*n-e.y*r,i=e.x*r+e.y*n;e.x=o,e.y=i}return e}function h(e,t){var a=r.default.cornerstone,n=e.element,o=g(e.viewport,t);a.setViewport(n,o);var i=a.pageToPixel(n,e.startPoints.page.x,e.startPoints.page.y),l={x:e.startPoints.image.x-i.x,y:e.startPoints.image.y-i.y};l=p(l,o),o.translation.x-=l.x,o.translation.y-=l.y,a.setViewport(n,o)}function E(e){var t=e.detail.element;t.removeEventListener(n.default.MOUSE_DRAG,T),t.removeEventListener(n.default.MOUSE_UP,E),t.removeEventListener(n.default.MOUSE_CLICK,E)}function T(e){var t=e.detail;if(!t.deltaPoints.page.y)return!1;var a=t.deltaPoints.page.y/100,n=y.getConfiguration();n&&n.invert&&(a*=-1),y.strategy(t,a),e.preventDefault(),e.stopPropagation()}var y=(0,o.default)(function(e){var t=e.detail,a=t.element,r=(0,c.getToolOptions)(v,a);(0,i.default)(t.which,r.mouseButtonMask)&&(m=t.startPoints,a.addEventListener(n.default.MOUSE_DRAG,T),a.addEventListener(n.default.MOUSE_UP,E),a.addEventListener(n.default.MOUSE_CLICK,E),e.preventDefault(),e.stopPropagation())},v);y.strategies={default:h,translate:function(e,t){var a=e.element,n=e.image,o=y.getConfiguration(),i=g(e.viewport,t),l={x:0,y:0};if(t<0)i.scale<3&&(Math.abs(i.translation.x)<.01?i.translation.x=0:l.x=i.translation.x/8,Math.abs(i.translation.y)<.01?i.translation.y=0:l.y=i.translation.y/8);else{o&&o.preventZoomOutsideImage&&(0,s.clipToBox)(m.image,n);var u={x:n.width/2-m.image.x,y:n.height/2-m.image.y};u=p(u,i);var d={x:i.translation.x-u.x,y:i.translation.y-u.y};Math.abs(d.x)<.01?i.translation.x=u.x:l.x=d.x/8,Math.abs(d.y)<.01?i.translation.y=u.y:l.y=d.y/8}i.translation.x-=l.x,i.translation.y-=l.y,r.default.cornerstone.setViewport(a,i)},zoomToCenter:function(e,t){var a=e.element,n=g(e.viewport,t);r.default.cornerstone.setViewport(a,n)}},y.strategy=h;var M=(0,l.default)(function(e){var t=e.detail,a=-t.direction/4,n=y.getConfiguration();n&&n.invert&&(a*=-1);var o=g(t.viewport,a);r.default.cornerstone.setViewport(t.element,o)}),S=(0,u.default)(function(e){var t=e.detail,a=r.default.cornerstone,n=y.getConfiguration(),o=t.viewport,i=t.element;o.scale+=t.scaleChange*o.scale,n.maxScale&&o.scale>n.maxScale?o.scale=n.maxScale:n.minScale&&o.scale<n.minScale&&(o.scale=n.minScale),a.setViewport(i,o);var l=a.pageToPixel(i,t.startPoints.page.x,t.startPoints.page.y),u={x:t.startPoints.image.x-l.x,y:t.startPoints.image.y-l.y};u=p(u,o),o.translation.x-=u.x,o.translation.y-=u.y,a.setViewport(i,o)}),b=(0,d.default)(T,v);t.zoom=y,t.zoomWheel=M,t.zoomTouchPinch=S,t.zoomTouchDrag=b},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.brush=void 0;var n=u(a(0)),r=a(2),o=u(a(62)),i=u(a(63)),l=a(64);function u(e){return e&&e.__esModule?e:{default:e}}var d="brush",c=void 0,s=!1;function f(e){var t=v.getConfiguration(),a=e.element,o=n.default.cornerstone.getLayer(a,t.brushLayerId),u=o.image,c=u.rows,s=u.columns,f=e.currentPoints.image,m=f.x,g=f.y,p=(0,r.getToolState)(a,d).data[0].pixelData,h=t.draw,E=t.radius;if(!(m<0||m>s||g<0||g>c)){var T=(0,i.default)(E,c,s,m,g);(0,l.drawBrushPixels)(T,p,h,s),o.invalid=!0,n.default.cornerstone.updateImage(a)}}var v=(0,o.default)({onMouseMove:function(e){var t=e.detail;c=t.currentPoints.image,n.default.cornerstone.updateImage(t.element)},onMouseDown:function(e){var t=e.detail;f(t),s=!0,c=t.currentPoints.image},onMouseUp:function(e){var t=e.detail;c=t.currentPoints.image,s=!1},onDrag:function(e){var t=e.detail;f(t),s=!0,c=t.currentPoints.image},toolType:"brush",onImageRendered:function(e){var t=e.detail;if(c){var a=t.image,n=a.rows,r=a.columns,o=c,u=o.x,d=o.y;if(!(u<0||u>r||d<0||d>n)){var f=v.getConfiguration(),m=f.radius,g=t.canvasContext,p=s?f.dragColor:f.hoverColor,h=t.element;if(g.setTransform(1,0,0,1,0,0),f.active){var E=(0,i.default)(m,n,r,u,d);(0,l.drawBrushOnCanvas)(E,g,p,h)}}}}});v.setConfiguration({draw:1,radius:5,minRadius:1,maxRadius:20,hoverColor:"rgba(230, 25, 75, 1.0)",dragColor:"rgba(230, 25, 75, 0.8)",active:!1}),t.brush=v},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.adaptiveBrush=void 0;var n=u(a(0)),r=a(2),o=u(a(62)),i=u(a(63)),l=a(64);function u(e){return e&&e.__esModule?e:{default:e}}var d="brush",c={draw:1,radius:5,tolerance:5,minRadius:1,maxRadius:20,hoverColor:"rgba(230, 25, 75, 1.0)",dragColor:"rgba(230, 25, 75, 0.8)",active:!1},s=void 0,f=void 0,v=void 0,m=void 0,g=void 0;function p(e){var t=E.getConfiguration(),a=e.element,o=n.default.cornerstone.getLayer(a,t.brushLayerId),u=n.default.cornerstone.getLayers(a)[0],c=o.image,g=c.rows,p=c.columns,h=(0,r.getToolState)(a,d).data[0];m=function(e,t,a,n){for(var r=E.getConfiguration(),o=r.draw,u=Math.round(s.x),d=Math.round(s.y),c=null,m=[],g=r.radius;0!==c&&g>r.minRadius;){c=0,m=(0,i.default)(g,a,n,u,d);for(var p=0;p<m.length;p++){var h=m[p][0],T=e[m[p][1]*n+h];if(T>f||T<v){c++;break}}g--}return 0===c&&(0,l.drawBrushPixels)(m,t,o,n),g}(u.image.getPixelData(),h.pixelData,g,p),o.invalid=!0,n.default.cornerstone.updateImage(a)}function h(e){var t=E.getConfiguration(),a=e.element,o=n.default.cornerstone.getLayer(a,t.brushLayerId),u=o.image,c=u.rows,s=u.columns,f=e.currentPoints.image,v=f.x,m=f.y,g=(0,r.getToolState)(a,d).data[0].pixelData,p=t.draw,h=t.radius;if(!(v<0||v>s||m<0||m>c)){var T=(0,i.default)(h,c,s,v,m);(0,l.drawBrushPixels)(T,g,p,s),o.invalid=!0,n.default.cornerstone.updateImage(a)}}var E=(0,o.default)({onMouseMove:function(e){var t=e.detail;s=t.currentPoints.image,n.default.cornerstone.updateImage(t.element)},onMouseDown:function(e){var t=e.detail,a=t.element,r=E.getConfiguration(),o=n.default.cornerstone.getLayer(a,r.brushLayerId),l=n.default.cornerstone.getLayers(a)[0],u=t.currentPoints.image,d=u.x,c=u.y,m=o.image,T=m.rows,y=m.columns,M=(0,i.default)(r.radius,T,y,d,c);0===r.draw?h(t):(function(e,t,a){var n=E.getConfiguration().tolerance,r=Number.MAX_VALUE,o=-Number.MAX_VALUE;e.forEach(function(e){var n=e[1]*a+e[0],i=t[n];r=Math.min(i,r),o=Math.max(i,o)}),v=r-n,f=o+n}(M,l.image.getPixelData(),y),p(t)),g=!0,s=t.currentPoints.image},onMouseUp:function(e){var t=e.detail;s=t.currentPoints.image;var a=E.getConfiguration();g=!1,m=a.radius,n.default.cornerstone.updateImage(t.element)},onDrag:function(e){var t=e.detail;0===c.draw?h(t):p(t),g=!0,s=t.currentPoints.image},toolType:"adaptiveBrush",onImageRendered:function(e){var t=e.detail;if(s){var a=t.image,n=a.rows,r=a.columns,o=s,u=o.x,d=o.y;if(!(u<0||u>r||d<0||d>n)){var c=E.getConfiguration(),f=t.canvasContext,v=g?c.dragColor:c.hoverColor,p=t.element;if(m=g&&m||c.radius,f.setTransform(1,0,0,1,0,0),c.active){var h=(0,i.default)(m,n,r,u,d);(0,l.drawBrushOnCanvas)(h,f,v,p)}}}}});E.setConfiguration(c),t.adaptiveBrush=E},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default="2.3.9"}])});
//# sourceMappingURL=cornerstoneTools.min.js.map